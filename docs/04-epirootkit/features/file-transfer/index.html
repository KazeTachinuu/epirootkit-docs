<!doctype html><html lang=en><head><meta charset=utf-8><title>Remote Exec & File Transfer | Tux Fan Club Docs</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Run commands, upload & download files over our encrypted channel"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest><meta property="og:title" content="Remote Exec & File Transfer"><meta property="og:description" content="Run commands, upload & download files over our encrypted channel"><meta property="og:type" content="article"><meta property="og:url" content="/docs/04-epirootkit/features/file-transfer/"><meta property="og:image" content="/opengraph/card-base-2_hu_ba042757c0e46095.png"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-05-11T18:35:00+01:00"><meta property="article:modified_time" content="2025-05-14T19:05:47+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/opengraph/card-base-2_hu_ba042757c0e46095.png"><meta name=twitter:title content="Remote Exec & File Transfer"><meta name=twitter:description content="Run commands, upload & download files over our encrypted channel"><link rel=alternate type=application/atom+xml title="Atom feed for Tux Fan Club Docs" href=/index.xml><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script type=text/javascript src=/docs/js/flexsearch.bundle.min.249548594cb6843f3060a3cdd3043799676c59ce8db83358a3fc2e4d20598d05dfa6ce4994805d2835cb33b54dc9b9e7.js integrity=sha384-JJVIWUy2hD8wYKPN0wQ3mWdsWc6NuDNYo/wuTSBZjQXfps5JlIBdKDXLM7VNybnn crossorigin=anonymous></script><link rel=preconnect href=https://fonts.gstatic.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css?family=Inter:300,400,600,700|Fira+Code:500,700&display=block" rel=stylesheet><link rel=stylesheet href=/docs/scss/style.min.47627c508718021a8811f17bfd419041ce97729127a3db8f6bcf7c26c29fbacf37e002e618d60350aae90d89464e8447.css integrity=sha384-R2J8UIcYAhqIEfF7/UGQQc6XcpEno9uPa898JsKfus834ALmGNYDUKrpDYlGToRH crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">description</i>
Introduction</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/01-introduction/presentation/>Presentation</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">code</i>
Setup</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/02-setup/environment/>Initial Setup & Installation</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/vm-installation/>VM Installation & Verification</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/attacking-vm-setup/>Attacking VM Setup</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/victim-vm-setup/>Victim VM Setup</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">notes</i>
Attacking Program (C2 Server)</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/03-attacking-program/overview/>Overview</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/installation/>Installation</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/usage/>Usage & CLI Commands</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/configuration/>Configuration</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/security/>Security Features</a></li></ul></div></li><li class="sidebar-dropdown current active"><button class=btn>
<i class="material-icons me-2">notes</i>
EpiRootkit</button><div class="sidebar-submenu d-block"><ul><li><a class=sidebar-nested-link href=/docs/04-epirootkit/deployment/>Deployment</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/connection-authentication/>Connection & Authentication</a></li><li class="sidebar-dropdown nested current active"><button class=btn>
Features</button><div class="sidebar-submenu d-block"><ul><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/connection/>Connection</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/password/>Password Protection</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/command-execution/>Command Execution</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/crypto/>Crypto</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/bonus-features/>Bonus Features</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/fileless-dropper-loader/>Fileless Dropper & Rootkit Loader</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/hiding/>Stealth Hooks & daniel.* Commands</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/persistence/>Encrypted C2, Persistence & Auth</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/symbol-ftrace/>Symbol Resolution & Ftrace Hooks</a></li><li class=current><a class=sidebar-nested-link href=/docs/04-epirootkit/features/file-transfer/>Remote Exec & File Transfer</a></li></ul></div></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/command-execution/>Command Execution</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/configuration-justifications/>Configuration Justifications</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/security-interaction/>Security Interaction with C2</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">code</i>
Submission</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/05-submission/handout-format/>Handout Format</a></li></ul></div></li><li><a class=sidebar-root-link href=/docs/06-resources/><i class="material-icons me-2">code</i>
Resources</a></li><li><a class=sidebar-root-link href=/docs/07-bonuses/wlkom-ctf/><i class="material-icons me-2">savings</i>
Tux Fan Club: Chasse au TrÃ©sor Pirate</a></li><li><a class=sidebar-root-link href=/docs/08-remerciements/thankyou/><i class="material-icons me-2">favorite</i>
Un dernier mot</a></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentcolor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentcolor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentcolor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentcolor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentcolor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentcolor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentcolor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://github.com/KazeTachinuu/epirootkit-docs alt=github rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></div></a></li></ul><button id=mode class="btn btn-icon btn-default ms-2" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg height="30" width="30" viewBox="0 0 48 48" fill="currentcolor"><title>Enable dark mode</title><path d="M24 42q-7.5.0-12.75-5.25T6 24t5.25-12.75T24 6q.4.0.85.025.45.025 1.15.075-1.8 1.6-2.8 3.95t-1 4.95q0 4.5 3.15 7.65Q28.5 25.8 33 25.8q2.6.0 4.95-.925T41.9 22.3q.05.6.075.975Q42 23.65 42 24q0 7.5-5.25 12.75T24 42zm0-3q5.45.0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75.0-9.775-4.025T19.2 15q0-1.2.25-2.575t.9-3.125q-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39zm-.2-14.85z"/></svg>
</span><span class=toggle-light><svg height="30" width="30" viewBox="0 0 48 48" fill="currentcolor"><title>Enable light mode</title><path d="M24 31q2.9.0 4.95-2.05T31 24t-2.05-4.95T24 17t-4.95 2.05T17 24t2.05 4.95T24 31zm0 3q-4.15.0-7.075-2.925T14 24t2.925-7.075T24 14t7.075 2.925T34 24t-2.925 7.075T24 34zM3.5 25.5q-.65.0-1.075-.425Q2 24.65 2 24t.425-1.075Q2.85 22.5 3.5 22.5h5q.65.0 1.075.425Q10 23.35 10 24t-.425 1.075T8.5 25.5zm36 0q-.65.0-1.075-.425Q38 24.65 38 24t.425-1.075T39.5 22.5h5q.65.0 1.075.425Q46 23.35 46 24t-.425 1.075-1.075.425zM24 10q-.65.0-1.075-.425Q22.5 9.15 22.5 8.5v-5q0-.65.425-1.075Q23.35 2 24 2t1.075.425T25.5 3.5v5q0 .65-.425 1.075Q24.65 10 24 10zm0 36q-.65.0-1.075-.425T22.5 44.5v-5q0-.65.425-1.075Q23.35 38 24 38t1.075.425.425 1.075v5q0 .65-.425 1.075Q24.65 46 24 46zM12 14.1l-2.85-2.8q-.45-.45-.425-1.075.025-.625.425-1.075.45-.45 1.075-.45t1.075.45L14.1 12q.4.45.4 1.05.0.6-.4 1-.4.45-1.025.45T12 14.1zm24.7 24.75L33.9 36q-.4-.45-.4-1.075t.45-1.025q.4-.45 1-.45t1.05.45l2.85 2.8q.45.45.425 1.075-.025.625-.425 1.075-.45.45-1.075.45t-1.075-.45zM33.9 14.1q-.45-.45-.45-1.05.0-.6.45-1.05l2.8-2.85q.45-.45 1.075-.425.625.025 1.075.425.45.45.45 1.075t-.45 1.075L36 14.1q-.4.4-1.025.4t-1.075-.4zM9.15 38.85q-.45-.45-.45-1.075t.45-1.075L12 33.9q.45-.45 1.05-.45.6.0 1.05.45.45.45.45 1.05.0.6-.45 1.05l-2.8 2.85q-.45.45-1.075.425-.625-.025-1.075-.425zM24 24z"/></svg></span></button></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/04-epirootkit/><span itemprop=name>EpiRootkit</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/04-epirootkit/features/><span itemprop=name>Features</span>
</a><meta itemprop=position content='3'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Remote Exec & File Transfer</span>
<meta itemprop=position content='4'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=toc><ul><li><a href=#1-remote-command-execution>1. Remote Command Execution</a></li><li><a href=#2-file-upload>2. File Upload</a></li><li><a href=#3-file-download>3. File Download</a></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#1-remote-command-execution>1. Remote Command Execution</a></li><li><a href=#2-file-upload>2. File Upload</a></li><li><a href=#3-file-download>3. File Download</a></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><i class="material-icons title-icon me-2">cloud_upload</i><h1 class="content-title mb-0">Remote Exec & File Transfer</h1></div><p class="lead mb-3">Run commands, upload & download files over our encrypted channel</p><div id=content class=main-content data-bs-spy=scroll data-bs-root-margin="0px 0px -65%" data-bs-target=#toc-mobile><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h1 id=1-remote-command-execution>1. Remote Command Execution <a href=#1-remote-command-execution class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><p><strong>What we did</strong><br>Allow arbitrary program execution via C2.</p><p><strong>How it works</strong></p><ul><li>Receive a packet:<div class=prism-codeblock><pre id=265fa6f class=language->
  <code>EXEC &lt;len&gt;\n&lt;payload&gt;</code>
  </pre></div></li><li>Use <code>call_usermodehelper(argv, envp, UMH_WAIT_PROC)</code> to spawn the process.</li><li>Capture its <code>stdout</code>/<code>stderr</code> via kernel pipes and send back encrypted.</li></ul><hr><h1 id=2-file-upload>2. File Upload <a href=#2-file-upload class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><p><strong>What we did</strong><br>Accept files from the attacker.</p><p><strong>How it works</strong></p><ul><li>Receive <code>UPLOAD &lt;path> &lt;len>\n&lt;data></code>.</li><li><code>filp_open("/usr/share/epirootkit/&lt;path>", O_CREAT|O_WRONLY, 0600)</code>.</li><li><code>kernel_write()</code> the data.</li><li>Our <code>getdents()</code> hook keeps <code>/usr/share/epirootkit</code> hidden.</li></ul><hr><h1 id=3-file-download>3. File Download <a href=#3-file-download class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><p><strong>What we did</strong><br>Send files to the attacker.</p><p><strong>How it works</strong></p><ul><li>Receive <code>DOWNLOAD &lt;path></code>.</li><li><code>filp_open()</code> + <code>kernel_read()</code> in chunks.</li><li>Stream each chunk over the encrypted C2 link.</li></ul><div class=prism-codeblock><pre id=39de4cc class=language->
  <code></code>
  </pre></div></div><div class="gitinfo d-flex flex-wrap justify-content-between align-items-center opacity-85 pt-3"><div id=edit-this-page class=mt-1><a href=https://github.com/kazetachinuu/epirootkit-docs/blob/master/content/docs/04-epirootkit/features/file-transfer.md alt="Remote Exec & File Transfer" rel="noopener noreferrer" target=_blank><span class="me-1 align-text-bottom"><svg width="20" height="20" viewBox="0 0 32 32" fill="currentcolor"><path d="M16 .396c-8.839.0-16 7.167-16 16 0 7.073 4.584 13.068 10.937 15.183.803.151 1.093-.344 1.093-.772.0-.38-.009-1.385-.015-2.719-4.453.964-5.391-2.151-5.391-2.151-.729-1.844-1.781-2.339-1.781-2.339-1.448-.989.115-.968.115-.968 1.604.109 2.448 1.645 2.448 1.645 1.427 2.448 3.744 1.74 4.661 1.328.14-1.031.557-1.74 1.011-2.135-3.552-.401-7.287-1.776-7.287-7.907.0-1.751.62-3.177 1.645-4.297-.177-.401-.719-2.031.141-4.235.0.0 1.339-.427 4.4 1.641 1.281-.355 2.641-.532 4-.541 1.36.009 2.719.187 4 .541 3.043-2.068 4.381-1.641 4.381-1.641.859 2.204.317 3.833.161 4.235 1.015 1.12 1.635 2.547 1.635 4.297.0 6.145-3.74 7.5-7.296 7.891.556.479 1.077 1.464 1.077 2.959.0 2.14-.02 3.864-.02 4.385.0.416.28.916 1.104.755 6.4-2.093 10.979-8.093 10.979-15.156.0-8.833-7.161-16-16-16z"/></svg>
</span>Edit this page</a></div></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/docs/04-epirootkit/security-interaction/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Security Interaction with C2</p><p class="card-text ms-2">Security protocols EpiRootkit â€¦</p></div></div></a></div><div class="col-sm-6 pt-2 doc-prev"><a class=ms-auto href=/docs/05-submission/handout-format/><div class="card h-100 my-1 text-end"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0">Handout Format <i class="material-icons align-middle">navigate_next</i></p><p class="card-text me-2"></p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>Â© 2025 Tux Fan Club. Built with <a href=https://github.com/colinwilson/lotusdocs><strong>Lotus Docs</strong></a></p></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script>(()=>{var e=document.getElementById("mode");e!==null&&(window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")):(localStorage.setItem("theme","light"),document.documentElement.removeAttribute("data-dark-mode"))}),e.addEventListener("click",()=>{document.documentElement.toggleAttribute("data-dark-mode"),localStorage.setItem("theme",document.documentElement.hasAttribute("data-dark-mode")?"dark":"light")}),localStorage.getItem("theme")==="dark"?document.documentElement.setAttribute("data-dark-mode",""):document.documentElement.removeAttribute("data-dark-mode"))})()</script><script src=/docs/js/bootstrap.c7927bdd82eceb076739257add3f4b0e11379da037c07d5c7110daeb6de0e3edcb2de867604550f88815157e4ec4ddb7.js integrity=sha384-x5J73YLs6wdnOSV63T9LDhE3naA3wH1ccRDa623g4+3LLehnYEVQ+IgVFX5OxN23 defer></script><script type=text/javascript src=/docs/js/bundle.min.4f60111ba6134ba40ed4d3ca8b6f30e10963c0482cd9829b9dc4a2a347bc6eaec2c1cf424c2ce632fb6d2218139f34f0.js integrity=sha384-T2ARG6YTS6QO1NPKi28w4QljwEgs2YKbncSio0e8bq7Cwc9CTCzmMvttIhgTnzTw crossorigin=anonymous defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    


    

    

    index.add(
            {
                id:  0 ,
                href: "\/docs\/04-epirootkit\/features\/connection\/",
                title: "Connection",
                description: "Details about the connection mechanism (how it connects back, retries).\n",
                content: "Details about the connection mechanism (how it connects back, retries).\n"
            }
        );
    index.add(
            {
                id:  1 ,
                href: "\/docs\/04-epirootkit\/features\/password\/",
                title: "Password Protection",
                description: "How access to the rootkit is secured.\n",
                content: "How access to the rootkit is secured.\n"
            }
        );
    index.add(
            {
                id:  2 ,
                href: "\/docs\/04-epirootkit\/features\/command-execution\/",
                title: "Command Execution",
                description: "How commands are executed on the victim and results returned.\n",
                content: "How commands are executed on the victim and results returned.\n"
            }
        );
    index.add(
            {
                id:  3 ,
                href: "\/docs\/04-epirootkit\/features\/crypto\/",
                title: "Crypto",
                description: "Details on the encryption used for communication.\n",
                content: "Details on the encryption used for communication.\n"
            }
        );
    index.add(
            {
                id:  4 ,
                href: "\/docs\/04-epirootkit\/features\/bonus-features\/",
                title: "Bonus Features",
                description: "Description of any extra implemented features (upgrade, packet hiding, keylogging, etc.).\n",
                content: "Description of any extra implemented features (upgrade, packet hiding, keylogging, etc.).\n"
            }
        );
    index.add(
            {
                id:  5 ,
                href: "\/docs\/04-epirootkit\/features\/fileless-dropper-loader\/",
                title: "Fileless Dropper \u0026 Rootkit Loader",
                description: "Stages 1 \u0026 2: in-memory payload staging and LKM insertion",
                content: "Stage 1: Fileless Memfd Dropper link info We stage both loader and cron stub entirely in memoryâ€“no on-disk binaries. We call fd_loader = memfd_create(\"loader\", MFD_CLOEXEC); fd_target = memfd_create(\"target\", MFD_CLOEXEC); to get two anonymous file descriptors. We write() our embedded ELF blobs into each fd. We fork(): Child: redirect stdout/stderr to /dev/null, then execveat(fd_loader, NULL, argv_loader, envp, AT_EMPTY_PATH); Parent: waitpid(), then execveat(fd_target, NULL, argv_target, envp, AT_EMPTY_PATH); execveat(..., AT_EMPTY_PATH) lets us execute a program by FD without any filename on disk.\nStage 2: Environment-Aware Loader link warning We verify Secure Boot is off, extract the kernel image, resolve symbols, and then insert our LKM. We rename our process to â€œsshdâ€ via prctl(PR_SET_NAME, \"sshd\", 0, 0, 0); We scan dmesg for â€œSecure bootâ€ strings. If found, we abort. We drop a helper script /tmp/loader.sh that: Uses file + grep to detect gzip/xz/bz2/lz4/zstd. Runs tail -c + + the right decompressor â†’ /tmp/vmlinux. In loader.c, we open /tmp/vmlinux and call: sys_call_table = (void **)kallsyms_lookup_name(\"sys_call_table\"); We load our kernel module by creating another memfd for puma.ko and calling: finit_module(fd_puma_ko, \"\", 0); Finally, we remove /tmp/loader.sh and /tmp/vmlinux. Code Locations link rootkit/dropper/dropper.c rootkit/loader/loader.c \u0026 rootkit/loader/loader.sh Quick Test link ./rootkit/dropper/cron dmesg | grep \"PUMA is compatible\" dmesg | grep \"PUMA loaded\" "
            }
        );
    index.add(
            {
                id:  6 ,
                href: "\/docs\/01-introduction\/",
                title: "Introduction",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  7 ,
                href: "\/docs\/01-introduction\/presentation\/",
                title: "Presentation",
                description: "whoami",
                content: "PrÃ©sentation linkEquipage link Capitaine: Hugo Sibony Responsable Sabordage et mutinerie: LÃ©a Bonet Nom de lâ€™Ã©quipe linkNous sommes Tux Fan Club ðŸ§\nCâ€™est LÃ©a qui a choisi le nom car câ€™est la seule personne du groupe un peu crÃ©ative ðŸ‘€\n(Et par ce que Hugo est gentleman et a laissÃ© le choix a la seule femme du groupe)\nTux est un manchot reprÃ©sentant le noyau Linux. Il a Ã©tÃ© crÃ©e en 1996 par Larry Ewing sur GIMP\nVu quâ€™il est mignon et que je lâ€™aime (Tux pas Hugo ðŸ‘€) je me suis dis que Tux Fan Club Ã©tait un nom convenable\n"
            }
        );
    index.add(
            {
                id:  8 ,
                href: "\/docs\/02-setup\/",
                title: "Setup",
                description: "Environment and Virtual Machine setup instructions",
                content: "Overview linkThis section guides you through setting up your host environment, installing and verifying VM disks, and configuring the attacker and victim VMs.\nInitial Setup \u0026 Installation VM Installation \u0026 Verification Attacking VM Setup Victim VM Setup "
            }
        );
    index.add(
            {
                id:  9 ,
                href: "\/docs\/02-setup\/environment\/",
                title: "Initial Setup \u0026 Installation",
                description: "Prerequisites on the EPITA laptop",
                content: "To develop and test the rootkit, you need to prepare your host (EPITA laptop) with the following:\nOperating System\nUbuntu 24.10 (amd64) Install virtualization and helper tools\nsudo apt update sudo apt install -y qemu-kvm libvirt-daemon-system libvirt-clients bridge-utils Enable and start the libvirt service\nsudo systemctl enable --now libvirtd Add your user to the libvirt group (re-login or newgrp libvirt afterward)\nsudo usermod -aG libvirt $USER Verify that KVM modules are loaded\nlsmod | grep kvm You should see kvm and kvm_intel (or kvm_amd) in the output.\nIf not then you probably didnâ€™t enable Hardware assisted virtualization in BIOS, check with\negrep -c '(vmx|svm)' /proc/cpuinfo # output == 0 -\u003e not activated # output \u003e= 1 -\u003e activated Review the helper scripts:\nscripts/check_vms.sh: checks if the VM disks and ISO are present and provides download URLs for missing items. scripts/run_vms.sh: defines and starts a NAT network (static200) with static DHCP leases, then launches both VMs attached to that network. With these steps complete, your host is ready to build, launch, and manage the attacking and victim VMs.\nHow it works link libvirt (virsh) manages virtual networks and invokes QEMU under the hood. The static200 network (defined in scripts/static200.xml) creates a NAT bridge virbr200 and DHCP server with fixed MAC-to-IP entries. scripts/run_vms.sh uses qemu-system-x86_64 with -netdev bridge,br=virbr200 to attach VMs to the NAT network. Static IPs are assigned automatically by DHCP based on the VMâ€™s MAC address. QEMU windows use virtio drivers for disk and network for high performance. "
            }
        );
    index.add(
            {
                id:  10 ,
                href: "\/docs\/02-setup\/vm-installation\/",
                title: "VM Installation \u0026 Verification",
                description: "Quickly set up the attacker and victim VM disks",
                content: " info Run ./scripts/check_vms.sh at any time to verify VM disks and ISO, and see download URLs for missing items. VM Installation link Recommended: Pre-built Disks Build Disks Yourself Download and place both QCOW2 images into the vm/ directory at the project root:\nVM Disk Path Download URL Size Attacker VM vm/attacker.qcow2 https://drive.proton.me/urls/J20W6CD998#rB7b5oM6idQC 5.6 Go Victim VM vm/victim.qcow2 https://drive.proton.me/urls/EGVVVF6YXW#THevlby2e62E 5.6 Go To be honest, these qcow2 images are almost identical. The only difference is that the rootkit files are pre-loaded on the â€˜attackerâ€™ disk. If you prefer, you can simply download the â€˜attackerâ€™ image and copy it into vm/victim.qcow2 if needed.\nOnce downloaded, launch both VMs:\nsudo scripts/run_vms.sh If you prefer to build the disks yourself because you donâ€™t trust me (which is fair tbh), follow these steps:\nDownload the Ubuntu 20.04 Desktop ISO from Proton Drive or the Ubuntu archive:\nProton Drive: https://drive.proton.me/urls/N5ZQN96C30#77rPStc8Fx2i 2.5 Go Ubuntu archive: https://releases.ubuntu.com/20.04/ubuntu-20.04-desktop-amd64.iso 2.5 Go Create two blank QCOW2 disks (10 GB each):\nqemu-img create -f qcow2 vm/attacker.qcow2 10G qemu-img create -f qcow2 vm/victim.qcow2 10G Install Ubuntu Desktop into each disk:\nAttacker VM\nqemu-system-x86_64 \\ -enable-kvm -machine accel=kvm -cpu host \\ -m 4096 -smp 4 \\ -name attacker-install \\ -drive file=vm/attacker.qcow2,format=qcow2,if=virtio,cache=writeback \\ -cdrom vm/ubuntu-20.04-desktop-amd64.iso -boot once=d \\ -netdev user,id=net0 -device virtio-net-pci,netdev=net0 \\ -vga virtio -display gtk Victim VM\nqemu-system-x86_64 \\ -enable-kvm -machine accel=kvm -cpu host \\ -m 4096 -smp 4 \\ -name victim-install \\ -drive file=vm/victim.qcow2,format=qcow2,if=virtio,cache=writeback \\ -cdrom vm/ubuntu-20.04-desktop-amd64.iso -boot once=d \\ -netdev user,id=net0 -device virtio-net-pci,netdev=net0 \\ -vga virtio -display gtk After installation completes and the VMs shut down, your disks are ready. Launch them with:\nsudo scripts/run_vms.sh Understanding the run_vms.sh Script linkThe run_vms.sh helper automates setting up a private NAT network and launching two QEMU VMs (attacker \u0026 victim) on it. Hereâ€™s what happens and why:\nLibvirt network setup\nDefines a network (static200) with a preconfigured XML (static200.xml). Destroys any existing definition, then recreates and starts it, enabling DHCP with static leases. VM image verification\nChecks that vm/attacker.qcow2 and vm/victim.qcow2 exist before proceeding. Launching VMs\nlaunch_vm function configures each VM with: â€¢ KVM acceleration and host CPU model for performance\nâ€¢ Memory and CPU count from MEMORY/CPUS env vars (defaults: 2048 MB, 2 CPUs)\nâ€¢ A bridged network interface on virbr200 with a fixed MAC and IP\nâ€¢ GTK display. By default, both VMs start; you can specify attacker or victim as arguments to launch individually. "
            }
        );
    index.add(
            {
                id:  11 ,
                href: "\/docs\/02-setup\/attacking-vm-setup\/",
                title: "Attacking VM Setup",
                description: "Configure and use the attacking VM",
                content: "Follow these steps once the host environment is ready and the VMs have been created or downloaded.\nUsage link Ensure the attacker.qcow2 disk is in the vm/ directory (verify via ./scripts/check_vms.sh or see VM Installation \u0026 Verification). Launch the attacking VM with: sudo ./scripts/run_vms.sh attacker Or both VMs with: sudo ./scripts/run_vms.sh On the attacking VM: Auto-login is enabled for user attacker (no password prompt). The static IP is 192.168.200.11. The password is jules. For more details on the network configuration and helper scripts, see Initial Setup \u0026 Installation.\n"
            }
        );
    index.add(
            {
                id:  12 ,
                href: "\/docs\/02-setup\/victim-vm-setup\/",
                title: "Victim VM Setup",
                description: "Configure and use the victim VM to load EpiRootkit",
                content: "Follow these steps once the host environment is ready and the VMs have been created or downloaded.\nPlace the victim.qcow2 disk in the vm/ directory at the project root (verify via ./scripts/check_vms.sh or see VM Installation \u0026 Verification).\nLaunch the victim VM with:\nsudo ./scripts/run_vms.sh victim Or both VMs with:\nsudo ./scripts/run_vms.sh On the victim VM:\nThe VM has auto-login enabled for the victim user (no password prompt). Its static IP is 192.168.200.10. The password is jules. When finished, close the QEMU window or use Ctrl+C on the host script to shut down both VMs.\n"
            }
        );
    index.add(
            {
                id:  13 ,
                href: "\/docs\/04-epirootkit\/features\/hiding\/",
                title: "Stealth Hooks \u0026 daniel.* Commands",
                description: "Hiding files, modules, PIDs, plus our rmdir() command channel",
                content: "1. File \u0026 Directory Hiding linkWhat we did\nWe hook getdents()/getdents64().\nHow it works\nCall the original syscall to fill a dirent buffer. Traverse entries; if d_name starts with any prefix in hide_prefixes[] = { \"jules_est_bo_\", \"memfd:\" }; we drop that entry by memmove(). Return the new byte count. 2. Module Hiding linkWhat we did\nWe hide our LKM from /proc/modules and lsmod.\nHow it works\nWe hook the procfs iterate method for /proc/modules and /sys/modules, filtering out \"epirootkit\" entries.\n3. PID Hiding linkWhat we did\nAllow dynamic hiding of arbitrary PIDs.\nHow it works\nMaintain a hidden_pids list in the kernel. In our getdents() hook on /proc, skip entries matching that list. Add to the list via rmdir(\"daniel.k.\"). 4. C2 \u0026 Commands via rmdir() linkWhat we did\nUse rmdir() as our stealth control channel.\nCommand Action daniel.0 Privilege escalation daniel.c Dump in-kernel config daniel.v Report version daniel.k. Hide PID How it works\nHook rmdir(const char __user *path,â€¦). Copy path into kernel space. If it matches ^daniel\\. we run the command and return -ENOENT. "
            }
        );
    index.add(
            {
                id:  14 ,
                href: "\/docs\/03-attacking-program\/",
                title: "Attacking Program (C2 Server)",
                description: "The C2 server for EpiRootkit. This section details its overview, installation, usage, configuration, and security aspects.",
                content: "The Attacking Program is the command and control (C2) server for EpiRootkit. It provides a command-line interface (CLI) to manage and interact with EpiRootkit instances on victim machines.\nKey functions include listening for client connections, secure communication (AES-GCM encryption, SHA512 password hashing), client management, and remote command execution via an interactive CLI.\nThis section covers its installation, usage, configuration, and security.\n"
            }
        );
    index.add(
            {
                id:  15 ,
                href: "\/docs\/03-attacking-program\/overview\/",
                title: "Overview",
                description: "A detailed overview of the Attacking Program (C2 Server), its purpose, and key functionalities.",
                content: "The Attacking Program is the command and control (C2) server for EpiRootkit. It is designed to run on a Linux-based attacking virtual machine and provides a command-line interface (CLI) to manage and interact with EpiRootkit instances on victim machines.\nKey functions include:\nListening for client connections from EpiRootkit instances. Securing communication using AES-256-GCM encryption. Authenticating clients based on a SHA512 hashed password. Managing connected clients (listing, identifying). Providing an interactive CLI for sending commands to EpiRootkit instances. "
            }
        );
    index.add(
            {
                id:  16 ,
                href: "\/docs\/03-attacking-program\/installation\/",
                title: "Installation",
                description: "Essential setup for the C2 server.",
                content: "To run the Attacking Program (C2 Server):\nPrerequisites link Node.js \u0026 npm: Ensure Node.js (e.g., LTS v18.x+) and npm are installed. sudo apt update \u0026\u0026 sudo apt install nodejs npm Setup link Navigate to the attacking_program directory within the project.\nInstall Dependencies:\nnpm install Review Critical Configuration: Before first use, ensure you have reviewed and appropriately set the ENCRYPTION_KEY, PASSWORD_HASH, and C2_PORT. Refer to the "
            }
        );
    index.add(
            {
                id:  17 ,
                href: "\/docs\/03-attacking-program\/usage\/",
                title: "Usage \u0026 CLI Commands",
                description: "Running the C2 server and its CLI.",
                content: "Running the Server linkIn the attacking_program directory, run:\nnpm start The server starts automatically and presents the c2-server$ prompt. Real-time event logs appear in the console, providing visual alerts for significant events such as client connections and disconnections.\nCLI Commands link Command Aliases Description server start start Starts TCP server (Note: auto-starts with npm start). server stop stop Stops TCP server. clients list ls, list Lists connected clients (alias, ID, auth status, last ping). send Sends to specified . exit quit Stops server and exits application. : Target client alias (e.g., Client-1 from clients list). : Command string for the victim machine. Event logs provide feedback on connections, authentication attempts, data exchanges, errors, and command results. When a command is executed on a rootkit and results (such as stdout, stderr, or exit status) are sent back, they will be displayed in these logs.\n"
            }
        );
    index.add(
            {
                id:  18 ,
                href: "\/docs\/03-attacking-program\/configuration\/",
                title: "Configuration",
                description: "Key C2 server configuration settings.",
                content: "The C2 server is configured via src/config/index.js or environment variables.\nCritical Settings link C2_PORT (Default: 4444 | Env: C2_PORT)\nTCP port for EpiRootkit connections. ENCRYPTION_KEY (Default: mysecretkey... (32 bytes) | Env: ENCRYPTION_KEY)\nMust be a 32-byte string for AES-256-GCM. Crucial for security: Change the default to a strong, random key. Must match the key on EpiRootkit clients. PASSWORD_HASH (Default: SHA512 hash of \"password\" | Env: PASSWORD_HASH)\nMust be a 128-char lowercase SHA512 hex string. Crucial for security: Change the default. Use a strong password and hash it: # Example to generate hash for a new password: echo -n \"your_new_strong_password\" | sha512sum | awk '{print $1}' Other Settings link WEB_PORT: For a potential future web UI (Default: 3000). UPLOAD_DIR, DOWNLOAD_DIR, LOG_DIR: Default paths for server-side file operations and logs. Configuration validation ensures key formats (e.g., key lengths) are correct on startup.\n"
            }
        );
    index.add(
            {
                id:  19 ,
                href: "\/docs\/03-attacking-program\/security\/",
                title: "Security Features",
                description: "Overview of C2 server security: AES-GCM and SHA512.",
                content: "The C2 server employs two main security mechanisms:\n1. Message Encryption: AES-256-GCM link Purpose: Encrypts all TCP C2 traffic for confidentiality, integrity, and authenticity. Key: Uses a 32-byte ENCRYPTION_KEY (must be changed from default and kept secret). Format: Encrypted messages are transmitted as a colon-separated string: iv_hex:authtag_hex:ciphertext_hex. Details: See src/utils/encryption.js and "
            }
        );
    index.add(
            {
                id:  20 ,
                href: "\/docs\/04-epirootkit\/features\/persistence\/",
                title: "Encrypted C2, Persistence \u0026 Auth",
                description: "Heartbeat threads, autoload, and password protection",
                content: "1. Encrypted C2 Heartbeat linkWhat we did\nSpawn a kernel thread to poll our C2 server.\nHow it works\nkthread_run(c2_thread_fn, \u0026cfg, \"epic2\"). Loop: msleep(ping_interval_ms). kernel_socket(), kernel_connect(attacker_ip, port). Exchange AES-128-CBC packets using keys from .epirootkit-config. 2. Persistence \u0026 Autoload linkWhat we did\nAutomatically load on reboot.\nHow it works\nOur installer.sh:\nCopies epirootkit.ko to /lib/modules/$(uname -r)/extra/. Runs depmod -a. Writes /etc/modules-load.d/epirootkit.conf with: epirootkit 3. Password Protection linkWhat we did\nProtect daniel.* commands with a salted hash.\nHow it works\nStore SHA256(saltâ€–password) in /etc/epirootkit/passwd. First command must be daniel.p. We compare hashes; only then unlock the command interface. "
            }
        );
    index.add(
            {
                id:  21 ,
                href: "\/docs\/04-epirootkit\/",
                title: "EpiRootkit",
                description: "Overview of the EpiRootkit kernel module and its interaction with the C2 server.",
                content: "The EpiRootkit is a Linux kernel module designed for pedagogical purposes, demonstrating various rootkit functionalities as outlined in the project subject. It communicates with the "
            }
        );
    index.add(
            {
                id:  22 ,
                href: "\/docs\/04-epirootkit\/features\/symbol-ftrace\/",
                title: "Symbol Resolution \u0026 Ftrace Hooks",
                description: "How we locate sys_call_table and intercept syscalls via ftrace",
                content: "Symbol Resolution link We spoof a GPL license so the kernel exports kallsyms_lookup_name(): MODULE_LICENSE(\"GPL\"); At init, we call: sys_call_table = (void **)kallsyms_lookup_name(\"sys_call_table\"); This gives us the address of the syscall table. Ftrace-Based Hooking link info We use ftrace to hook without writing to kernel memory directly. For each target syscall:\nDefine an ftrace_ops with flags: .func = hook_trampoline, .flags = FTRACE_OPS_FL_SAVE_REGS | FTRACE_OPS_FL_IPMODIFY Apply the filter: ftrace_set_filter_ip(\u0026ops, (unsigned long)orig_syscall, 0, 0); register_ftrace_function(\u0026ops); Our trampoline copies registers, calls hook_fn(), then jumps back to the original. Always unregister your ftrace functions in cleanup_module():\nunregister_ftrace_function(\u0026ops); Code Location link rootkit/hook/ftrace_hooks.c rootkit/hook/syscall_list.h "
            }
        );
    index.add(
            {
                id:  23 ,
                href: "\/docs\/04-epirootkit\/deployment\/",
                title: "Deployment",
                description: "Instructions on how to compile the module (Makefile) and load it into the kernel (insmod/modprobe).\n",
                content: "Instructions on how to compile the module (Makefile) and load it into the kernel (insmod/modprobe).\n"
            }
        );
    index.add(
            {
                id:  24 ,
                href: "\/docs\/04-epirootkit\/connection-authentication\/",
                title: "Connection \u0026 Authentication",
                description: "How EpiRootkit connects and authenticates with the C2 server.",
                content: "For the EpiRootkit to be controlled, it must first establish a connection to the Attacking Program (C2 Server) and then authenticate itself.\nConnection to C2 Server link Target: The EpiRootkit needs to know the IP address and port of the C2 server.\nThis information might be hardcoded during compilation, passed as a module parameter during loading, or discovered through other means. The C2 server, by default, listens on port 4444 (configurable, see "
            }
        );
    index.add(
            {
                id:  25 ,
                href: "\/docs\/04-epirootkit\/features\/",
                title: "Features",
                description: "Overview of the implemented rootkit features.\n",
                content: "Overview of the implemented rootkit features.\n"
            }
        );
    index.add(
            {
                id:  26 ,
                href: "\/docs\/04-epirootkit\/command-execution\/",
                title: "Command Execution",
                description: "How EpiRootkit receives and processes commands from the C2 server.",
                content: "Once authenticated, the EpiRootkit can receive commands from the C2 server, execute them on the victim machine, and return the results.\nReceiving Commands link Command Message (COMMAND): The C2 server sends commands to an authenticated EpiRootkit client using a COMMAND message. Format: A JSON object, encrypted using AES-256-GCM. { \"type\": \"COMMAND\", \"id\": \"unique_command_id_string\", // e.g., a timestamp \"data\": \"command_string_to_execute\" // e.g., \"ls -la /tmp\" or \"whoami\" } The id is a unique identifier generated by the C2 server for tracking the command. The data field contains the raw command string that the EpiRootkit should execute. Executing Commands link The EpiRootkit is responsible for parsing the data field and executing the command on the victim system. It needs to capture: Standard Output (stdout) of the command. Standard Error (stderr) of the command. The exit status (or exit code) of the command. Returning Results link Command Result Message (COMMAND_RESULT):\nAfter executing the command, the EpiRootkit must send the results back to the C2 server using a COMMAND_RESULT message. Format: A JSON object, encrypted using AES-256-GCM. { \"type\": \"COMMAND_RESULT\", \"commandId\": \"unique_command_id_string\", // Must match the id from the received COMMAND message \"status\": \"success\" or \"error\", // Indicates overall success or failure of execution \"output\": \"combined_stdout_and_stderr_or_error_message\", // Optional: separate stdout/stderr if desired, but C2 currently expects a single 'output' field. // \"stdout\": \"standard_output_string\", // \"stderr\": \"standard_error_string\", \"exitCode\": 0 // The integer exit code of the command } commandId: Crucially, this must be the same id that was received in the original COMMAND message from the C2 server. This allows the C2 to correlate results with sent commands. status: A string indicating if the command execution was generally successful or encountered an error (e.g., command not found). output: A string containing the output from the command. As per subject.md requirements, this should include both stdout and stderr. The C2 server currently processes this as a single string but can be adapted if the rootkit sends separate stdout/stderr fields. exitCode: The numerical exit status of the executed command. C2 Server Processing:\nThe C2 server receives the COMMAND_RESULT message. It decrypts and parses the message. It emits a command:result_received event, which is logged to the C2 CLI, displaying the commandId, status, and output associated with the clientâ€™s alias. Properly formatting and returning the COMMAND_RESULT is essential for the operator to see the outcome of their remotely executed commands.\n"
            }
        );
    index.add(
            {
                id:  27 ,
                href: "\/docs\/04-epirootkit\/configuration-justifications\/",
                title: "Configuration Justifications",
                description: "Justification for Ubuntu 20.04 LTS / Linux 5.4.x",
                content: " info This page explains why we chose Ubuntu 20.04 LTS with the 5.4.x kernel for our rootkit development and testing. Environment link OS: Ubuntu 20.04 LTS (Focal Fossa) Kernel: 5.4.x (LTS) Why Ubuntu 20.04 LTS? link check Perfect balance between realism and convinience. Widely deployed on servers and desktops Official cloud and container images simplify automation Already uses interesting kernel version (5.4.x) so no need to compile. Why Kernel 5.4.x? link info Balances modern hooking APIs with exported symbols and no mandatory module signing. Full ftrace support\nKernel 4.1+ stabilized the ftrace API (ftrace_set_filter_ip(), register_ftrace_function()). 5.4.x includes every hook we need. Exported kallsyms_lookup_name()\nUp through 5.6 the symbol remains exported. Allows us to resolve sys_call_table at runtimeâ€“no kernel recompilation. Unsigned module loading\nKernels â‰¥ 5.7 often enforce module signatures or Secure Boot lockdown. Ubuntu 20.04â€™s 5.4.x ships without these restrictions by default. Already compiled in Ubuntu 20.04 LTS\nAs mentionned before Ubuntu 20.04 LTS comes already packing with kernel version 5.4.x making it very easy for us to use and deploy. Alternative Options link Kernel 5.6 Technically we could go until kernel version 5.6 but for practical reasons mentionned above, we went with 5.4.x. Wich in my opinion is still relevant because in LTS. Debian 11 (5.10.x) Still exports our symbolsâ€“requires disabling module signature checks. warning If we experiment on kernels â‰¥ 5.7, we need to append module.sig_enforce=0 to the boot parameters to allow unsigned modules. "
            }
        );
    index.add(
            {
                id:  28 ,
                href: "\/docs\/04-epirootkit\/security-interaction\/",
                title: "Security Interaction with C2",
                description: "Security protocols EpiRootkit must follow when interacting with the C2 server.",
                content: "To maintain a secure channel and controlled access, the EpiRootkit must adhere to the security protocols established by the Attacking Program (C2 Server).\n1. Encrypted Communication (AES-256-GCM) link Requirement: All TCP communication with the C2 server must be encrypted using AES-256-GCM. Shared Secret: The EpiRootkit must be compiled or configured with the exact same 32-byte ENCRYPTION_KEY that the C2 server is using (see "
            }
        );
    index.add(
            {
                id:  29 ,
                href: "\/docs\/04-epirootkit\/features\/file-transfer\/",
                title: "Remote Exec \u0026 File Transfer",
                description: "Run commands, upload \u0026 download files over our encrypted channel",
                content: "1. Remote Command Execution linkWhat we did\nAllow arbitrary program execution via C2.\nHow it works\nReceive a packet: EXEC \\n Use call_usermodehelper(argv, envp, UMH_WAIT_PROC) to spawn the process. Capture its stdout/stderr via kernel pipes and send back encrypted. 2. File Upload linkWhat we did\nAccept files from the attacker.\nHow it works\nReceive UPLOAD \\n. filp_open(\"/usr/share/epirootkit/\", O_CREAT|O_WRONLY, 0600). kernel_write() the data. Our getdents() hook keeps /usr/share/epirootkit hidden. 3. File Download linkWhat we did\nSend files to the attacker.\nHow it works\nReceive DOWNLOAD . filp_open() + kernel_read() in chunks. Stream each chunk over the encrypted C2 link. "
            }
        );
    index.add(
            {
                id:  30 ,
                href: "\/docs\/05-submission\/",
                title: "Submission",
                description: "Guidelines for submitting the project.\n",
                content: "Guidelines for submitting the project.\n"
            }
        );
    index.add(
            {
                id:  31 ,
                href: "\/docs\/05-submission\/handout-format\/",
                title: "Handout Format",
                description: "Details on the required file structure, AUTHORS, README, and TODO files.\n",
                content: "Details on the required file structure, AUTHORS, README, and TODO files.\n"
            }
        );
    index.add(
            {
                id:  32 ,
                href: "\/docs\/06-resources\/",
                title: "Resources",
                description: "Links to useful documentation, books, and other resources (Section 7 from subject.md).\n",
                content: "Links to useful documentation, books, and other resources (Section 7 from subject.md).\n"
            }
        );
    index.add(
            {
                id:  33 ,
                href: "\/docs\/07-bonuses\/wlkom-ctf\/",
                title: "Tux Fan Club: Chasse au TrÃ©sor Pirate",
                description: "Treasure Hunt ðŸª™ linkDÃ©couverte dâ€™un mystÃ©rieux fichierâ€¦ linkNous avons dÃ©cidÃ© dâ€™accepter une quÃªte secondaire durant le projet Rootkit.\nEn effet, comme tout bon pirate, nous avons tÃ©lÃ©chargÃ© lÃ©galement les fichiers fournis (given files) et nous souhaitions les ignorer avec un fichier .gitignore.\nLe .gitignore ressemblait Ã  :\n.gitignore givenfiles/ Sauf que les fichiers nâ€™Ã©taient pas ignorÃ©s. Câ€™est lÃ  que nous dÃ©couvrons un mystÃ©rieux fichier .README :\nArborescence rÃ©vÃ©lant le fichier cachÃ©\n",
                content: "Treasure Hunt ðŸª™ linkDÃ©couverte dâ€™un mystÃ©rieux fichierâ€¦ linkNous avons dÃ©cidÃ© dâ€™accepter une quÃªte secondaire durant le projet Rootkit.\nEn effet, comme tout bon pirate, nous avons tÃ©lÃ©chargÃ© lÃ©galement les fichiers fournis (given files) et nous souhaitions les ignorer avec un fichier .gitignore.\nLe .gitignore ressemblait Ã  :\n.gitignore givenfiles/ Sauf que les fichiers nâ€™Ã©taient pas ignorÃ©s. Câ€™est lÃ  que nous dÃ©couvrons un mystÃ©rieux fichier .README :\nArborescence rÃ©vÃ©lant le fichier cachÃ©\nTentative de lecture du parchemin linkAprÃ¨s avoir accÃ©dÃ© Ã  ce fichier, nous dÃ©cidons de lâ€™ouvrir. Le dÃ©chiffrer Ã©tait une autre paire de manchesâ€¦\nContenu du fichier mystÃ©rieux\nW3lc0m3 t0 thE 53cR3t p1r4t35 l4ir. Young pirate, you have find my treasure. It is yours. Navigate safely, -- Cap'tain RenÃ© Bojolais Le reste du parchemin Ã©tait du langage codÃ©. GrÃ¢ce Ã  notre expÃ©rience en programmation et en langues, nous comprenons quâ€™il sâ€™agit dâ€™une image encodÃ©e en base64.\nDÃ©chiffrer lâ€™image linkAvec la commande base64 -d .README \u003e image.jpg nous avons pu obtenir lâ€™image (il fallait Ã©videmment garder que la partie en base64 du README).\nImage dÃ©chiffrÃ©e\nVoici la magnifique illustrationâ€¦ Mais nous savons que le capitaine RenÃ© avait plus dâ€™un tour dans son sac. Donc nous dÃ©cidions dâ€™examiner lâ€™image en dÃ©tail.\nChanson cachÃ©e linkEn utilisant le site https://georgeom.net/StegOnline/upload pour extraire les valeurs RGB de lâ€™image et le texte cachÃ©, on remarque une chaÃ®ne de caractÃ¨res insoliteâ€¦\nExtraction de donnÃ©es cachÃ©es\nI am captain Jack Sparrow - Remix high bass quality - SAVAGE MIX.wavUT\nCela nous rappelle une chanson de pirates bien connueâ€¦\nNotre premiÃ¨re idÃ©e est de chercher le remix sur Youtube afin de voir si le Capitaine RenÃ© nâ€™a pas laissÃ© un petit flag en commentaire. Apparemment, il nâ€™est pas fan dâ€™OSINT, dommage ðŸ˜”\nNotre deuxiÃ¨me idÃ©e est de dÃ©zipper lâ€™image unzip image.jpg et lÃ , bingo !\nArchive: image.jpg warning [image.jpg]: 21054 extra bytes at beginning or within zipfile (attempting to process anyway) inflating: I am captain Jack Sparrow - Remix high bass quality - SAVAGE MIX.wav Audacity time linkGrÃ¢ce Ã  notre expÃ©rience en CTF, nous avons tout de suite lâ€™idÃ©e dâ€™examiner le spectrogramme.\nRien dâ€™anormal sauf sur les derniÃ¨res secondes du fichier. Et lÃ â€¦ nous trouvons le flag !\nLe trÃ©sor cachÃ© dans le spectrogramme\nIl ne nous reste quâ€™Ã  transmettre le mot de passe au capitaine et Ã  nous le trÃ©sorâ€¦\nTrÃ©sor link Grrr des canards\nConclusion linkUne fois cette chasse au trÃ©sor finie, il est temps de commencer le projet principal ðŸ‘€\n"
            }
        );
    index.add(
            {
                id:  34 ,
                href: "\/docs\/08-remerciements\/thankyou\/",
                title: "Un dernier mot",
                description: "Hugo linkBonjour,\nMerci beaucoup Jules pour ce projet!\nIl mâ€™a permis dâ€™expÃ©rimenter plein de sujets diffÃ©rents, jâ€™ai profitÃ© de lâ€™excuse de â€œcâ€™est pour le travail dâ€™EPITAâ€ pour tester le Lotus Docs (le framework de la documentation sur lequel ces mots sont Ã©crits), jâ€™ai pu mettre en pratique directement ce que jâ€™ai pu apprendre dans mon travail, notamment jâ€™avais dÃ» faire une prÃ©sentation sur un rootkit (PUMAKIT) Ã  ma boÃ®te, et jâ€™ai pu mâ€™en inspirer et recrÃ©er le rootkit en amÃ©liorant certaines fonctionnalitÃ©s (car franchement il Ã©tait assez mal foutu, les Chinois nâ€™ont quâ€™Ã  bien se tenir). Jâ€™ai eu lâ€™occasion de discuter avec certains SRS pour avoir des avis sur certaines implÃ©mentations. Spoiler, ils Ã©taient tous jaloux du fait que en premiÃ¨re annÃ©e dâ€™alternance on fait un projet aussi cool alors quâ€™ils se tapent de lâ€™Active Directory depuis 2 mois.\n",
                content: "Hugo linkBonjour,\nMerci beaucoup Jules pour ce projet!\nIl mâ€™a permis dâ€™expÃ©rimenter plein de sujets diffÃ©rents, jâ€™ai profitÃ© de lâ€™excuse de â€œcâ€™est pour le travail dâ€™EPITAâ€ pour tester le Lotus Docs (le framework de la documentation sur lequel ces mots sont Ã©crits), jâ€™ai pu mettre en pratique directement ce que jâ€™ai pu apprendre dans mon travail, notamment jâ€™avais dÃ» faire une prÃ©sentation sur un rootkit (PUMAKIT) Ã  ma boÃ®te, et jâ€™ai pu mâ€™en inspirer et recrÃ©er le rootkit en amÃ©liorant certaines fonctionnalitÃ©s (car franchement il Ã©tait assez mal foutu, les Chinois nâ€™ont quâ€™Ã  bien se tenir). Jâ€™ai eu lâ€™occasion de discuter avec certains SRS pour avoir des avis sur certaines implÃ©mentations. Spoiler, ils Ã©taient tous jaloux du fait que en premiÃ¨re annÃ©e dâ€™alternance on fait un projet aussi cool alors quâ€™ils se tapent de lâ€™Active Directory depuis 2 mois.\nJâ€™ai mÃªme eu lâ€™idÃ©e de crÃ©er un nouveau club de cyber en parlant Ã  des gens de ma promo aussi trÃ¨s investis par le projet (Paul, Kyllian, Matteoâ€¦).\nMon maÃ®tre dâ€™alternance (ancien SRS promo 2012), Ã©tait trÃ¨s intÃ©ressÃ© par le projet lui aussi et mâ€™a demandÃ© de faire une prÃ©sentation complÃ¨te de mon implÃ©mentation devant toute lâ€™entreprise une fois que ce sera fini.\nEt bien Ã©videmment, ce qui est sÃ»rement le plus important, jâ€™ai pu avoir un magnifique canard en plastique, que jâ€™ai torturÃ© pendant ce PTN DE RUSH DE JS (oui jâ€™ai encore des sÃ©quelles).\nBref merci :)\nCanard-ment,\nâ€“\nHugo Sibony\nAPPING Cyber 2027\nâ€œJâ€™Ã©cris ce message a 10000m dâ€™altitude dans un avion qui tremble plus que moi dans lâ€™attente de ma note de JS.â€\nLÃ©a linkBonjour,\nCâ€™est LÃ©a\nCoin-Coin-ment,\nâ€“ LÃ©a Bonet DÃ©lÃ©guÃ©e APPING Cyb 2027\nâ€œAu moins Hugo ne sâ€™est pas fait arrÃªtÃ© Ã  la sortie de lâ€™avion ðŸ‘€â€\n"
            }
        );
    index.add(
            {
                id:  35 ,
                href: "\/docs\/",
                title: "Docs",
                description: "",
                content: ""
            }
        );
    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>