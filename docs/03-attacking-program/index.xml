<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Attacking Program (C2 Server) on Tux Fan Club Docs</title><link>/docs/03-attacking-program/</link><description>Recent content in Attacking Program (C2 Server) on Tux Fan Club Docs</description><generator>Hugo</generator><language>en</language><atom:link href="/docs/03-attacking-program/index.xml" rel="self" type="application/rss+xml"/><item><title>Overview</title><link>/docs/03-attacking-program/overview/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/03-attacking-program/overview/</guid><description>&lt;p>The Attacking Program is the command and control (C2) server for EpiRootkit. It is designed to run on a Linux-based attacking virtual machine and provides a command-line interface (CLI) to manage and interact with EpiRootkit instances on victim machines.&lt;/p>
&lt;p>Key functions include:&lt;/p>
&lt;ul>
&lt;li>Listening for client connections from EpiRootkit instances.&lt;/li>
&lt;li>Securing communication using AES-256-GCM encryption.&lt;/li>
&lt;li>Authenticating clients based on a SHA512 hashed password.&lt;/li>
&lt;li>Managing connected clients (listing, identifying).&lt;/li>
&lt;li>Providing an interactive CLI for sending commands to EpiRootkit instances.&lt;/li>
&lt;/ul></description></item><item><title>Installation</title><link>/docs/03-attacking-program/installation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/03-attacking-program/installation/</guid><description>&lt;p>To run the Attacking Program (C2 Server):&lt;/p>
&lt;h2 id="prerequisites">Prerequisites &lt;a href="#prerequisites" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;strong>Node.js &amp;amp; npm&lt;/strong>: Ensure Node.js (e.g., LTS v18.x+) and npm are installed.



 
 
 

 
 
 
 

 

 &lt;div class="prism-codeblock ">
 &lt;pre id="685c214" class="language-bash ">
 &lt;code>sudo apt update &amp;amp;&amp;amp; sudo apt install nodejs npm&lt;/code>
 &lt;/pre>
 &lt;/div>
&lt;/li>
&lt;/ul>
&lt;h2 id="setup">Setup &lt;a href="#setup" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;ol>
&lt;li>
&lt;p>Navigate to the &lt;code>attacking_program&lt;/code> directory within the project.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Install Dependencies:&lt;/p>



 
 
 

 
 
 
 

 

 &lt;div class="prism-codeblock ">
 &lt;pre id="e3453dc" class="language-bash ">
 &lt;code>npm install&lt;/code>
 &lt;/pre>
 &lt;/div>
&lt;/li>
&lt;li>
&lt;p>Review Critical Configuration: Before first use, ensure you have reviewed and appropriately set the &lt;code>ENCRYPTION_KEY&lt;/code>, &lt;code>PASSWORD_HASH&lt;/code>, and &lt;code>C2_PORT&lt;/code>. Refer to the &lt;a data-bs-delay="{&amp;#34;hide&amp;#34;:300,&amp;#34;show&amp;#34;:550}" data-bs-html="true" data-bs-title="&lt;a href='/docs/03-attacking-program/configuration/'>&lt;p>ATTACKING PROGRAM (C2 SERVER)&lt;/p></description></item><item><title>Usage &amp; CLI Commands</title><link>/docs/03-attacking-program/usage/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/03-attacking-program/usage/</guid><description>&lt;h2 id="running-the-server">Running the Server &lt;a href="#running-the-server" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;p>In the &lt;code>attacking_program&lt;/code> directory, run:&lt;/p>



 
 
 

 
 
 
 

 

 &lt;div class="prism-codeblock ">
 &lt;pre id="721ccab" class="language-bash ">
 &lt;code>npm start&lt;/code>
 &lt;/pre>
 &lt;/div>
&lt;p>The server starts automatically and presents the &lt;code>c2-server$ &lt;/code> prompt. Real-time event logs appear in the console, providing visual alerts for significant events such as client connections and disconnections.&lt;/p>
&lt;h2 id="cli-commands">CLI Commands &lt;a href="#cli-commands" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>






&lt;table class="table %!s(&lt;nil>)">
 &lt;thead>
 &lt;tr>
 &lt;th>Command&lt;/th>
 &lt;th>Aliases&lt;/th>
 &lt;th>Description&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;code>server start&lt;/code>&lt;/td>
 &lt;td>&lt;code>start&lt;/code>&lt;/td>
 &lt;td>Starts TCP server (Note: auto-starts with &lt;code>npm start&lt;/code>).&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>server stop&lt;/code>&lt;/td>
 &lt;td>&lt;code>stop&lt;/code>&lt;/td>
 &lt;td>Stops TCP server.&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>clients list&lt;/code>&lt;/td>
 &lt;td>&lt;code>ls&lt;/code>, &lt;code>list&lt;/code>&lt;/td>
 &lt;td>Lists connected clients (alias, ID, auth status, last ping).&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>send &amp;lt;clientAlias&amp;gt; &amp;lt;command...&amp;gt;&lt;/code>&lt;/td>
 &lt;td>&lt;/td>
 &lt;td>Sends &lt;code>&amp;lt;command...&amp;gt;&lt;/code> to specified &lt;code>&amp;lt;clientAlias&amp;gt;&lt;/code>.&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>exit&lt;/code>&lt;/td>
 &lt;td>&lt;code>quit&lt;/code>&lt;/td>
 &lt;td>Stops server and exits application.&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>

&lt;ul>
&lt;li>&lt;code>&amp;lt;clientAlias&amp;gt;&lt;/code>: Target client alias (e.g., &lt;code>Client-1&lt;/code> from &lt;code>clients list&lt;/code>).&lt;/li>
&lt;li>&lt;code>&amp;lt;command...&amp;gt;&lt;/code>: Command string for the victim machine.&lt;/li>
&lt;/ul>
&lt;p>Event logs provide feedback on connections, authentication attempts, data exchanges, errors, and command results. When a command is executed on a rootkit and results (such as stdout, stderr, or exit status) are sent back, they will be displayed in these logs.&lt;/p></description></item><item><title>Configuration</title><link>/docs/03-attacking-program/configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/03-attacking-program/configuration/</guid><description>&lt;p>The C2 server is configured via &lt;code>src/config/index.js&lt;/code> or environment variables.&lt;/p>
&lt;h2 id="critical-settings">Critical Settings &lt;a href="#critical-settings" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;ul>
&lt;li>
&lt;p>&lt;code>C2_PORT&lt;/code> (Default: &lt;code>4444&lt;/code> | Env: &lt;code>C2_PORT&lt;/code>)&lt;/p>
&lt;ul>
&lt;li>TCP port for EpiRootkit connections.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>ENCRYPTION_KEY&lt;/code> (Default: &lt;code>mysecretkey...&lt;/code> (32 bytes) | Env: &lt;code>ENCRYPTION_KEY&lt;/code>)&lt;/p>
&lt;ul>
&lt;li>Must be a 32-byte string for AES-256-GCM.&lt;/li>
&lt;li>Crucial for security: Change the default to a strong, random key.&lt;/li>
&lt;li>Must match the key on EpiRootkit clients.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>PASSWORD_HASH&lt;/code> (Default: SHA512 hash of &lt;code>&amp;quot;password&amp;quot;&lt;/code> | Env: &lt;code>PASSWORD_HASH&lt;/code>)&lt;/p>
&lt;ul>
&lt;li>Must be a 128-char lowercase SHA512 hex string.&lt;/li>
&lt;li>Crucial for security: Change the default. Use a strong password and hash it:



 
 
 

 
 
 
 

 

 &lt;div class="prism-codeblock ">
 &lt;pre id="6a74c81" class="language-bash ">
 &lt;code># Example to generate hash for a new password:
echo -n &amp;#34;your_new_strong_password&amp;#34; | sha512sum | awk &amp;#39;{print $1}&amp;#39;&lt;/code>
 &lt;/pre>
 &lt;/div>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="other-settings">Other Settings &lt;a href="#other-settings" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;code>WEB_PORT&lt;/code>: For a potential future web UI (Default: &lt;code>3000&lt;/code>).&lt;/li>
&lt;li>&lt;code>UPLOAD_DIR&lt;/code>, &lt;code>DOWNLOAD_DIR&lt;/code>, &lt;code>LOG_DIR&lt;/code>: Default paths for server-side file operations and logs.&lt;/li>
&lt;/ul>
&lt;p>Configuration validation ensures key formats (e.g., key lengths) are correct on startup.&lt;/p></description></item><item><title>Security Features</title><link>/docs/03-attacking-program/security/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/03-attacking-program/security/</guid><description>&lt;p>The C2 server employs two main security mechanisms:&lt;/p>
&lt;h2 id="1-message-encryption-aes-256-gcm">1. Message Encryption: AES-256-GCM &lt;a href="#1-message-encryption-aes-256-gcm" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;ul>
&lt;li>Purpose: Encrypts all TCP C2 traffic for confidentiality, integrity, and authenticity.&lt;/li>
&lt;li>Key: Uses a 32-byte &lt;code>ENCRYPTION_KEY&lt;/code> (must be changed from default and kept secret).&lt;/li>
&lt;li>Format: Encrypted messages are transmitted as a colon-separated string: &lt;code>iv_hex:authtag_hex:ciphertext_hex&lt;/code>.&lt;/li>
&lt;li>Details: See &lt;code>src/utils/encryption.js&lt;/code> and &lt;a data-bs-delay="{&amp;#34;hide&amp;#34;:300,&amp;#34;show&amp;#34;:550}" data-bs-html="true" data-bs-title="&lt;a href='/docs/03-attacking-program/configuration/'>&lt;p>ATTACKING PROGRAM (C2 SERVER)&lt;/p>&lt;strong>Configuration&lt;/strong>&lt;br>Key C2 server configuration settings.&lt;/a>" data-bs-toggle="tooltip" href="/docs/03-attacking-program/configuration/">Configuration&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h2 id="2-client-authentication-sha512-hashing">2. Client Authentication: SHA512 Hashing &lt;a href="#2-client-authentication-sha512-hashing" class="anchor" aria-hidden="true">&lt;i class="material-icons align-middle">link&lt;/i>&lt;/a>&lt;/h2>&lt;ul>
&lt;li>Purpose: Verifies EpiRootkit clients before allowing interaction.&lt;/li>
&lt;li>Method: Client sends a password; server hashes it with SHA512 and compares against a stored &lt;code>PASSWORD_HASH&lt;/code>.&lt;/li>
&lt;li>Hash: The &lt;code>PASSWORD_HASH&lt;/code> (must be changed from default) is a 128-char lowercase SHA512 hex string.&lt;/li>
&lt;li>Details: See &lt;code>src/handlers/messageHandlers.js&lt;/code> and &lt;a data-bs-delay="{&amp;#34;hide&amp;#34;:300,&amp;#34;show&amp;#34;:550}" data-bs-html="true" data-bs-title="&lt;a href='/docs/03-attacking-program/configuration/'>&lt;p>ATTACKING PROGRAM (C2 SERVER)&lt;/p></description></item></channel></rss>